#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass elsarticle
\begin_preamble
\usepackage{algpseudocode,algorithm,algorithmicx}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,calc,decorations.pathreplacing}
\end_preamble
\options 3p
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
\end_modules
\maintain_unincluded_children false
\begin_local_layout
InsetLayout "Flex:RevisionText"
  LabelString         "Revision Text"
  LatexType             Command
  LaTexName             RevisionText
  LyxType                 "custom"
  Decoration            Classic
  Preamble
    \newcommand\RevisionText[1]{\textcolor{red}{#1}}
  EndPreamble
	ResetsFont true
End
\end_local_layout
\language english
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Positivity-preserving and entropy-bounded discontinuous Galerkin method
 for the chemically reacting, compressible Navier-Stokes equations
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
author[NRL]{Eric J.
 Ching}
\end_layout

\begin_layout Plain Layout


\backslash
author[NRL]{Ryan F.
 Johnson}
\end_layout

\begin_layout Plain Layout


\backslash
author[UFL]{Sarah Burrows}
\end_layout

\begin_layout Plain Layout


\backslash
author[UCF]{Jacklyn Higgs}
\end_layout

\begin_layout Plain Layout


\backslash
author[NRL]{Andrew D.
 Kercher}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
address[NRL]{Laboratories for Computational Physics and Fluid Dynamics,
 U.S.
 Naval Research Laboratory, 4555 Overlook Ave SW, Washington, DC 20375}
\end_layout

\begin_layout Plain Layout


\backslash
address[UFL]{Department of Mechanical 
\backslash
& Aerospace Engineering, University of Florida, Gainesville, FL 32611}
\end_layout

\begin_layout Plain Layout


\backslash
address[UCF]{Department of Mechanical and Aerospace Engineering, University
 of Central Florida, Orlando, FL 32816}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Abstract
This article concerns the development of a fully conservative, positivity-preser
ving, and entropy-bounded discontinuous Galerkin scheme for the multicomponent,
 chemically reacting, compressible Navier-Stokes equations with complex
 thermodynamics.
 In particular, we extend to viscous flows the fully conservative, positivity-pr
eserving, and entropy-bounded discontinuous Galerkin method for the chemically
 reacting Euler equations that we previously introduced.
 An important component of the formulation is the positivity-preserving
 Lax-Friedrichs-type viscous flux function devised by Zhang [
\emph on
J.
 Comput.
 Phys.
\emph default
, 328 (2017), pp.
 301-343], which was adapted to multicomponent flows by Du and Yang [
\emph on
J.
 Comput.
 Phys.
\emph default
, 469 (2022), pp.
 111548] in a manner that treats the inviscid and viscous fluxes as a single
 flux.
 Here, we similarly extend the aforementioned flux function to multicomponent
 flows but separate the inviscid and viscous fluxes, resulting in a different
 dissipation coefficient.
 This separation of the fluxes allows for use of other inviscid flux functions,
 as well as enforcement of entropy boundedness on only the convective contributi
on to the evolved state, as motivated by physical and mathematical principles.
 We also detail how to account for boundary conditions and incorporate previousl
y developed techniques to reduce spurious pressure oscillations into the
 positivity-preserving framework.
 Furthermore, potential issues associated with the Lax-Friedrichs-type viscous
 flux function in the case of zero species concentrations are discussed
 and addressed.
 Comparisons between the Lax-Friedrichs-type viscous flux function and more
 conventional flux functions are provided, the results of which motivate
 an adaptive solution procedure that employs the former only when the element-lo
cal solution average has negative species concentrations, nonpositive density,
 or nonpositive pressure.
 The resulting formulation is compatible with curved, multidimensional elements
 and general quadrature rules with positive weights.
 A variety of multicomponent, viscous flows is computed, ranging from a
 one-dimensional shock tube problem to multidimensional detonation waves
 and shock/mixing-layer interaction.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
We find that just as in the inviscid, multicomponent case, the robustness
 benefits of the enforcement of an entropy bound are much more pronounced
 than in the monocomponent, calorically perfect setting.
\end_layout

\end_inset

 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Where appropriate, we demonstrate that mass, total energy, and atomic elements
 are discretely conserved.
 
\end_layout

\end_inset


\end_layout

\begin_layout Keywords
Discontinuous Galerkin method; Combustion; Detonation; Minimum entropy principle
; Positivity-preserving; Multicomponent Navier-Stokes equations
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
maketitle
\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\middlebar}{\,\middle|\,}
{\mathrm{|}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\average}[1]{\left\{  \!\!\left\{  #1\right\}  \!\!\right\}  }
{\left\{ \left\{ #1\right\} \right\} }
\end_inset


\begin_inset FormulaMacro
\newcommand{\expnumber}[2]{{#1}\mathrm{e}{#2}}
{{#1}\mathrm{e}{#2}}
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

 
\backslash
newcommand*{
\backslash
horzbar}{
\backslash
rule[.5ex]{2.5ex}{0.5pt}}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
First macro is red, second is no color:
\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\revisionmath}[1]{\textcolor{red}{#1}}
{\textcolor{red}{#1}}
\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset FormulaMacro
\renewcommand{\revisionmath}[1]{#1}
{#1}
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
makeatletter 
\backslash
def
\backslash
ps@pprintTitle{  
\backslash
let
\backslash
@oddhead
\backslash
@empty  
\backslash
let
\backslash
@evenhead
\backslash
@empty  
\backslash
def
\backslash
@oddfoot{
\backslash
centerline{
\backslash
thepage}}  
\backslash
let
\backslash
@evenfoot
\backslash
@oddfoot} 
\backslash
makeatother
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
let
\backslash
svthefootnote
\backslash
thefootnote
\backslash
let
\backslash
thefootnote
\backslash
relax
\backslash
footnotetext{
\backslash

\backslash
 
\backslash
hspace*{65pt}DISTRIBUTION STATEMENT A.
 Approved for public release.
 Distribution is unlimited.}
\backslash
addtocounter{footnote}{-1}
\backslash
let
\backslash
thefootnote
\backslash
svthefootnote
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="27" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Symbol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Definition
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Units
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{p}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specific heat at constant pressure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 
\begin_inset Formula $J/kg$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specific heat at constant volume
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 
\begin_inset Formula $J/kg$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $C_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Concentration of species 
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $kmol/m^{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{C}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Concentration vector of all species
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $kmol/m^{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\bar{D}_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mass averaged diffusion Coefficient
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m^{2}/s$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $D_{ij}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Diffusion coefficient of species 
\begin_inset Formula $i$
\end_inset

 to species 
\begin_inset Formula $j$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m^{2}/s$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{DG}(p=a)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Discontinuous Galerkin solution where 
\begin_inset Formula $a$
\end_inset

 is the polynomial degree
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $e_{t}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total energy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $J/kg$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ratio of specific heats
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{p}/c_{v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h_{t}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total enthalpy, species specific has subscript 
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $J/kg$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
grid spacing
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Conductivity, species specific has subscript 
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $J/\left(m\cdot s\cdot K\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Viscosity, species specific has subscript 
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m^{2}/s$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n_{s}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of species
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $kg\cdot m/s^{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $R^{o}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Universal gas constant, 
\begin_inset Formula $8314.4621$
\end_inset

, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $J/\left(kmol\cdot K\right)$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula $\frac{}{}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\rho$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Density, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $kg/m^{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $s$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Temperature of gas, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $K$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dyadic Stress tensor, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $kg\cdot m/s^{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $u$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Internal energy, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $J/kg$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Velocity, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m/s$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{V}_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Species diffusion velocity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m/s$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $W_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Molecular weight of species 
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $kg/kmol$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mole fraction of species 
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mass fraction of species 
\begin_inset Formula $i$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Introduction
\begin_inset CommandInset label
LatexCommand label
name "sec:Introduction"

\end_inset


\end_layout

\begin_layout Standard
In the past two decades, interest in the discontinuous Galerkin (DG) method
 for fluid flow simulations has surged dramatically.
 This method benefits from arbitrarily high order of accuracy on unstructured
 grids, as well as a compact stencil and high arithmetic intensity suited
 for modern computing systems.
 However, one of the primary obstacles to widespread use of this numerical
 scheme is its susceptibility to nonlinear instabilities in underresolved
 regions and near non-smooth features.
 Robustness is an even greater concern when mixtures of thermally perfect
 gases and chemical reactions are considered
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Ban20,Joh20_2"
literal "false"

\end_inset

.
 For instance, it is well-known that fully conservative schemes fail to
 maintain pressure equilibrium
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Abg88,Kar94,Abg96"
literal "false"

\end_inset

, leading to the generation of spurious pressure oscillations that can cause
 solver divergence.
 A number of quasi-conservative methods, such as the double-flux technique
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Abg01,Lv15,Bil11"
literal "false"

\end_inset

, have been proposed to circumvent this issue, typically at the expense
 of energy conservation.
 Recently, Johnson and Kercher introduced a fully conservative DG scheme
 that more effectively maintains pressure equilibrium in smooth regions
 of the flow
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

.
 Strang splitting was employed to decouple the temporal integration of the
 convective and diffusive operators from that of stiff chemical source terms.
 Artificial viscosity was used to stabilize the solution near shocks and
 other non-smooth features.
 However, artificial viscosity alone is often not sufficient to guarantee
 stability.
 To further increase robustness, we made key advancements to this fully
 conservative DG method, focusing on the inviscid case, to ensure satisfaction
 of the positivity property (i.e., nonnegative species concentrations, positive
 density, and positive pressure) and an entropy bound based on the minimum
 entropy principle for the multicomponent Euler equations
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Gou20,Chi22"
literal "false"

\end_inset

, which states that the spatial minimum of specific thermodynamic entropy
 of entropy solutions is a nondecreasing function of time.
 The main ingredients of this DG formulation
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22,Chi22_2"
literal "false"

\end_inset

 are (a) an invariant-region-preserving inviscid flux function
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Jia18"
literal "false"

\end_inset

, (b) a simple linear-scaling limiter
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha10"
literal "false"

\end_inset

, (c) satisfaction of a time-step-size constraint for the transport step
 with a strong-stability-preserving explicit time integrator, (d) incorporation
 of the techniques introduced by Johnson and Kercher
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

 that reduce spurious pressure oscillations in smooth flow regions, and
 (e) an entropy-stable DG discretization in time based on diagonal-norm
 summation-by-parts operators for the reaction step.
 It was found that the formulation was capable of robustly and accurately
 computing complex inviscid, reacting flows using high-order polynomials
 and relatively coarse meshes.
 Enforcement of entropy boundedness was critical for stability in simulations
 of multidimensional detonation waves.
\end_layout

\begin_layout Standard
The consideration of viscous flows brings about additional complications.
 Using conventional viscous flux functions, such as the second form of Bassi
 and Rebay (BR2)
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Bas00"
literal "false"

\end_inset

 and the symmetric interior penalty method (SIPG)
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Har08"
literal "false"

\end_inset

, positivity is not guaranteed to be maintained.
 Specifically, it is possible for the constraint on the time step size to
 be arbitrarily small for the solution to satisfy said property.
 To remedy this problem, Zhang
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

 introduced a Lax-Friedrichs-type viscous flux function for the monocomponent
 Navier-Stokes equations, accompanied by a strictly positive upper bound
 on the time step size to guarantee satisfaction of the positivity property.
 Although it may be surprising that the viscous flux can be a primary source
 of negative concentrations, nonpositive density, and/or nonpositive pressure,
 we call attention to certain numerical challenges specific to multicomponent-fl
ow simulations: not only are nonlinear instabilities more likely to occur,
 but also species concentrations are typically close or equal to zero, such
 that small numerical errors can easily lead to negative concentrations.
 Furthermore, in the monocomponent case, the mass conservation equation
 is identical between the Euler system and the Navier-Stokes system; therefore,
 the diffusive operator does not directly contribute to negative densities.
 However, this is not true in the multicomponent case, which means that
 the viscous flux can indeed be largely responsible for negative concentrations.
 Note that many multicomponent-flow codes simply 
\begin_inset Quotes eld
\end_inset

clip
\begin_inset Quotes erd
\end_inset

 negative species concentrations, but such an intrusive strategy violates
 mass conservation and pollutes the solution with low-order errors.
 
\end_layout

\begin_layout Standard
Du and Yang
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Du22"
literal "false"

\end_inset

 recently extended the aforementioned Lax-Friedrichs-type viscous flux function
 to multicomponent flows.
 Specifically, they combined the inviscid and viscous fluxes into a single
 flux, such that the resulting dissipation coefficient accounts for both
 fluxes simultaneously.
 Entropy boundedness was not considered.
 Instead of operator splitting, they employed an exponential multistage/multiste
p, explicit time integration scheme
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Hua18,Du19,Du19_2"
literal "false"

\end_inset

 that can handle stiff source terms.
 Although in the present study we use operator splitting since it has proven
 successful to date and its accuracy is less reliant on 
\begin_inset Quotes eld
\end_inset

well-prepared
\begin_inset Quotes erd
\end_inset

 initial conditions
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Hua18,Du19,Du19_2"
literal "false"

\end_inset

, exponential multistage/multistep time integrators are indeed worthy of
 future investigation.
\end_layout

\begin_layout Standard
In this work, we develop a fully conservative, positivity-preserving, and
 entropy-bounded DG method for the compressible, multicomponent, chemically
 reacting Navier-Stokes equations.
 We focus on the transport step since the treatment of stiff chemical source
 terms is identical to that in the inviscid case.
 Enforcement of a lower bound on the specific thermodynamic entropy is performed
 on only the convective contribution to the evolved state since the viscous
 flux function is not fully compatible with said entropy bound.
 This was also done by Dzanic and Witherden
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Dza22"
literal "false"

\end_inset

, albeit in a different manner, in their entropy-based filtering framework.
 Furthermore, at least in the monocomponent, calorically perfect setting,
 the minimum entropy principle does not hold for the Navier-Stokes equations
 unless the thermal diffusivity is zero
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Tad86,Gue14"
literal "false"

\end_inset

.
 Although such analysis has not yet been performed for the multicomponent
 Navier-Stokes equations with the thermally perfect gas model, we do not
 expect the conclusion to change.
 Our primary contributions are as follows:
\end_layout

\begin_layout Itemize
We extend the aforementioned positivity-preserving Lax-Friedrichs-type viscous
 flux function
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

 to multicomponent flows.
 Specifically, unlike in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Du22"
literal "false"

\end_inset

, we treat the inviscid and viscous fluxes separately, resulting in a different
 dissipation coefficient.
 The rationale for separating the fluxes is twofold.
 First, enforcing a bounded entropy on the convective contribution necessitates
 isolating the fluxes.
 Secondly, in our experience, we have found the HLLC inviscid flux function
 to perform more favorably than the Lax-Friedrichs inviscid flux function.
 We also discuss the treatment of boundary conditions in more detail.
\end_layout

\begin_layout Itemize
Entropy boundedness is enforced on only the convective contribution in a
 rigorous manner that maintains full compatibility with the positivity property.
\end_layout

\begin_layout Itemize
We discuss potential issues associated with the Lax-Friedrichs-type viscous
 flux function if any of the species concentrations is zero.
 This is true regardless of whether the inviscid and viscous fluxes are
 treated simultaneously or separately.
 A remedy for this pathological case is proposed.
\end_layout

\begin_layout Itemize
We incorporate the techniques by Johnson and Kercher
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

 that reduce spurious pressure oscillations into the positivity-preserving
 framework, which imposes an additional constraint on the time step size.
\end_layout

\begin_layout Itemize
The performance of the Lax-Friedrichs-type viscous flux function is assessed.
 Optimal convergence for smooth flows is observed.
 However, comparisons with the BR2 scheme indicate that when possible, the
 latter is generally still preferred.
 As such, we employ an adaptive solution procedure that only employs the
 Lax-Friedrichs-type viscous flux function when necessary.
\end_layout

\begin_layout Itemize
The proposed formulation is compatible with curved, multidimensional elements
 of arbitrary shape and general quadrature rules with positive weights.
 We first apply it to a series of one-dimensional viscous flows: advection-diffu
sion of a thermal bubble, a premixed flame, and shock-tube flow.
 More complex viscous flow problems are then considered, namely a two-dimensiona
l detonation wave enclosed by adiabatic walls and three-dimensional shock/mixing
-layer interaction.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Discrete conservation of mass, total energy, and atomic elements is demonstrated.
\end_layout

\end_inset

 Just as in the inviscid case, enforcement of the entropy bound significantly
 improves the stability of the solution.
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
The remainder of this article is organized as follows.
 The governing equations, transport properties, and thermodynamic relations
 are summarized in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:governing_equations"
plural "false"
caps "false"
noprefix "false"

\end_inset

, followed by a review of the basic DG discretization in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:DG-discretization"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:positivity-preserving-entropy-bounded-DG"
plural "false"
caps "false"
noprefix "false"

\end_inset

 presents the positivity-preserving and entropy-bounded DG method for the
 transport step.
 Results for a variety of test cases are given in the next section.
 The paper concludes with some final remarks.
\end_layout

\begin_layout Section
Governing equations
\begin_inset CommandInset label
LatexCommand label
name "sec:governing_equations"

\end_inset


\end_layout

\begin_layout Standard
The compressible, multicomponent, chemically reacting Navier-Stokes equations
 in 
\begin_inset Formula $d$
\end_inset

 spatial dimensions are given by
\begin_inset Formula 
\begin{equation}
\frac{\partial y}{\partial t}+\nabla\cdot\mathcal{F}\left(y,\nabla y\right)-\mathcal{S}\left(y\right)=0,\label{eq:conservation-law-strong-form}
\end{equation}

\end_inset

where 
\begin_inset Formula $y$
\end_inset

 is the state vector, 
\begin_inset Formula $\nabla y$
\end_inset

 is its spatial gradient, 
\begin_inset Formula $t$
\end_inset

 is time, 
\begin_inset Formula $\mathcal{F}$
\end_inset

 is the flux, and 
\begin_inset Formula $\mathcal{S}=\left(0,\ldots,0,0,\omega_{1},\ldots,\omega_{n_{s}}\right)^{T}$
\end_inset

 is the chemical source term, with 
\begin_inset Formula $\omega_{i}$
\end_inset

 corresponding to the production rate of the 
\begin_inset Formula $i$
\end_inset

th species.
 The physical coordinates are denoted by 
\begin_inset Formula $x=(x_{1},\ldots,x_{d})$
\end_inset

.
 The vector of state variables is expanded as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
y=\left(\rho v_{1},\ldots,\rho v_{d},\rho e_{t},C_{1},\ldots,C_{n_{s}}\right)^{T},\label{eq:reacting-navier-stokes-state}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho$
\end_inset

 is density, 
\begin_inset Formula $v=\left(v_{1},\ldots,v_{d}\right)$
\end_inset

 is the velocity vector, 
\begin_inset Formula $e_{t}$
\end_inset

 is the specific total energy, 
\begin_inset Formula $C=\left(C_{1},\ldots,C_{n_{s}}\right)$
\end_inset

 is the vector of molar concentrations, and 
\begin_inset Formula $n_{s}$
\end_inset

 is the number of species.
 The partial density of the 
\begin_inset Formula $i$
\end_inset

th species is defined as
\begin_inset Formula 
\[
\rho_{i}=W_{i}C_{i},
\]

\end_inset

where 
\begin_inset Formula $W_{i}$
\end_inset

 is the molecular weight of the 
\begin_inset Formula $i$
\end_inset

th species, from which the density can be computed as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\rho=\sum_{i=1}^{n_{s}}\rho_{i}.
\]

\end_inset


\end_layout

\begin_layout Standard
\noindent
The mole and mass fractions of the 
\begin_inset Formula $i$
\end_inset

th species are given by
\begin_inset Formula 
\[
X_{i}=\frac{C_{i}}{\sum_{i=1}^{n_{s}}C_{i}},\quad Y_{i}=\frac{\rho_{i}}{\rho}.
\]

\end_inset

The equation of state for the mixture is written as
\begin_inset Formula 
\begin{equation}
P=R^{0}T\sum_{i=1}^{n_{s}}C_{i},\label{eq:EOS}
\end{equation}

\end_inset

where 
\begin_inset Formula $P$
\end_inset

 is the pressure, 
\begin_inset Formula $T$
\end_inset

 is the temperature, and 
\begin_inset Formula $R^{0}$
\end_inset

 is the universal gas constant.
 The specific total energy is the sum of the mixture-averaged specific internal
 energy, 
\begin_inset Formula $u$
\end_inset

, and the specific kinetic energy, written as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
e_{t}=u+\frac{1}{2}\sum_{k=1}^{d}v_{k}v_{k},
\]

\end_inset

where the former is the mass-weighted sum of the specific internal energies
 of each species, given by
\begin_inset Formula 
\[
u=\sum_{i=1}^{n_{s}}Y_{i}u_{i}.
\]

\end_inset

With the thermally perfect gas model, 
\begin_inset Formula $u_{i}$
\end_inset

 is defined as 
\begin_inset Formula 
\[
u_{i}=h_{i}-R_{i}T=h_{\mathrm{ref},i}+\int_{T_{\mathrm{ref}}}^{T}c_{p,i}(\tau)d\tau-R_{i}T,
\]

\end_inset

where 
\begin_inset Formula $h_{i}$
\end_inset

 is the specific enthalpy of the 
\begin_inset Formula $i$
\end_inset

th species, 
\begin_inset Formula $R_{i}=R^{0}/W_{i}$
\end_inset

, 
\begin_inset Formula $T_{\mathrm{ref}}$
\end_inset

 is the reference temperature of 298.15 K, 
\begin_inset Formula $h_{\mathrm{ref},i}$
\end_inset

 is the reference-state species formation enthalpy, and 
\begin_inset Formula $c_{p,i}$
\end_inset

 is the specific heat at constant pressure of the 
\begin_inset Formula $i$
\end_inset

th species, which is approximated with a polynomial as a function of temperature
 based on the NASA coefficients
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Mcb93,Mcb02"
literal "false"

\end_inset

, i.e., 
\begin_inset Formula 
\begin{equation}
c_{p,i}=\sum_{k=0}^{n_{p}}a_{ik}T^{k}.\label{eq:specific_heat_polynomial}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\noindent
The mixture-averaged specific thermodynamic entropy is obtained via a mass-weigh
ted sum of the specific entropies of each species as
\begin_inset Formula 
\[
s=\sum_{i=1}^{n_{s}}Y_{i}s_{i},
\]

\end_inset

with 
\begin_inset Formula $s_{i}$
\end_inset

 defined as
\begin_inset Formula 
\[
s_{i}=s_{\mathrm{ref},i}^{o}+\int_{T_{\mathrm{ref}}}^{T}\frac{c_{v,i}(\tau)}{\tau}d\tau-R_{i}\log\frac{C_{i}}{C_{\mathrm{ref}}},
\]

\end_inset

where 
\begin_inset Formula $s_{\mathrm{ref},i}^{o}$
\end_inset

 is the species formation entropy at the reference temperature and reference
 pressure, 
\begin_inset Formula $P_{\mathrm{ref}}$
\end_inset

, of 1 atm, 
\begin_inset Formula $c_{v,i}=c_{p,i}-R_{i}$
\end_inset

 is the specific heat at constant volume of the 
\begin_inset Formula $i$
\end_inset

th species, and 
\begin_inset Formula $C_{\mathrm{ref}}=P_{\mathrm{ref}}/R^{0}T_{\mathrm{ref}}$
\end_inset

 is the reference concentration.
 
\end_layout

\begin_layout Standard
The flux can be expressed as the difference between the convective flux,
 
\begin_inset Formula $\mathcal{F}^{c}$
\end_inset

, and the viscous flux, 
\begin_inset Formula $\mathcal{F}^{v}$
\end_inset

, i.e.,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathcal{F}\left(y,\nabla y\right)=\left(\mathcal{F}^{c}\left(y\right)-\mathcal{F}^{v}\left(y,\nabla y\right)\right),
\]

\end_inset

where the 
\begin_inset Formula $k$
\end_inset

th spatial components are defined as
\begin_inset Formula 
\begin{equation}
\mathcal{F}_{k}^{c}\left(y\right)=\left(\rho v_{k}v_{1}+P\delta_{k1},\ldots,\rho v_{k}v_{d}+P\delta_{kd},v_{k}\left(\rho e_{t}+P\right),v_{k}C_{1},\ldots,v_{k}C_{n_{s}}\right)^{T}\label{eq:reacting-navier-stokes-spatial-convective-flux-component}
\end{equation}

\end_inset

 and 
\begin_inset Formula 
\begin{equation}
\mathcal{F}_{k}^{v}\left(y,\nabla y\right)=\left(\tau_{1k},\ldots,\tau_{dk},\sum_{j=1}^{d}\tau_{kj}v_{j}+\sum_{i=1}^{n_{s}}W_{i}C_{i}h_{i}V_{ik}-q_{k},C_{1}V_{1k},\ldots,C_{n_{s}}V_{n_{s}k}\right)^{T},\label{eq:navier-stokes-viscous-flux-spatial-component}
\end{equation}

\end_inset

respectively.
 
\begin_inset Formula $\tau$
\end_inset

 is the viscous stress tensor, 
\begin_inset Formula $q$
\end_inset

 is the heat flux, and 
\begin_inset Formula $V_{ik}$
\end_inset

 is the 
\begin_inset Formula $k$
\end_inset

th spatial component of the diffusion velocity of the 
\begin_inset Formula $i$
\end_inset

th species, defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
V_{ik}=\hat{V}_{ik}-\frac{\sum_{l=1}^{n_{s}}W_{l}C_{l}\hat{V}_{lk}}{\rho},\quad\hat{V}_{ik}=\frac{\bar{D}_{i}}{C_{i}}\frac{\partial C_{i}}{\partial x_{k}}-\frac{\bar{D}_{i}}{\rho}\frac{\partial\rho}{\partial x_{k}},
\]

\end_inset

which includes a standard correction to ensure mass conservation (i.e., 
\begin_inset Formula $\sum_{i=1}^{n_{s}}W_{i}C_{i}V_{ik}=0$
\end_inset

)
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Cof81,Hou11"
literal "false"

\end_inset

.
 
\begin_inset Formula $\bar{D}_{i}$
\end_inset

 is the mixture-averaged diffusion coefficient of the 
\begin_inset Formula $i$
\end_inset

th species, obtained as
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Kee89"
literal "false"

\end_inset


\begin_inset Formula 
\[
\bar{D}_{i}=\frac{1}{\bar{W}}\frac{\sum_{j=1,j\ne i}^{n_{s}}X_{j}W_{j}}{\sum_{j=1,j\ne i}^{n_{s}}X_{j}/D_{ij}},
\]

\end_inset

where 
\begin_inset Formula $\bar{W}=\rho/\sum_{i}C_{i}$
\end_inset

 is the mixture molecular weight and 
\begin_inset Formula $D_{ij}$
\end_inset

 is the binary diffusion coefficient between the 
\begin_inset Formula $i$
\end_inset

th and 
\begin_inset Formula $j$
\end_inset

th species, which is a positive function of temperature and pressure
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Kee05,cantera"
literal "false"

\end_inset

.
 Note that 
\begin_inset Formula $\bar{D}_{i}$
\end_inset

 can be nonzero for 
\begin_inset Formula $C_{i}=0$
\end_inset

.
 The 
\begin_inset Formula $k$
\end_inset

th spatial components of the viscous stress tensor and the heat flux are
 written as
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\[
\tau_{k}\left(y,\nabla y\right)=\mu\left(\frac{\partial v_{1}}{\partial x_{k}}+\frac{\partial v_{k}}{\partial x_{1}}-\delta_{k1}\frac{2}{3}\sum_{j=1}^{d}\frac{\partial v_{j}}{\partial x_{j}},\ldots,\frac{\partial v_{d}}{\partial x_{k}}+\frac{\partial v_{k}}{\partial x_{d}}-\delta_{kd}\frac{2}{3}\sum_{j=1}^{d}\frac{\partial v_{j}}{\partial x_{j}}\right),
\]

\end_inset


\end_layout

\begin_layout Standard
\noindent
where 
\begin_inset Formula $\mu$
\end_inset

 is the dynamic viscosity, calculated using the Wilke model
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Wil50"
literal "false"

\end_inset

, and
\begin_inset Formula 
\begin{eqnarray*}
q_{k}\left(y,\nabla y\right) & = & -\lambda_{T}\frac{\partial T}{\partial x_{k}},
\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $\lambda_{T}$
\end_inset

 is the thermal conductivity, computed with the Mathur model
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Mat67"
literal "false"

\end_inset

, respectively.
 The viscous flux can also be written as
\begin_inset Formula 
\begin{equation}
\mathcal{F}^{v}\left(y,\nabla y\right)=G\left(y\right):\nabla y\label{eq:viscous-flux-homogeneity-tensor}
\end{equation}

\end_inset

where 
\begin_inset Formula $G\left(y\right)$
\end_inset

 is the homogeneity tensor
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Har13"
literal "false"

\end_inset

, obtained by differentiating the viscous flux with respect to the gradient,
 i.e., 
\begin_inset Formula $G(y)=\partial\mathcal{F}^{v}/\partial\nabla y$
\end_inset

.
 Additional information on the thermodynamic relations, transport properties,
 and chemical reaction rates can be found in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

.
\end_layout

\begin_layout Section
Discontinuous Galerkin discretization
\begin_inset CommandInset label
LatexCommand label
name "sec:DG-discretization"

\end_inset


\end_layout

\begin_layout Standard
This section summarizes the DG discretization of Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:conservation-law-strong-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and the approach introduced by Johnson and Kercher
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

 to suppress spurious pressure oscillations in smooth regions of the flow.
\end_layout

\begin_layout Standard
Let the computational domain, 
\begin_inset Formula $\Omega$
\end_inset

, be partitioned by 
\begin_inset Formula $\mathcal{T}$
\end_inset

, which consists of non-overlapping cells, 
\begin_inset Formula $\kappa$
\end_inset

, with boundaries 
\begin_inset Formula $\partial\kappa$
\end_inset

.
 Let 
\begin_inset Formula $\mathcal{E}=\mathcal{E_{I}}\cup\mathcal{E}_{\partial}$
\end_inset

 be the set of interfaces, 
\begin_inset Formula $\epsilon$
\end_inset

, such that 
\begin_inset Formula $\cup_{\epsilon\in\mathcal{E}}\epsilon=\cup_{\kappa\in\mathcal{T}}\partial\kappa$
\end_inset

, comprised of the interior interfaces,
\begin_inset Formula 
\[
\epsilon_{\mathcal{I}}\in\mathcal{E_{I}}=\left\{ \epsilon_{\mathcal{I}}\in\mathcal{E}\middlebar\epsilon_{\mathcal{I}}\cap\partial\Omega=\emptyset\right\} ,
\]

\end_inset

and boundary interfaces, 
\begin_inset Formula 
\[
\epsilon_{\partial}\in\mathcal{E}_{\partial}=\left\{ \epsilon_{\partial}\in\mathcal{E}\middlebar\epsilon_{\partial}\subset\partial\Omega\right\} .
\]

\end_inset

At a given interior interface, there exists 
\begin_inset Formula $\kappa^{+},\kappa^{-}\in\mathcal{T}$
\end_inset

 such that 
\begin_inset Formula $\epsilon_{\mathcal{I}}=\partial\kappa^{+}\cap\partial\kappa^{-}$
\end_inset

.
 
\begin_inset Formula $n^{+}$
\end_inset

 is the outward-facing normal of 
\begin_inset Formula $\kappa^{+}$
\end_inset

, and 
\begin_inset Formula $n^{+}=-n^{-}$
\end_inset

.
 The discrete subspace 
\begin_inset Formula $V_{h}^{p}$
\end_inset

 over 
\begin_inset Formula $\mathcal{T}$
\end_inset

 is defined as
\begin_inset Formula 
\begin{eqnarray}
V_{h}^{p} & = & \left\{ \mathfrak{v}\in\left[L^{2}\left(\Omega\right)\right]^{m}\middlebar\forall\kappa\in\mathcal{T},\left.\mathfrak{v}\right|_{\kappa}\in\left[\mathcal{P}_{p}(\kappa)\right]^{m}\right\} ,\label{eq:discrete-subspace}
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $m=n_{s}+d+1$
\end_inset

 is the number of state variables and 
\begin_inset Formula $\mathcal{P}_{p}(\kappa)$
\end_inset

 in one spatial dimension is the space of polynomial functions of degree
 no greater than 
\begin_inset Formula $p$
\end_inset

 in 
\begin_inset Formula $\kappa$
\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Du et al., SIAM JSC, 2019
\end_layout

\end_inset

 In multiple dimensions, the choice of polynomial space often depends on
 the element type
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Har13"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
To solve for the discrete solution, we require 
\begin_inset Formula $y\in V_{h}^{p}$
\end_inset

 to satisfy
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{gather}
\sum_{\kappa\in\mathcal{T}}\left(\frac{\partial y}{\partial t},\mathfrak{v}\right)_{\kappa}-\sum_{\kappa\in\mathcal{T}}\left(\mathcal{F}\left(y,\nabla y\right),\nabla\mathfrak{v}\right)_{\kappa}+\sum_{\epsilon\in\mathcal{E}}\left(\mathcal{F}^{c\dagger}\left(y,n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon}-\sum_{\epsilon\in\mathcal{E}}\left(\average{\mathcal{F}^{v}\left(y,\nabla y\right)}\cdot n-\delta^{v}\left(y,\nabla y,n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon}\nonumber \\
+\sum_{\kappa\in\mathcal{T}}\left(G\left(y^{+}\right):\left(\average y-y^{+}\right)\otimes n,\nabla\mathfrak{v}\right)_{\partial\kappa}-\sum_{\kappa\in\mathcal{T}}\left(\mathcal{S}\left(y\right),\mathfrak{v}\right)_{\kappa}=0\qquad\forall\mathfrak{v}\in V_{h}^{p},\label{eq:semi-discrete-form}
\end{gather}

\end_inset

where 
\begin_inset Formula $\left(\cdot,\cdot\right)$
\end_inset

 denotes the inner product, 
\begin_inset Formula $\mathcal{F}^{c\dagger}$
\end_inset

 is the inviscid flux function, 
\begin_inset Formula $\average{\cdot}$
\end_inset

 is the average operator, 
\begin_inset Formula $\left\llbracket \cdot\right\rrbracket $
\end_inset

 is the jump operator, and 
\begin_inset Formula $\delta^{v}$
\end_inset

 is a viscous-flux penalty term that depends on the viscous flux function.
 Note that Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 corresponds to a primal formulation
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Arn02,Har13"
literal "false"

\end_inset

; in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

, a flux formulation is used.
 It is worth mentioning that the penalty term for many conventional viscous
 flux functions is not a function of the gradient, i.e., 
\begin_inset Formula $\delta^{v}=\delta^{v}(y,n)$
\end_inset

; however, as will be seen in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Positivity-preserving-Lax-Friedrichs"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the penalty term for the proposed Lax-Friedrichs-type viscous flux function
 indeed depends on the gradient.
 In this work, we employ the HLLC inviscid numerical flux
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Tor13"
literal "false"

\end_inset

.
 To compute 
\begin_inset Formula $\delta^{v}$
\end_inset

, we consider the BR2 scheme
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Bas00"
literal "false"

\end_inset

 and the proposed Lax-Friedrichs-type flux function.
 The jump operator, average operator, inviscid flux function, and penalty
 term are defined as
\begin_inset Formula 
\begin{align*}
\left\llbracket v\right\rrbracket =v^{+}-v^{-} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E_{I}},\\
\average y=\frac{1}{2}\left(y^{+}+y^{-}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E_{I}},\\
\average{\mathcal{F}^{\nu}\left(y,\nabla y\right)}=\frac{1}{2}\left(\mathcal{F}^{\nu}\left(y^{+},\nabla y^{+}\right)+\mathcal{F}^{\nu}\left(y^{-},\nabla y^{-}\right)\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E_{I}},\\
\mathcal{F}^{c\dagger}\left(y,n\right)=\mathcal{F}^{c\dagger}\left(y^{+},y^{-},n\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E_{I}},\\
\delta^{v}\left(y,\nabla y,n\right)=\delta^{v}\left(y^{+},y^{-},\nabla y^{+},\nabla y^{-},n\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E_{I}},
\end{align*}

\end_inset

at interior interfaces and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\left\llbracket v\right\rrbracket =v^{+} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\partial},\\
\average y=y_{\partial}\left(y^{+},n^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\partial},\\
\average{\mathcal{F}^{\nu}\left(y,\nabla y\right)}=\mathcal{F}_{\partial}^{\nu}\left(y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\partial},\\
\mathcal{F}^{c\dagger}\left(y,n\right)=\mathcal{F}_{\partial}^{c\dagger}\left(y^{+},n^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\partial},\\
\delta^{v}\left(y,\nabla y,n\right)=\delta_{\partial}^{v}\left(y^{+},y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+},n^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\partial},
\end{align*}

\end_inset

at boundary interfaces, where 
\begin_inset Formula $y_{\partial}\left(y^{+},n^{+}\right)$
\end_inset

 is the boundary state, 
\begin_inset Formula $\mathcal{F}_{\partial}^{c\dagger}\left(y^{+},n^{+}\right)$
\end_inset

 is the inviscid boundary flux function, 
\begin_inset Formula $\mathcal{F}_{\partial}^{\nu}\left(y_{\partial}\left(y^{+}\right),\nabla y^{+},n^{+}\right)$
\end_inset

 is the viscous boundary flux, and 
\begin_inset Formula $\delta_{\partial}^{v}\left(y^{+},y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+},n^{+}\right)$
\end_inset

 is the boundary penalty term.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:boundary-conditions"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides a discussion of the prescription of various boundary conditions.
\end_layout

\begin_layout Standard
Strang splitting
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Str68"
literal "false"

\end_inset

 is applied to decouple the temporal integration of the transport operators
 from that of the stiff chemical source term over a given interval 
\begin_inset Formula $(t_{0},t_{0}+\Delta t]$
\end_inset

 as
\begin_inset Formula 
\begin{align}
\frac{\partial y}{\partial t}+\nabla\cdot\mathcal{F}\left(y\right)=0 & \textup{ in }\Omega\times\left(t_{0},t_{0}+\nicefrac{\Delta t}{2}\right],\label{eq:strang-splitting-1}\\
\frac{\partial y}{\partial t}-\mathcal{S}\left(y\right)=0 & \textup{ in }\left(t_{0},t_{0}+\Delta t\right],\label{eq:strang-splitting-2}\\
\frac{\partial y}{\partial t}+\nabla\cdot\mathcal{F}\left(y\right)=0 & \textup{ in }\Omega\times\left(t_{0}+\nicefrac{\Delta t}{2},t_{0}+\Delta t\right].\label{eq:strang-splitting-3}
\end{align}

\end_inset

Equations
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:strang-splitting-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:strang-splitting-3"
plural "false"
caps "false"
noprefix "false"

\end_inset

 are advanced in time using a strong-stability-preserving Runge-Kutta method
 (SSPRK)
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Got01,Spi02"
literal "false"

\end_inset

, whereas Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:strang-splitting-2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is solved using a fully implicit, temporal DG discretization.
 Since the reaction step is identical between the inviscid and viscous cases,
 we refer the reader to
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22_2"
literal "false"

\end_inset

 for more details on the DG discretization in time for Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:strang-splitting-2"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Here, we focus on the transport step.
\end_layout

\begin_layout Standard
We assume a nodal basis, such that the local solution approximation is given
 by
\begin_inset Formula 
\begin{equation}
y_{\kappa}=\sum_{j=1}^{n_{b}}y_{\kappa}(x_{j})\phi_{j},\label{eq:solution-approximation}
\end{equation}

\end_inset

where 
\begin_inset Formula $\phi_{j}$
\end_inset

 is the 
\begin_inset Formula $j$
\end_inset

th basis function, 
\begin_inset Formula $n_{b}$
\end_inset

 is the number of basis functions, and 
\begin_inset Formula $x_{j}$
\end_inset

 is the physical coordinate of the 
\begin_inset Formula $j$
\end_inset

th node.
 The volume and surface integrals in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 are computed using a quadrature-free approach
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Atk96,Atk98"
literal "false"

\end_inset

.
 Furthermore, the flux can be approximated as
\begin_inset Formula 
\begin{equation}
\mathcal{F_{\kappa}}\left(y\right)\approx\sum_{k=1}^{n_{c}}\mathcal{F}\left(y_{\kappa}\left(x_{k}\right),\nabla y_{\kappa}\left(x_{k}\right)\right)\varphi_{k},\label{eq:flux-projection}
\end{equation}

\end_inset

where 
\begin_inset Formula $n_{c}\geq n_{b}$
\end_inset

 and 
\begin_inset Formula $\left\{ \varphi_{1},\ldots,\varphi_{n_{c}}\right\} $
\end_inset

 is a set of basis functions that may be different from those in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:solution-approximation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 As discussed in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

, pressure equilibrium is (approximately) maintained in smooth regions of
 the flow and at material interfaces if 
\begin_inset Formula $n_{c}=n_{b}$
\end_inset

 and the integration points are in the solution nodal set.
 However, if over-integration is desired (i.e., 
\begin_inset Formula $n_{c}>n_{b}$
\end_inset

), the standard flux interpolation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

 results in the rapid generation of large spurious pressure oscillations.
 Therefore, in the case of over-integration, Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is replaced with
\begin_inset Formula 
\begin{equation}
\mathcal{F_{\kappa}}\left(y\right)\approx\sum_{k=1}^{n_{c}}\mathcal{F}_{\kappa}\left(\widetilde{y}_{\kappa}\left(x_{k}\right),\nabla y_{\kappa}\left(x_{k}\right)\right)\varphi_{k}=\sum_{k=1}^{n_{c}}\mathcal{F}_{\kappa}^{c}\left(\widetilde{y}_{\kappa}\left(x_{k}\right)\right)\varphi_{k}-\sum_{k=1}^{n_{c}}\mathcal{F}_{\kappa}^{v}\left(\widetilde{y}_{\kappa}\left(x_{k}\right),\nabla y_{\kappa}\left(x_{k}\right)\right)\varphi_{k},\label{eq:modified-flux-projection}
\end{equation}

\end_inset

where
\begin_inset Formula 
\[
\mathcal{F}_{\kappa}^{v}\left(\widetilde{y}_{\kappa}\left(x_{k}\right),\nabla y_{\kappa}\left(x_{k}\right)\right)=G\left(\widetilde{y}_{\kappa}\left(x_{k}\right)\right):\nabla y_{\kappa}\left(x_{k}\right)
\]

\end_inset

and 
\begin_inset Formula $\widetilde{y}$
\end_inset

 is a modified state given by
\begin_inset Formula 
\begin{equation}
\widetilde{y}\left(y,\widetilde{P}\right)=\left(\rho v_{1},\ldots,\rho v_{d},\widetilde{\rho u}\left(C_{1},\ldots,C_{n_{s}},\widetilde{P}\right)+\frac{1}{2}\sum_{k=1}^{d}\rho v_{k}v_{k},C_{1},\ldots,C_{n_{s}}\right)^{T}.\label{eq:interpolated-state-modified}
\end{equation}

\end_inset


\begin_inset Formula $\widetilde{P}$
\end_inset

 in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:interpolated-state-modified"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is a polynomial in 
\begin_inset Formula $\mathcal{P}_{p}(\kappa)$
\end_inset

 that approximates the pressure as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\widetilde{P}_{\kappa}=\sum_{j=1}^{n_{b}}P\left(y_{\kappa}\left(x_{j}\right)\right)\phi_{j},
\]

\end_inset

from which the modified internal energy, 
\begin_inset Formula $\widetilde{\rho u}$
\end_inset

, is calculated.
 Furthermore, in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $\delta^{v}\left(y,\nabla y,n\right)$
\end_inset

 and 
\begin_inset Formula $G\left(y^{+}\right):\left(\average y-y^{+}\right)\otimes n$
\end_inset

 are replaced with 
\begin_inset Formula $\delta^{v}\left(\widetilde{y},\nabla y,n\right)$
\end_inset

 and 
\begin_inset Formula $G\left(\widetilde{y}^{+}\right):\left(\average{\widetilde{y}}-\widetilde{y}^{+}\right)\otimes n$
\end_inset

, respectively.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
The modified flux interpolation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:modified-flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

 successfully preserves pressure equilibrium within and between elements
 (unless the solution is not adequately resolved, in which case measurable
 pressure disturbances are inevitable).
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Since the linear-scaling limiter used to enforce the positivity property
 and entropy boundedness does not completely eliminate small-scale nonphysical
 artifacts
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha10,Jia18,Lv15_2,Wu21_2"
literal "false"

\end_inset

, especially near non-smooth features, we add the artificial dissipation
 term
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Har13"
literal "false"

\end_inset


\begin_inset Formula 
\begin{equation}
-\sum_{\kappa\in\mathcal{T}}\left(\nu_{\mathrm{AV}}\nabla y,\nabla\mathfrak{v}\right)_{\kappa}\label{eq:artificial-viscosity-integral}
\end{equation}

\end_inset

to the LHS of Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

, where 
\begin_inset Formula $\nu_{\mathrm{AV}}$
\end_inset

 is the artificial viscosity, calculated as
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset


\begin_inset Formula 
\[
\nu_{\mathrm{AV}}=\left(C_{\mathrm{AV}}+S_{\mathrm{AV}}\right)\left(\frac{h^{2}}{p+1}\left|\frac{\partial T}{\partial y}\cdot\frac{\mathcal{R}\left(y,\nabla y\right)}{T}\right|\right).
\]

\end_inset


\begin_inset Formula $S_{\mathrm{AV}}$
\end_inset

 is a shock sensor based on solution variations inside a given element
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi19"
literal "false"

\end_inset

, 
\begin_inset Formula $C_{\mathrm{AV}}$
\end_inset

 is a user-defined parameter, 
\begin_inset Formula $h$
\end_inset

 is a length scale associated with the element, and 
\begin_inset Formula $\mathcal{R}\left(y,\nabla y\right)$
\end_inset

 is the strong form of the residual
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:conservation-law-strong-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In our previous work, this artificial viscosity formulation effectively
 mitigated small-scale nonlinear instabilities in various multicomponent-flow
 problems
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2,Chi22"
literal "false"

\end_inset

.
 However, other types of artificial viscosity or limiters can be employed
 instead.
 Additional details on the basic DG discretization and the issue of pressure
 equilibrium preservation can be found in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

.
\end_layout

\begin_layout Section
Transport step: Positivity-preserving, entropy-bounded discontinuous Galerkin
 method
\begin_inset CommandInset label
LatexCommand label
name "sec:positivity-preserving-entropy-bounded-DG"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathcal{G}_{\sigma}$
\end_inset

 denote the following set:
\begin_inset Formula 
\begin{equation}
\mathcal{G}_{\sigma}=\left\{ y\mid\rho>0,\rho u^{*}>0,C_{1}\geq0,\ldots,C_{n_{s}}\geq0,\chi_{\sigma}\geq0\right\} ,
\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma\in\mathbb{R}$
\end_inset

, 
\begin_inset Formula $\chi_{\sigma}=\rho s-\rho\sigma$
\end_inset

, and 
\begin_inset Formula $u^{*}$
\end_inset

 is the 
\begin_inset Quotes eld
\end_inset

shifted
\begin_inset Quotes erd
\end_inset

 internal energy
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Hua19"
literal "false"

\end_inset

, calculated as
\begin_inset Formula 
\begin{equation}
u^{*}=u-u_{0},\quad u_{0}=\left.u\right|_{T=0},\label{eq:shifted-internal-energy}
\end{equation}

\end_inset

such that 
\begin_inset Formula $u^{*}>0$
\end_inset

 if and only if 
\begin_inset Formula $T>0$
\end_inset

, provided 
\begin_inset Formula $c_{v,i}>0,\:i=1,\ldots,n_{s}$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Gio99"
literal "false"

\end_inset

.
 Note that 
\begin_inset Formula $\rho>0$
\end_inset

 and 
\begin_inset Formula $u^{*}>0$
\end_inset

 imply 
\begin_inset Formula $P(y)>0$
\end_inset

.
 The 
\begin_inset Formula $\chi_{\sigma}>0$
\end_inset

 inequality is associated with entropy boundedness, which will be discussed
 in more detail later in this section.
 Let 
\begin_inset Formula $\mathcal{G}$
\end_inset

 denote a similar set, but without the entropy constraint, i.e.,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{G}=\left\{ y\mid\rho>0,\rho u^{*}>0,C_{1}\geq0,\ldots,C_{n_{s}}\geq0\right\} .
\end{equation}

\end_inset

Since 
\begin_inset Formula $\rho u^{*}(y)$
\end_inset

 is a concave function of the state
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

, 
\begin_inset Formula $\mathcal{G}$
\end_inset

 is a convex set.
 If all species concentrations are strictly positive, then for a given 
\begin_inset Formula $\sigma$
\end_inset

, 
\begin_inset Formula $\chi_{\sigma}$
\end_inset

 is concave
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Jia18,Chi22,Gou20"
literal "false"

\end_inset

 and 
\begin_inset Formula $\mathcal{G}_{\sigma}$
\end_inset

 is also a convex set.
 However, if any of the species concentrations is zero, then 
\begin_inset Formula $\chi_{\sigma}$
\end_inset

 is no longer concave
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Gou20,Gou20_2"
literal "false"

\end_inset

.
 For the remainder of this paper, in any discussion of entropy, 
\begin_inset Formula $\mathcal{G}_{\sigma}$
\end_inset

 is always assumed to be a convex set.
 Note that this assumption does not seem to have any discernible negative
 effects on the solver
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22,Chi22_2"
literal "false"

\end_inset

.
 In addition, as will be made clear in the upcoming subsection and Remark
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

, positive species concentrations are assumed until Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

, wherein this restriction is relaxed to allow for consideration of zero
 concentrations.
\end_layout

\begin_layout Subsection
Positivity-preserving Lax-Friedrichs-type viscous flux function
\begin_inset CommandInset label
LatexCommand label
name "subsec:Positivity-preserving-Lax-Friedrichs"

\end_inset


\end_layout

\begin_layout Standard
In this subsection, we extend the local Lax-Friedrichs-type viscous flux
 function by Zhang
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

 to multicomponent flows with species diffusion.
 In particular, we consider the viscous flux separately from the inviscid
 flux, unlike Du and Yang
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Du22"
literal "false"

\end_inset

, who adapted said flux function to multicomponent flows in a manner that
 treats both fluxes simultaneously.
 Unless otherwise specified, we assume this flux function is employed for
 the remainder of the section.
 The penalty term takes the form
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset


\begin_inset Formula 
\[
\delta^{v}(y^{+},y^{-},\nabla y^{+},\nabla y^{-},n)=\frac{\beta}{2}\left(y^{+}-y^{-}\right),
\]

\end_inset

where 
\begin_inset Formula $\beta>0$
\end_inset

 is the dissipation coefficient.
 The lemma below introduces a constraint on the definition of 
\begin_inset Formula $\beta$
\end_inset

 that is essential for satisfaction of the positivity property by the DG
 formulation, as will be discussed in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:1D-PPDG-high-order"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:thermal-bubble"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we demonstrate that this viscous flux function achieves optimal convergence
 for smooth flows.
 For compatibility with boundary conditions and the aforementioned techniques
 to reduce spurious pressure oscillations, the definition of 
\begin_inset Formula $\beta$
\end_inset

 is first presented in terms of the following expansion of the viscous flux:
\begin_inset Formula 
\[
\mathcal{F}^{v}=\left(\mathcal{F}_{\rho v}^{v},\mathcal{F}_{\rho e_{t}}^{v},\mathcal{F}_{C_{1}}^{v},\ldots,\mathcal{F}_{C_{n_{s}}}^{v}\right)^{T},
\]

\end_inset

where 
\begin_inset Formula $\mathcal{F}_{\rho v}^{v}$
\end_inset

 is the viscous momentum flux, 
\begin_inset Formula $\mathcal{F}_{\rho e_{t}}^{v}$
\end_inset

 is the viscous total-energy flux, and 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}$
\end_inset

 is the viscous molar flux of the 
\begin_inset Formula $i$
\end_inset

th species.
 Furthermore, until Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we assume that all species concentrations are strictly positive, unless
 otherwise specified.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:beta-constraints"

\end_inset

Assume that 
\begin_inset Formula $y=\left(\rho v,\rho e_{t},C\right)^{T}$
\end_inset

 is in 
\begin_inset Formula $\mathcal{G}$
\end_inset

 and that 
\begin_inset Formula $C_{i}>0,\:\forall i$
\end_inset

.
 Then 
\begin_inset Formula $y\pm\beta^{-1}\mathcal{F}^{v}\cdot n$
\end_inset

, where 
\begin_inset Formula $n$
\end_inset

 is a given unit vector, is also in 
\begin_inset Formula $\mathcal{G}$
\end_inset

 under the following conditions:
\end_layout

\begin_layout Lemma
\begin_inset Formula 
\begin{equation}
\beta>\beta^{*}\left(y,\mathcal{F}^{v},n\right)=\left.\max\left\{ \max_{i=1,\ldots,n_{s}}\frac{\left|\mathcal{F}_{C_{i}}^{v}\cdot n\right|}{C_{i}},\beta_{T}\right\} \right|_{\left(y,\mathcal{F}^{v},n\right)},\label{eq:beta-constraint}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\beta_{T}=\frac{\left|b\right|+\sqrt{b^{2}+2\rho^{2}u^{*}\left|\mathcal{F}_{\rho v}^{v}\cdot n\right|^{2}}}{2\rho^{2}u^{*}},\label{eq:beta_T}
\end{equation}

\end_inset

with 
\begin_inset Formula $b=\rho\mathcal{F}_{\rho e_{t}}^{v}\cdot n-\rho v\cdot\mathcal{F}_{\rho v}^{v}\cdot n$
\end_inset

.
\end_layout

\begin_layout Proof
\begin_inset Formula $y\pm\beta^{-1}\mathcal{F}^{v}\cdot n$
\end_inset

 can be expanded as
\begin_inset Formula 
\[
\begin{split}y\pm\beta^{-1}\mathcal{F}^{v}\cdot n= & \left(\rho v\pm\beta^{-1}\mathcal{F}_{\rho v}^{v}\cdot n,\rho e_{t}\pm\beta^{-1}\mathcal{F}_{\rho e_{t}}^{v}\cdot n,C_{1}\pm\beta^{-1}\mathcal{F}_{C_{1}}^{v}\cdot n,\ldots,C_{n_{s}}\pm\beta^{-1}\mathcal{F}_{C_{n_{s}}}^{v}\cdot n\right)^{T}.\end{split}
\]

\end_inset

First, we focus on positivity of density and species concentrations.
 For the 
\begin_inset Formula $i$
\end_inset

th species, 
\begin_inset Formula $C_{i}\pm\beta^{-1}\mathcal{F}_{C_{i}}^{v}\cdot n>0$
\end_inset

 if and only if 
\begin_inset Formula $\beta>\left|\mathcal{F}_{C_{i}}^{v}\cdot n\right|/C_{i}$
\end_inset

.
 Accounting for all species yields
\begin_inset Formula 
\begin{equation}
\beta>\max_{i=1,\ldots,n_{s}}\frac{\left|\mathcal{F}_{C_{i}}^{v}\cdot n\right|}{C_{i}}.\label{eq:beta-constraint-concentration}
\end{equation}

\end_inset

Density is then also positive.
 
\end_layout

\begin_layout Proof
Next, we focus on positivity of temperature.
 For a given 
\begin_inset Formula $y=\left(\rho v,\rho e_{t},C\right)^{T}$
\end_inset

, let 
\begin_inset Formula $Z(y)$
\end_inset

 be defined as
\begin_inset Formula 
\begin{equation}
Z(y)=\rho^{2}u^{*}(y)=\rho(y)\rho e_{t}-\left|\rho v\right|^{2}/2-\rho^{2}u_{0}(y).\label{eq:Z-definition}
\end{equation}

\end_inset

Note that 
\begin_inset Formula $Z(y)>0$
\end_inset

 implies 
\begin_inset Formula $T(y)>0$
\end_inset

.
 
\begin_inset Formula $Z\left(y\pm\beta^{-1}\mathcal{F}^{v}\cdot n\right)$
\end_inset

 can be expressed as
\begin_inset Formula 
\begin{align*}
Z\left(y\pm\beta^{-1}\mathcal{F}^{v}\cdot n\right)= & \sum_{i=1}^{n_{s}}W_{i}\left(C_{i}\pm\beta^{-1}\mathcal{F}_{C_{i}}^{v}\cdot n\right)\left(\rho e_{t}\pm\beta^{-1}\mathcal{F}_{\rho e_{t}}^{v}\cdot n\right)\\
 & -\frac{1}{2}\left|\rho v\pm\beta^{-1}\mathcal{F}_{\rho v}^{v}\cdot n\right|^{2}-\left[\sum_{i=1}^{n_{s}}W_{i}\left(C_{i}\pm\beta^{-1}\mathcal{F}_{C_{i}}^{v}\cdot n\right)\right]^{2}u_{0},
\end{align*}

\end_inset

which, after multiplying both sides by 
\begin_inset Formula $\beta^{2}$
\end_inset

 and some algebraic manipulation, can be rewritten as 
\begin_inset Formula 
\begin{align}
\beta^{2}Z\left(y\pm\beta^{-1}\mathcal{F}^{v}\cdot n\right)= & \rho^{2}u^{*}\beta^{2}\pm b\beta+g,\label{eq:beta-quadratic-form}
\end{align}

\end_inset

where 
\begin_inset Formula $b=\rho e_{t}M+\rho\mathcal{F}_{\rho e_{t}}^{v}\cdot n-\rho v\cdot\mathcal{F}_{\rho v}^{v}\cdot n-2\rho u_{0}M$
\end_inset

, 
\begin_inset Formula $g=M\mathcal{F}_{\rho e_{t}}^{v}\cdot n-\frac{1}{2}\left|\mathcal{F}_{\rho v}^{v}\cdot n\right|^{2}-u_{0}M^{2}$
\end_inset

, and 
\begin_inset Formula $M=\sum_{i=1}^{n_{s}}W_{i}\mathcal{F}_{C_{i}}^{v}\cdot n$
\end_inset

.
 By mass conservation, 
\begin_inset Formula $M=0$
\end_inset

, such that 
\begin_inset Formula $b=\rho\mathcal{F}_{\rho e_{t}}^{v}\cdot n-\rho v\cdot\mathcal{F}_{\rho v}^{v}\cdot n$
\end_inset

 and 
\begin_inset Formula $g=-\frac{1}{2}\left|\mathcal{F}_{\rho v}^{v}\cdot n\right|^{2}$
\end_inset

.
 Setting the RHS of Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-quadratic-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 equal to zero yields two quadratic equations with 
\begin_inset Formula $\beta$
\end_inset

 as the unknowns.
 Since 
\begin_inset Formula $\rho^{2}u^{*}$
\end_inset

 is positive, the two quadratic equations are convex.
 Furthermore, since 
\begin_inset Formula $b^{2}+2\rho^{2}u^{*}\left|\mathcal{F}_{\rho v}^{v}\cdot n\right|^{2}\geq0$
\end_inset

, for each of the two quadratic equations, the roots are real and at least
 one is nonnegative.
 A sufficient condition to ensure 
\begin_inset Formula $Z\left(y\pm\beta^{-1}\mathcal{F}^{v}\cdot n\right)>0$
\end_inset

 is 
\begin_inset Formula $\beta>\beta_{T}\geq0$
\end_inset

, where 
\begin_inset Formula $\beta_{T}$
\end_inset

, given by Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta_T"
plural "false"
caps "false"
noprefix "false"

\end_inset

, is the largest of all roots of the quadratic equations.
 Combining this with the inequality
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint-concentration"
plural "false"
caps "false"
noprefix "false"

\end_inset

 yields
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:zero-species-concentrations"

\end_inset

Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:beta-constraints"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and the inequality
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint-concentration"
plural "false"
caps "false"
noprefix "false"

\end_inset

 assume that the species concentrations are positive.
 If 
\begin_inset Formula $C_{i}=0$
\end_inset

 and 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\cdot n\neq0$
\end_inset

, then there exists no finite value of 
\begin_inset Formula $\beta$
\end_inset

 such that 
\begin_inset Formula $C_{i}\pm\beta^{-1}\mathcal{F}_{C_{i}}^{v}\cdot n\geq0$
\end_inset

 since 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}$
\end_inset

 is not directly proportional to 
\begin_inset Formula $C_{i}$
\end_inset

.
 Specifically, the 
\begin_inset Formula $k$
\end_inset

th spatial component of 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}(y,\nabla y)$
\end_inset

 can be written as
\begin_inset Formula 
\begin{align}
\mathcal{F}_{C_{i},k}^{v}(y,\nabla y) & =C_{i}V_{ik}\nonumber \\
 & =C_{i}\hat{V}_{ik}-\frac{C_{i}\sum_{l=1}^{n_{s}}W_{l}C_{l}\hat{V}_{lk}}{\rho}\nonumber \\
 & =\bar{D}_{i}\frac{\partial C_{i}}{\partial x_{k}}-\frac{C_{i}\bar{D}_{i}}{\rho}\frac{\partial\rho}{\partial x_{k}}-\frac{C_{i}}{\rho}\sum_{l=1}^{n_{s}}W_{l}\left(\bar{D}_{l}\frac{\partial C_{l}}{\partial x_{k}}-\frac{C_{l}\bar{D}_{l}}{\rho}\frac{\partial\rho}{\partial x_{k}}\right),\label{eq:molar_flux_definition}
\end{align}

\end_inset

such that 
\begin_inset Formula $\mathcal{F}_{C_{i},k}^{v}$
\end_inset

 can be nonzero even if 
\begin_inset Formula $C_{i}=0$
\end_inset

.
 As previously mentioned, however, it is crucial to account for zero concentrati
ons.
 In Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we relax this restriction and discuss how to ensure nonnegative species
 concentrations, which is done in a different manner from how positive density
 and temperature are guaranteed.
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:beta-not-abstract-form"

\end_inset

The constraint on 
\begin_inset Formula $\beta$
\end_inset

 in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is left in abstract form, i.e., in terms of 
\begin_inset Formula $\mathcal{F}^{v}=\left(\mathcal{F}_{\rho v}^{v},\mathcal{F}_{\rho e_{t}}^{v},\mathcal{F}_{C_{1}}^{v},\ldots,\mathcal{F}_{C_{n_{s}}}^{v}\right)^{T}$
\end_inset

.
 This is to allow for consideration of, for example, 
\begin_inset Formula $\widetilde{y}\pm\mathcal{F}^{v}\left(\widetilde{y},\nabla y\right)\cdot n$
\end_inset

, where 
\begin_inset Formula $y\neq\widetilde{y}$
\end_inset

, which is necessary for the modified flux interpolation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:modified-flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and for boundary conditions.
 If we take 
\begin_inset Formula $\mathcal{F}^{v}=\mathcal{F}^{v}\left(y,\nabla y\right)$
\end_inset

 and substitute the definitions of each component of 
\begin_inset Formula $\mathcal{F}^{v}$
\end_inset

, the constraint on 
\begin_inset Formula $\beta$
\end_inset

 reduces to
\end_layout

\begin_layout Remark
\begin_inset Formula 
\begin{equation}
\beta>\max\left\{ \max_{i=1,\ldots,n_{s}}\left|V_{i}\cdot n\right|,\beta_{T}\right\} ,\label{eq:beta-constraint-reduced}
\end{equation}

\end_inset

where Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta_T"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is now given by
\end_layout

\begin_layout Remark
\begin_inset Formula 
\[
\beta_{T}=\frac{\left|b\right|+\sqrt{b^{2}+2\rho^{2}u^{*}\left|\tau\cdot n\right|^{2}}}{2\rho^{2}u^{*}},
\]

\end_inset

with
\begin_inset Formula 
\[
b=\rho q\cdot n+\rho\sum_{i=1}^{n_{s}}W_{i}C_{i}h_{i}V_{i}\cdot n.
\]

\end_inset

Related to Remark
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $V_{i}$
\end_inset

 in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint-reduced"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can blow up as 
\begin_inset Formula $C_{i}\rightarrow0$
\end_inset

 (unless 
\begin_inset Formula $\nabla C_{i}=0$
\end_inset

).
 If species diffusion is neglected, these expressions recover those in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

 for the monocomponent case.
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset Formula $\sum_{i}W_{i}\left[C_{i}\pm\beta^{-1}\mathcal{F}_{C_{i}}^{v}(C,\nabla C)\cdot n\right]$
\end_inset

 recovers 
\begin_inset Formula $\rho$
\end_inset

 since 
\begin_inset Formula 
\begin{align*}
\sum_{i=1}^{n_{s}}W_{i}\left[C_{i}\pm\beta^{-1}\mathcal{F}_{C_{i}}^{v}(C,\nabla C)\cdot n\right] & =\sum_{i=1}^{n_{s}}W_{i}C_{i}\pm\beta^{-1}\sum_{i=1}^{n_{s}}W_{i}C_{i}V_{i}\cdot n\\
 & =\sum_{i=1}^{n_{s}}W_{i}C_{i}\\
 & =\rho,
\end{align*}

\end_inset

where the second line is due to mass conservation, i.e., 
\begin_inset Formula $\sum_{i=1}^{n_{s}}W_{i}C_{i}V_{ik}=0,\;k=1,\ldots,d$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
Combining the convective and diffusive fluxes into a single flux, as done
 by Zhang
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

 and Du and Yang
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Du22"
literal "false"

\end_inset

, results in a different constraint on 
\begin_inset Formula $\beta$
\end_inset

.
 As discussed in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Introduction"
plural "false"
caps "false"
noprefix "false"

\end_inset

, in this work, we elect to use the HLLC inviscid flux function since in
 our experience, it typically produces more accurate solutions than the
 Lax-Friedrichs inviscid flux function.
 As such, the inviscid and viscous fluxes are treated separately in our
 formulation.
\end_layout

\begin_layout Subsection
One-dimensional case
\begin_inset space ~
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:1D-PPDG"

\end_inset


\end_layout

\begin_layout Standard
In this subsection, we consider the one-dimensional case.
 We first focus on 
\begin_inset Formula $p=0$
\end_inset

 before proceeding to 
\begin_inset Formula $p\geq1$
\end_inset

.
 Without loss of generality, we assume a uniform grid with element size
 
\begin_inset Formula $h$
\end_inset

.
\end_layout

\begin_layout Subsubsection
First-order DG scheme in one dimension
\begin_inset CommandInset label
LatexCommand label
name "subsec:1D-PPDG-first-order"

\end_inset


\end_layout

\begin_layout Standard
Consider the following 
\begin_inset Formula $p=0$
\end_inset

, element-local DG discretization with forward Euler time stepping:
\begin_inset Formula 
\begin{equation}
\begin{aligned}y_{\kappa}^{j+1}= & y_{\kappa}^{j}-\frac{\Delta t}{h}\left[\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j},y_{\kappa_{L}}^{j},-1\right)+\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j},y_{\kappa_{R}}^{j},1\right)\right]\\
 & +\frac{\Delta t}{h}\left[-\mathcal{F}^{v}\left(y_{\kappa_{L}}^{j},\nabla y_{\kappa_{L}}^{j}\right)+\mathcal{F}^{v}\left(y_{\kappa_{R}}^{j},\nabla y_{\kappa_{R}}^{j}\right)-\delta^{v}\left(y_{\kappa}^{j},y_{\kappa_{L}}^{j},\nabla y_{\kappa}^{j},\nabla y_{\kappa_{L}}^{j},-1\right)-\delta^{v}\left(y_{\kappa}^{j},y_{\kappa_{R}}^{j},\nabla y_{\kappa}^{j},\nabla y_{\kappa_{R}}^{j},1\right)\right],
\end{aligned}
\label{eq:p0-DG-1D}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta t$
\end_inset

 is the time step size, 
\begin_inset Formula $j$
\end_inset

 is the time step index, and 
\begin_inset Formula $\kappa_{L}$
\end_inset

 and 
\begin_inset Formula $\kappa_{R}$
\end_inset

 are the elements to the left and right of 
\begin_inset Formula $\kappa$
\end_inset

, respectively.
 Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:p0-DG-1D"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be rearranged to split the convective and diffusive contributions as
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset


\begin_inset Formula 
\begin{align}
y_{\kappa}^{j+1} & =\frac{1}{2}\left(y_{\kappa,c}^{j+1}+y_{\kappa,v}^{j+1}\right),\\
y_{\kappa,c}^{j+1} & =y_{\kappa}^{j}-\frac{\Delta t^{*}}{h}\left[\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j},y_{\kappa_{L}}^{j},-1\right)+\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j},y_{\kappa_{R}}^{j},1\right)\right],\\
y_{\kappa,v}^{j+1} & =y_{\kappa}^{j}+\frac{\Delta t^{*}}{h}\left[-\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa_{L}}^{j},\nabla y_{\kappa_{L}}^{j}\right)+\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa_{R}}^{j},\nabla y_{\kappa_{R}}^{j}\right)-\delta^{v}\left(y_{\kappa}^{j},y_{\kappa_{L}}^{j},\nabla y_{\kappa}^{j},\nabla y_{\kappa_{L}}^{j},-1\right)-\delta^{v}\left(y_{\kappa}^{j},y_{\kappa_{R}}^{j},\nabla y_{\kappa}^{j},\nabla y_{\kappa_{R}}^{j},1\right)\right],\label{eq:p0-1D-viscous-contribution}
\end{align}

\end_inset

where 
\begin_inset Formula $\Delta t^{*}=2\Delta t$
\end_inset

.
\end_layout

\begin_layout Standard
First taking into account the convective contribution, let 
\begin_inset Formula $\lambda$
\end_inset

 be an upper bound on the maximum wave speed of the system.
 
\begin_inset Formula $y_{\kappa}^{j},y_{\kappa_{L}}^{j},y_{\kappa_{R}}^{j}\in\mathcal{G}_{\sigma}$
\end_inset

 implies 
\begin_inset Formula $y_{\kappa,c}^{j+1}\in\mathcal{G}_{\sigma}$
\end_inset

 if an 
\emph on
invariant-region-preserving
\emph default
 flux function
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Jia18"
literal "false"

\end_inset

 is employed and the time step size satisfies
\begin_inset Formula 
\begin{equation}
\frac{\Delta t^{*}\lambda}{h}\leq\frac{1}{2}.\label{eq:p0-time-step-constraint-inviscid}
\end{equation}

\end_inset

The Godunov, Lax-Friedrichs, HLL, and HLLC inviscid flux functions are invariant
-region-preserving
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Jia18"
literal "false"

\end_inset

.
 Since the focus of this paper is the diffusive contribution, we refer the
 reader to
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

 and the references therein for additional information on the convective
 contribution.
 
\end_layout

\begin_layout Standard
For 
\begin_inset Formula $p=0$
\end_inset

, 
\begin_inset Formula $\mathcal{F}^{v}\left(y_{\kappa},\nabla y_{\kappa}\right)=G(y_{\kappa}):\nabla y_{\kappa}=0$
\end_inset

 since 
\begin_inset Formula $\nabla y_{\kappa}=0$
\end_inset

.
 As such, Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:p0-1D-viscous-contribution"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reduces to
\begin_inset Formula 
\begin{align}
y_{\kappa,v}^{j+1} & =y_{\kappa}^{j}+\frac{\Delta t^{*}}{h}\left[-\delta^{v}\left(y_{\kappa}^{j},y_{\kappa_{L}}^{j},\nabla y_{\kappa}^{j},\nabla y_{\kappa_{L}}^{j},-1\right)-\delta^{v}\left(y_{\kappa}^{j},y_{\kappa_{R}}^{j},\nabla y_{\kappa}^{j},\nabla y_{\kappa_{R}}^{j},1\right)\right]\nonumber \\
 & =\left[1-\frac{\Delta t^{*}}{2h}\left(\beta_{\kappa_{L}}+\beta_{\kappa_{R}}\right)\right]y_{\kappa}^{j}+\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}y_{\kappa_{L}}^{j}+\frac{\Delta t^{*}}{2h}\beta_{\kappa_{R}}y_{\kappa_{R}}^{j}.\label{eq:p0-1D-viscous-contribution-convex-combination}
\end{align}

\end_inset

Under the time-step-size constraint 
\begin_inset Formula 
\[
\frac{\Delta t^{*}}{2h}\max_{\kappa}\left(\beta_{\kappa_{L}}+\beta_{\kappa_{R}}\right)\leq1,
\]

\end_inset

the RHS of Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:p0-1D-viscous-contribution-convex-combination"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is a convex combination of 
\begin_inset Formula $y_{\kappa}^{j}$
\end_inset

, 
\begin_inset Formula $y_{\kappa_{L}}^{j}$
\end_inset

, and 
\begin_inset Formula $y_{\kappa_{R}}^{j}$
\end_inset

 for any 
\begin_inset Formula $\kappa$
\end_inset

.
 
\begin_inset Formula $y_{\kappa}^{j},y_{\kappa_{L}}^{j},y_{\kappa_{R}}^{j}\in\mathcal{G}$
\end_inset

 then implies 
\begin_inset Formula $y_{\kappa,v}^{j+1}\in\mathcal{G}$
\end_inset

.
 This holds even for zero species concentrations.
 Finally, since 
\begin_inset Formula $y_{\kappa}^{j+1}$
\end_inset

 is a convex combination of 
\begin_inset Formula $y_{\kappa,c}^{j+1}$
\end_inset

 and 
\begin_inset Formula $y_{\kappa,v}^{j+1}$
\end_inset

, 
\begin_inset Formula $y_{\kappa}^{j},y_{\kappa_{L}}^{j},y_{\kappa_{R}}^{j}\in\mathcal{G}$
\end_inset

 implies 
\begin_inset Formula $y_{\kappa}^{j+1}\in\mathcal{G}$
\end_inset

.
 Note that in principle, this holds for any positive values of 
\begin_inset Formula $\beta_{\kappa_{L}}$
\end_inset

 and 
\begin_inset Formula $\beta_{\kappa_{R}}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
High-order DG scheme in one dimension
\begin_inset CommandInset label
LatexCommand label
name "subsec:1D-PPDG-high-order"

\end_inset


\end_layout

\begin_layout Standard
Consider a quadrature rule with 
\begin_inset Formula $n_{q}$
\end_inset

 points and positive weights denoted with 
\begin_inset Formula $x_{q}$
\end_inset

 and 
\begin_inset Formula $w_{q}$
\end_inset

, respectively, such that 
\begin_inset Formula $x_{q}\in\kappa=\left[x_{L},x_{R}\right]$
\end_inset

 , 
\begin_inset Formula $\sum_{q=1}^{n_{q}}w_{q}=1$
\end_inset

, and 
\begin_inset Formula $n_{q}\geq n_{b}$
\end_inset

, The endpoints, 
\begin_inset Formula $x_{L}$
\end_inset

 and 
\begin_inset Formula $x_{R}$
\end_inset

, need not be included in the set of quadrature points, and none of the
 volumetric integrals in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 need to be evaluated with this quadrature rule.
 The standard flux interpolation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is assumed here; the modified flux interpolation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:modified-flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

 will be accounted for in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:modified-flux-interpolation-1d"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 As in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Lv15_2"
literal "false"

\end_inset

 the element-local solution average can be expanded as
\begin_inset Formula 
\begin{align}
\overline{y}_{\kappa} & =\sum_{q=1}^{n_{q}}w_{q}y_{\kappa}(x_{q})\nonumber \\
 & =\sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}(x_{q})+\theta_{L}y_{\kappa}(x_{L})+\theta_{R}y_{\kappa}(x_{R}),\label{eq:element-average-convex-combination}
\end{align}

\end_inset

where, if the set of quadrature points includes the endpoints, 
\begin_inset Formula 
\[
\theta_{q}=\begin{cases}
w_{q} & x_{q}\neq x_{L},x_{q}\neq x_{R}\\
0 & \mathrm{otherwise}
\end{cases}
\]

\end_inset

and 
\begin_inset Formula 
\[
\theta_{L}=w_{L},\quad\theta_{R}=w_{R},
\]

\end_inset

with 
\begin_inset Formula $w_{L}$
\end_inset

 and 
\begin_inset Formula $w_{R}$
\end_inset

 denoting the quadrature weights at the left and right endpoints, respectively.
 Otherwise, we take
\begin_inset Formula 
\[
\theta_{q}=w_{q}-\theta_{L}\psi_{q}\left(x_{L}\right)-\theta_{R}\psi_{q}\left(x_{R}\right),
\]

\end_inset

where 
\begin_inset Formula $\psi_{1},\ldots,\psi_{n_{d}}$
\end_inset

 form a set of Lagrange basis functions whose nodes are located at 
\begin_inset Formula $n_{d}$
\end_inset

 points of the set 
\begin_inset Formula $\left\{ x_{q},q=1,\ldots,n_{q}\right\} $
\end_inset

, with 
\begin_inset Formula $n_{b}\leq n_{d}\leq n_{q}$
\end_inset

, and 
\begin_inset Formula $\psi_{n_{d}+1},\ldots,\psi_{n_{q}}$
\end_inset

 are equal to zero.
 As a result, 
\begin_inset Formula $\sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}(x_{q})$
\end_inset

 can be written as
\begin_inset Formula 
\begin{align*}
\sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}(x_{q}) & =\sum_{q=1}^{n_{q}}\left[w_{q}-\theta_{L}\psi_{q}\left(x_{L}\right)-\theta_{R}\psi_{q}\left(x_{R}\right)\right]y_{\kappa}(x_{q})\\
 & =\sum_{q=1}^{n_{q}}w_{q}y_{\kappa}(x_{q})-\theta_{L}\sum_{q=1}^{n_{q}}y_{\kappa}(x_{q})\psi_{q}\left(x_{L}\right)-\theta_{R}\sum_{q=1}^{n_{q}}y_{\kappa}(x_{q})\psi_{q}\left(x_{R}\right)\\
 & =\sum_{q=1}^{n_{q}}w_{q}y_{\kappa}(x_{q})-\theta_{L}y_{\kappa}(x_{L})+\theta_{R}y_{\kappa}(x_{R}).
\end{align*}

\end_inset


\begin_inset Formula $\theta_{L}$
\end_inset

 and 
\begin_inset Formula $\theta_{R}$
\end_inset

 will be related to a time-step-size constraint below (see
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Lv15_2"
literal "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

 for additional details).
 Note that 
\begin_inset Formula $\sum_{q}\theta_{q}+\theta_{L}+\theta_{R}=1$
\end_inset

 since 
\begin_inset Formula $\sum_{q=1}^{n_{q}}\psi_{q}=1$
\end_inset

.
 Due to the positivity of the quadrature weights, there exist positive 
\begin_inset Formula $\theta_{L}$
\end_inset

 and 
\begin_inset Formula $\theta_{R}$
\end_inset

 that yield 
\begin_inset Formula $\theta_{q}\geq0,\;q=1,\ldots,n_{q}$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Lv15_2"
literal "false"

\end_inset

.
 Define 
\begin_inset Formula $\partial\mathcal{D}_{\kappa}=\left\{ x_{L,}x_{R}\right\} $
\end_inset

, and let 
\begin_inset Formula $\mathcal{D}_{\kappa}$
\end_inset

 denote the following set of points:
\begin_inset Formula 
\[
\mathcal{D_{\kappa}}=\partial\mathcal{D}_{\kappa}\bigcup\left\{ x_{q},q=1,\ldots,n_{q}\right\} =\left\{ x_{L,}x_{R},x_{q},q=1,\ldots,n_{q}\right\} .
\]

\end_inset


\end_layout

\begin_layout Standard
Employing the forward Euler time-integration scheme and taking 
\begin_inset Formula $\mathfrak{v}\in V_{h}^{0}$
\end_inset

 yields the fully discrete scheme satisfied by the element averages,
\begin_inset Formula 
\[
\overline{y}_{\kappa}^{j+1}=\frac{1}{2}\left(\overline{y}_{\kappa,c}^{j+1}+\overline{y}_{\kappa,v}^{j+1}\right),
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\overline{y}_{\kappa,c}^{j+1}= & \overline{y}_{\kappa}^{j}-\frac{\Delta t^{*}}{h}\left[\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j}(x_{L}),y_{\kappa_{L}}^{j}(x_{L}),-1\right)+\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j}(x_{R}),y_{\kappa_{R}}^{j}(x_{R}),1\right)\right]\\
= & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}(x_{q})+\theta_{L}y_{\kappa}^{j}(x_{L})-\frac{\Delta t^{*}}{h}\left[\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j}(x_{L}),y_{\kappa_{L}}^{j}(x_{L}),-1\right)+\mathcal{F}^{\dagger}\left(y_{\kappa}^{j}(x_{L}),y_{\kappa}^{j}(x_{R}),1\right)\right]\\
 & +\theta_{R}y_{\kappa}^{j}(x_{R})-\frac{\Delta t^{*}}{h}\left[\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j}(x_{R}),y_{\kappa}^{j}(x_{L}),-1\right)+\mathcal{F}^{\dagger}\left(y_{\kappa}^{j}(x_{R}),y_{\kappa_{R}}^{j}(x_{R}),1\right)\right],
\end{aligned}
\label{eq:fully-discrete-form-average-convective-1d}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\overline{y}_{\kappa,v}^{j+1}= & \overline{y}_{\kappa}^{j}+\frac{\Delta t^{*}}{h}\left[-\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa}^{j}(x_{L}),\nabla y_{\kappa}^{j}(x_{L})\right)-\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa_{L}}^{j}(x_{L}),\nabla y_{\kappa_{L}}^{j}(x_{L})\right)\right.\\
 & +\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa}^{j}(x_{R}),\nabla y_{\kappa}^{j}(x_{R})\right)+\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa_{R}}^{j}(x_{R}),\nabla y_{\kappa_{R}}^{j}(x_{R})\right)\\
 & \left.-\frac{\beta_{\kappa_{L}}}{2}y_{\kappa}^{j}(x_{L})+\frac{\beta_{\kappa_{L}}}{2}y_{\kappa_{L}}^{j}(x_{L})-\frac{\beta_{\kappa_{R}}}{2}y_{\kappa}^{j}(x_{R})+\frac{\beta_{\kappa_{R}}}{2}y_{\kappa_{R}}^{j}(x_{R})\right]\\
= & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}(x_{q})+\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}\left[y_{\kappa_{L}}^{j}(x_{L})-\beta_{\kappa_{L}}^{-1}\mathcal{F}^{v}\left(y_{\kappa_{L}}^{j}(x_{L}),\nabla y_{\kappa_{L}}^{j}(x_{L})\right)\right]\\
 & +\frac{\Delta t^{*}}{2h}\beta_{\kappa_{R}}\left[y_{\kappa_{R}}^{j}(x_{R})+\beta_{\kappa_{R}}^{-1}\mathcal{F}^{v}\left(y_{\kappa_{R}}^{j}(x_{R}),\nabla y_{\kappa_{R}}^{j}(x_{R})\right)\right]\\
 & +\left(\theta_{L}-\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}\right)\left[y_{\kappa}^{j}(x_{L})-\frac{\Delta t^{*}}{2h\left(\theta_{L}-\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}\right)}\mathcal{F}^{v}\left(y_{\kappa}^{j}(x_{L}),\nabla y_{\kappa}^{j}(x_{L})\right)\right]\\
 & +\left(\theta_{R}-\frac{\Delta t^{*}}{2h}\beta_{\kappa_{R}}\right)\left[y_{\kappa}^{j}(x_{R})+\frac{\Delta t^{*}}{2h\left(\theta_{R}-\frac{\Delta t^{*}}{2h}\beta_{\kappa_{R}}\right)}\mathcal{F}^{v}\left(y_{\kappa}^{j}(x_{R}),\nabla y_{\kappa}^{j}(x_{R})\right)\right].
\end{aligned}
\label{eq:fully-discrete-form-average-viscous-1d}
\end{equation}

\end_inset

The second equality in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-convective-1d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is due to the conservation property of the numerical flux:
\begin_inset Formula 
\[
\mathcal{F}^{\dagger}\left(y_{\kappa}^{j}(x_{L}),y_{\kappa}^{j}(x_{R}),1\right)=-\mathcal{F}^{\dagger}\left(y_{\kappa}^{j}(x_{R}),y_{\kappa}^{j}(x_{L}),-1\right).
\]

\end_inset

Note that Equations
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-convective-1d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-viscous-1d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 hold regardless of whether the integrals in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 are computed with conventional quadrature or a quadrature-free approach
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Atk96,Atk98"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
The limiting strategy, which is described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:limiting-procedure"
plural "false"
caps "false"
noprefix "false"

\end_inset

, requires that 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}$
\end_inset

 and 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}(x)$
\end_inset

 be in 
\begin_inset Formula $\mathcal{G}_{s_{b}}$
\end_inset

 and 
\begin_inset Formula $\mathcal{G}$
\end_inset

, respectively, where 
\begin_inset Formula $s_{b}$
\end_inset

 is a lower bound on the specific thermodynamic entropy.
 As discussed in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

, we employ a local entropy bound,
\begin_inset Formula 
\begin{equation}
s_{b,\kappa}^{j+1}(y)=\min\left\{ s\left(y^{j}(x)\right)\vert x\in\mathcal{D}_{\kappa}\cup\mathcal{D}_{\kappa_{L}}\cup\mathcal{D}_{\kappa_{R}}\right\} ,\label{eq:local-entropy-bound}
\end{equation}

\end_inset

which is motivated by the minimum entropy principle satisfied by entropy
 solutions to the multicomponent Euler equations
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Gou20"
literal "false"

\end_inset

.
 It can be shown that if 
\begin_inset Formula $y_{\kappa}^{j}(x)\in\mathcal{G}_{s_{b}},\;\forall x\in\mathcal{D}_{\kappa}$
\end_inset

 , and 
\begin_inset Formula $y_{\kappa}^{-,j}\in\mathcal{G}_{s_{b}},\;\forall x\in\partial\mathcal{D}_{\kappa}$
\end_inset

, where 
\begin_inset Formula $y_{\kappa}^{-}$
\end_inset

 denotes the exterior state along 
\begin_inset Formula $\partial\kappa$
\end_inset

, then 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}$
\end_inset

 is in 
\begin_inset Formula $\mathcal{G}_{s_{b}}$
\end_inset

 under the time-step-size constraint
\begin_inset Formula 
\begin{equation}
\frac{\Delta t^{*}\lambda}{h}\leq\frac{1}{2}\min\left\{ \theta_{L},\theta_{R}\right\} \label{eq:CFL-condition-convective-1d}
\end{equation}

\end_inset

and the conditions
\begin_inset Formula 
\begin{equation}
\theta_{L}>0,\theta_{R}>0,\theta_{q}\geq0,q=1,\ldots,n_{q}.\label{eq:theta-conditions-1d}
\end{equation}

\end_inset

More information can be found in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

.
 The conditions under which 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}\in\mathcal{G}$
\end_inset

 are analyzed in the following theorem.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Formula $\theta_{L}$
\end_inset

 and 
\begin_inset Formula $\theta_{R}$
\end_inset

 are already less than or equal to 1.
\end_layout

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:CFL-condition-1D-viscous"

\end_inset

If 
\begin_inset Formula $y_{\kappa}^{j}(x)\in\mathcal{G},\;\forall x\in\mathcal{D_{\kappa}}$
\end_inset

, and 
\begin_inset Formula $y_{\kappa}^{-,j}\in\mathcal{G},\;\forall x\in\partial\mathcal{D}_{\kappa}$
\end_inset

, then 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}$
\end_inset

 is also in 
\begin_inset Formula $\mathcal{G}$
\end_inset

 under the time-step-size constraint
\begin_inset Formula 
\begin{equation}
\frac{\Delta t^{*}}{h}\leq\min\left\{ \frac{\theta_{L}}{\beta_{\kappa_{L}}},\frac{\theta_{R}}{\beta_{\kappa_{R}}}\right\} ,\label{eq:CFL-condition-1D-viscous}
\end{equation}

\end_inset

the constraints on 
\begin_inset Formula $\beta$
\end_inset

,
\begin_inset Formula 
\begin{align}
\beta_{\kappa_{L}} & >\max\left\{ \beta^{*}\left(y_{\kappa}^{j}(x_{L}),\mathcal{F}^{v}\left(y_{\kappa}^{j}(x_{L}),\nabla y_{\kappa}^{j}(x_{L})\right),-1\right),\beta^{*}\left(y_{\kappa_{L}}^{j}(x_{L}),\mathcal{F}^{v}\left(y_{\kappa_{L}}^{j}(x_{L}),\nabla y_{\kappa_{L}}^{j}(x_{L})\right),-1\right)\right\} ,\label{eq:beta-constraint-1d-L}\\
\beta_{\kappa_{R}} & >\max\left\{ \beta^{*}\left(y_{\kappa}^{j}(x_{R}),\mathcal{F}^{v}\left(y_{\kappa}^{j}(x_{R}),\nabla y_{\kappa}^{j}(x_{R})\right),1\right),\beta^{*}\left(y_{\kappa_{R}}^{j}(x_{R}),\mathcal{F}^{v}\left(y_{\kappa_{R}}^{j}(x_{R}),\nabla y_{\kappa_{R}}^{j}(x_{R})\right),1\right)\right\} ,\label{eq:beta-constraint-1d-R}
\end{align}

\end_inset

and the conditions
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:theta-conditions-1d"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Proof
The inequality
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint-1d-L"
plural "false"
caps "false"
noprefix "false"

\end_inset

 guarantees that 
\begin_inset Formula $y_{\kappa_{L}}^{j}(x_{L})-\beta_{\kappa_{L}}^{-1}\mathcal{F}^{v}\left(y_{\kappa_{L}}^{j}(x_{L}),\nabla y_{\kappa_{L}}^{j}(x_{L})\right)\in\mathcal{G}$
\end_inset

.
 According to the time-step-size constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CFL-condition-1D-viscous"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we have
\begin_inset Formula 
\[
\frac{\Delta t^{*}}{h}\leq\frac{\theta_{L}}{\beta_{\kappa_{L}}},
\]

\end_inset

such that
\begin_inset Formula 
\[
\theta_{L}-\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}\geq\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}.
\]

\end_inset

It follows that
\begin_inset Formula 
\begin{align*}
\frac{\Delta t^{*}}{2h\left(\theta_{L}-\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}\right)} & \leq\frac{\Delta t^{*}}{2h\left(\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}\right)}\\
 & =\beta_{\kappa_{L}}^{-1},
\end{align*}

\end_inset

which means 
\begin_inset Formula $y_{\kappa}^{j}(x_{L})-\frac{\Delta t^{*}}{2h\left(\theta_{L}-\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}\right)}\mathcal{F}^{v}\left(y_{\kappa}^{j}(x_{L}),\nabla y_{\kappa}^{j}(x_{L})\right)\in\mathcal{G}$
\end_inset

.
 Moreover, we have 
\begin_inset Formula $\frac{\Delta t^{*}}{2h}\beta_{\kappa_{L}}\leq\theta_{L}\leq1$
\end_inset

.
 The same arguments can be applied to show 
\begin_inset Formula 
\begin{align*}
 & y_{\kappa_{R}}^{j}(x_{R})+\beta_{\kappa_{R}}^{-1}\mathcal{F}^{v}\left(y_{\kappa_{R}}^{j}(x_{R}),\nabla y_{\kappa_{R}}^{j}(x_{R})\right)\in\mathcal{G},\\
 & y_{\kappa}^{j}(x_{R})+\frac{\Delta t^{*}}{2h\left(\theta_{R}-\frac{\Delta t^{*}}{2h}\beta_{\kappa_{R}}\right)}\mathcal{F}^{v}\left(y_{\kappa}^{j}(x_{R}),\nabla y_{\kappa}^{j}(x_{R})\right)\in\mathcal{G},\\
 & \frac{\Delta t^{*}}{2h}\beta_{\kappa_{R}}\leq\theta_{R}\leq1.
\end{align*}

\end_inset

Therefore, 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}$
\end_inset

 is a convex combination of states in 
\begin_inset Formula $\mathcal{G}$
\end_inset

, such that 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}\in\mathcal{G}$
\end_inset

.
\end_layout

\begin_layout Remark
Though forward Euler time stepping is employed for demonstration purposes,
 any time integration scheme that can be expressed as a convex combination
 of forward Euler steps, such as strong-stability-preserving Runge-Kutta
 (SSPRK) methods, can be used.
\end_layout

\begin_layout Standard
As previously mentioned, the final ingredient of the positivity-preserving,
 entropy-bounded DG scheme is a limiting strategy (described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:limiting-procedure"
plural "false"
caps "false"
noprefix "false"

\end_inset

) to ensure 
\begin_inset Formula $y_{\kappa,c}^{j+1}(x)\in\mathcal{G}_{s_{b}}$
\end_inset

 and 
\begin_inset Formula $y_{\kappa,v}^{j+1}(x)\in\mathcal{G}$
\end_inset

, for all 
\begin_inset Formula $x\in\mathcal{D}_{\kappa}$
\end_inset

, where 
\begin_inset Formula $y_{c}^{j+1}$
\end_inset

 satisfies
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{gather*}
\sum_{\kappa\in\mathcal{T}}\left(\frac{y_{c}^{j+1}-y^{j}}{\Delta t^{*}},\mathfrak{v}\right)_{\kappa}-\sum_{\kappa\in\mathcal{T}}\left(\mathcal{F}^{c}\left(y^{j},\nabla y^{j}\right),\nabla\mathfrak{v}\right)_{\kappa}+\sum_{\epsilon\in\mathcal{E}}\left(\mathcal{F}^{c\dagger}\left(y^{j},n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon}=0\qquad\forall\mathfrak{v}\in V_{h}^{p},
\end{gather*}

\end_inset

and 
\begin_inset Formula $y_{v}^{j+1}$
\end_inset

 satisfies 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{gather*}
\sum_{\kappa\in\mathcal{T}}\left(\frac{y_{v}^{j+1}-y^{j}}{\Delta t^{*}},\mathfrak{v}\right)_{\kappa}-\sum_{\epsilon\in\mathcal{E}}\left(\average{\mathcal{F}^{v}\left(y^{j},\nabla y^{j}\right)}\cdot n-\delta^{v}\left(y^{j},\nabla y^{j},n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon}\\
+\sum_{\kappa\in\mathcal{T}}\left(G\left(y^{j,+}\right):\left(\average{y^{j}}-y^{j,+}\right)\otimes n,\nabla\mathfrak{v}\right)_{\partial\kappa}=0\qquad\forall\mathfrak{v}\in V_{h}^{p},
\end{gather*}

\end_inset

such that 
\begin_inset Formula $y^{j+1}=\frac{1}{2}\left(y_{c}^{j+1}+y_{v}^{j+1}\right)$
\end_inset

.
 
\begin_inset Formula $y_{\kappa}^{j+1}(x)$
\end_inset

 is then in 
\begin_inset Formula $\mathcal{G}$
\end_inset

, for all 
\begin_inset Formula $x\in\mathcal{D}_{\kappa}$
\end_inset

, since 
\begin_inset Formula $y_{\kappa}^{j+1}$
\end_inset

 is a convex combination of 
\begin_inset Formula $y_{\kappa,c}^{j+1}$
\end_inset

 and 
\begin_inset Formula $y_{\kappa,v}^{j+1}$
\end_inset

.
 Entropy boundedness is enforced on only the convective contribution since
 the viscous flux function is not fully compatible with an entropy constraint
 and the minimum entropy principle does not hold for the Navier-Stokes equations
 unless the thermal diffusivity is zero
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Tad86,Gue14"
literal "false"

\end_inset

.
 The limiting strategy here relies on a simple linear-scaling limiter that
 is conservative, maintains stability, and in general preserves order of
 accuracy for smooth solutions
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha10,Zha17,Zha12_2,Lv15_2,Jia18"
literal "false"

\end_inset

.
 However, it is not expected to suppress all small-scale instabilities,
 which is why artificial viscosity is employed in tandem.
\end_layout

\begin_layout Subsubsection
Modified flux interpolation
\begin_inset CommandInset label
LatexCommand label
name "subsec:modified-flux-interpolation-1d"

\end_inset


\end_layout

\begin_layout Standard
In this subsection, we discuss how to account for the modified flux interpolatio
n
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:modified-flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22_2"
literal "false"

\end_inset

, we already discussed the inviscid case; therefore, we only consider 
\begin_inset Formula $y_{\kappa,v}$
\end_inset

 here.
 The scheme satisfied by the element averages becomes
\begin_inset Formula 
\begin{equation}
\begin{aligned}\overline{y}_{\kappa,v}^{j+1}= & \overline{y}_{\kappa}^{j}+\frac{\Delta t^{*}}{h}\left[-\frac{1}{2}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa}^{j}(x_{L}),\nabla y_{\kappa}^{j}(x_{L})\right)-\frac{1}{2}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa_{L}}^{j}(x_{L}),\nabla y_{\kappa_{L}}^{j}(x_{L})\right)\right.\\
 & +\frac{1}{2}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa}^{j}(x_{R}),\nabla y_{\kappa}^{j}(x_{R})\right)+\frac{1}{2}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa_{R}}^{j}(x_{R}),\nabla y_{\kappa_{R}}^{j}(x_{R})\right)\\
 & \left.-\frac{\beta_{\kappa_{L}}}{2}\widetilde{y}_{\kappa}^{j}(x_{L})+\frac{\beta_{\kappa_{L}}}{2}\widetilde{y}_{\kappa_{L}}^{j}(x_{L})-\frac{\beta_{\kappa_{R}}}{2}\widetilde{y}_{\kappa}^{j}(x_{R})+\frac{\beta_{\kappa_{R}}}{2}\widetilde{y}_{\kappa_{R}}^{j}(x_{R})\right].
\end{aligned}
\label{eq:fully-discrete-form-average-viscous-1d-modified}
\end{equation}

\end_inset

If the nodal set includes the endpoints (e.g., equidistant or Gauss-Lobatto
 points), then 
\begin_inset Formula $y_{\kappa}^{j}(x_{L})=\widetilde{y}_{\kappa}^{j}(x_{L})$
\end_inset

 and 
\begin_inset Formula $y_{\kappa}^{j}(x_{R})=\widetilde{y}_{\kappa}^{j}(x_{R})$
\end_inset

, in which case both Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-viscous-1d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and Theorem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:CFL-condition-1D-viscous"
plural "false"
caps "false"
noprefix "false"

\end_inset

 hold and the modified flux interpolation does not require any additional
 modifications to the formulation.
\end_layout

\begin_layout Subsection
Limiting procedure
\begin_inset CommandInset label
LatexCommand label
name "subsec:limiting-procedure"

\end_inset


\end_layout

\begin_layout Standard
Here, we describe the positivity-preserving and entropy limiters to ensure
 
\begin_inset Formula $y_{\kappa,c}^{j+1}(x)\in\mathcal{G}_{s_{b}}$
\end_inset

 and 
\begin_inset Formula $y_{\kappa,v}^{j+1}(x)\in\mathcal{G}$
\end_inset

, respectively, for all 
\begin_inset Formula $x\in\mathcal{D}_{\kappa}$
\end_inset

.
 We assume that 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}(x)\in\mathcal{G}_{s_{b}}$
\end_inset

 and 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}(x)\in\mathcal{G}$
\end_inset

.
 The 
\begin_inset Formula $j+1$
\end_inset

 superscript and 
\begin_inset Formula $\kappa$
\end_inset

 subscript are dropped for brevity.
 The limiting procedure is identical across one, two, and three dimensions.
\end_layout

\begin_layout Subsubsection*
Positivity-preserving limiter
\end_layout

\begin_layout Standard
The positivity-preserving limiter enforces 
\begin_inset Formula $\rho>0$
\end_inset

, 
\begin_inset Formula $C_{i}\geq0,\;\forall i$
\end_inset

, and 
\begin_inset Formula $\rho u^{*}>0$
\end_inset

 via the following steps:
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $\rho(y\left(x\right))>\varepsilon,\:\forall x\in\mathcal{D}_{\kappa}$
\end_inset

, where 
\begin_inset Formula $\varepsilon$
\end_inset

 is a small positive number, such as 
\begin_inset Formula $10^{-10}$
\end_inset

, then set 
\begin_inset Formula $C_{i}^{(1)}=C_{i}=\sum_{j=1}^{n_{b}}C_{i}(x_{j})\phi_{j},i=1,\ldots,n_{s}$
\end_inset

; if not, set
\begin_inset Formula 
\[
C_{i}^{(1)}=\overline{C}_{i}+\omega^{(1)}\left(C_{i}-\overline{C}_{i}\right),\quad\omega^{(1)}=\frac{\rho(\overline{y})-\epsilon}{\rho(\overline{y})-\underset{x\in\mathcal{D}}{\min}\rho(y(x))}.
\]

\end_inset

for 
\begin_inset Formula $i=1,\ldots,n_{s}.$
\end_inset

 Let 
\begin_inset Formula $y^{(1)}=\left(\rho v_{1},\ldots,\rho v_{d},\rho e_{t},C_{1}^{(1)},\ldots,C_{n_{s}}^{(1)}\right)$
\end_inset

.
 This is referred to as the 
\begin_inset Quotes eld
\end_inset

density limiter
\begin_inset Quotes erd
\end_inset

 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Itemize
For 
\begin_inset Formula $i=1,\ldots,n_{s}$
\end_inset

, if 
\begin_inset Formula $C_{i}^{(1)}(x)\geq0,\:\forall x\in\mathcal{D}_{\kappa}$
\end_inset

, then set 
\begin_inset Formula $C_{i}^{(2)}=C_{i}^{(1)}$
\end_inset

; if not, set
\begin_inset Formula 
\[
C_{i}^{(2)}=\overline{C}_{i}+\omega^{(2)}\left(C_{i}^{(1)}-\overline{C}_{i}\right),\quad\omega^{(2)}=\frac{\overline{C}_{i}}{\overline{C}_{i}-\underset{x\in\mathcal{D}}{\min}C_{i}^{(1)}(x)}.
\]

\end_inset

Let 
\begin_inset Formula $y^{(2)}=\left(\rho v_{1},\ldots,\rho v_{d},\rho e_{t},C_{1}^{(2)},\ldots,C_{n_{s}}^{(2)}\right)$
\end_inset

.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $\rho u^{*}\left(y^{(2)}(x)\right)>\epsilon,\:\forall x\in\mathcal{D}_{\kappa}$
\end_inset

, then set 
\begin_inset Formula $y^{(3)}=y^{(2)}$
\end_inset

; if not, set
\begin_inset Formula 
\[
y^{(3)}=\overline{y}+\omega^{(3)}\left(y^{(2)}-\overline{y}\right),\quad\omega^{(3)}=\frac{\rho u^{*}(\overline{y})-\epsilon}{\rho u^{*}(\overline{y})-\underset{x\in\mathcal{D}}{\min}\rho u^{*}(y^{(2)}(x))}.
\]

\end_inset

Since 
\begin_inset Formula $\rho u^{*}(y)$
\end_inset

 is a concave function of 
\begin_inset Formula $y$
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

, 
\begin_inset Formula $\rho u^{*}(y^{(3)}(x))>0,\:\forall x\in\mathcal{D}_{\kappa}$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Wan12,Zha17"
literal "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
The positivity-preserving limiter is applied to both 
\begin_inset Formula $y_{c}$
\end_inset

 and 
\begin_inset Formula $y_{v}$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection*
Entropy limiter
\end_layout

\begin_layout Standard
The entropy limiter, which is applied only to 
\begin_inset Formula $y_{c}$
\end_inset

, enforces 
\begin_inset Formula $\chi\geq0$
\end_inset

 as follows: if 
\begin_inset Formula $\chi\left(y^{(3)}(x)\right)\geq0,\:\forall x\in\mathcal{D}_{\kappa}$
\end_inset

, then set 
\begin_inset Formula $y^{(4)}=y^{(3)}$
\end_inset

; if not, set
\begin_inset Formula 
\[
y^{(4)}=\overline{y}+\omega^{(4)}\left(y^{(3)}-\overline{y}\right),\quad\omega^{(4)}=\frac{\chi(\overline{y})}{\chi(\overline{y})-\underset{x\in\mathcal{D}}{\min}\chi(y^{(3)}(x))}.
\]

\end_inset

Since 
\begin_inset Formula $\chi(y)$
\end_inset

 is a concave function of 
\begin_inset Formula $y$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Jia18,Wu21_2"
literal "false"

\end_inset

, 
\begin_inset Formula $s\left(y^{(4)}(x)\right)\geq s_{b},\:\forall x\in\mathcal{D}_{\kappa}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The solution is then replaced as
\begin_inset Formula 
\[
y\leftarrow\frac{1}{2}\left(y_{c}^{(4)}+y_{v}^{(3)}\right).
\]

\end_inset

This limiting procedure is applied at the end of every RK stage.
 Note that if 
\begin_inset Formula $y$
\end_inset

 is split in a different manner as
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Dza22"
literal "false"

\end_inset


\begin_inset Formula 
\[
y\leftarrow y_{\ddagger}^{(3)},
\]

\end_inset

where 
\begin_inset Formula $y_{\ddagger}$
\end_inset

 satisfies
\begin_inset Formula 
\begin{gather*}
\sum_{\kappa\in\mathcal{T}}\left(\frac{y_{\ddagger}^{j+1}-y_{\mathsf{c}}^{(4),j+1}}{\Delta t},\mathfrak{v}\right)_{\kappa}-\sum_{\epsilon\in\mathcal{E}}\left(\average{\mathcal{F}^{v}\left(y^{j},\nabla y^{j}\right)}\cdot n-\delta^{v}\left(y^{j},\nabla y^{j},n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon}\\
+\sum_{\kappa\in\mathcal{T}}\left(G\left(y^{j,+}\right):\left(\average{y^{j}}-y^{j,+}\right)\otimes n,\nabla\mathfrak{v}\right)_{\partial\kappa}=0\qquad\forall\mathfrak{v}\in V_{h}^{p},
\end{gather*}

\end_inset

and 
\begin_inset Formula $y_{\mathsf{c}}$
\end_inset

 satisfies
\begin_inset Formula 
\begin{gather*}
\sum_{\kappa\in\mathcal{T}}\left(\frac{y_{\mathsf{c}}^{j+1}-y^{j}}{\Delta t},\mathfrak{v}\right)_{\kappa}-\sum_{\kappa\in\mathcal{T}}\left(\mathcal{F}^{c}\left(y^{j},\nabla y^{j}\right),\nabla\mathfrak{v}\right)_{\kappa}+\sum_{\epsilon\in\mathcal{E}}\left(\mathcal{F}^{c\dagger}\left(y^{j},n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon}=0\qquad\forall\mathfrak{v}\in V_{h}^{p},
\end{gather*}

\end_inset

then 
\begin_inset Formula $\overline{y}_{\kappa,\ddagger}^{j+1}$
\end_inset

 may not be in 
\begin_inset Formula $\mathcal{G}$
\end_inset

 in the case that 
\begin_inset Formula $y_{\kappa,\mathsf{c}}^{j+1}(x)\notin\mathcal{G}_{s_{b}},\forall x\in\mathcal{D}_{\kappa}$
\end_inset

 (i.e., 
\begin_inset Formula $y_{\kappa,\mathsf{c}}^{(4),j+1}\neq y_{\kappa,\mathsf{c}}^{j+1}$
\end_inset

).
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
This is because 
\begin_inset Formula $\beta$
\end_inset

 will have been calculated based on 
\begin_inset Formula $y$
\end_inset

 not 
\begin_inset Formula $y_{\mathsf{c}}^{(4)}$
\end_inset

.
 If 
\begin_inset Formula $y_{\kappa,\mathsf{c}}^{(4),j+1}\neq y_{\kappa,\mathsf{c}}^{j+1}$
\end_inset

, then this splitting becomes identical to non-split version.
 As an example, consider an element-local solution (for 
\begin_inset Formula $C_{i}$
\end_inset

) in one dimension that is a symmetric parabola that is concave up, such
 that the 
\begin_inset Formula $C_{i}>\overline{C}_{i}$
\end_inset

 at the endpoints.
 Suppose that 
\begin_inset Formula $\beta$
\end_inset

 is selected based on the concentration-based constraint at the endpoints
 (recall that interior points don't matter for the averages) - this constraint
 can effectively be anything - e.g., take endpoint concentrations to be extremely
 large and/or the gradients at the exterior states to be extremely large
 in magnitude.
 Also suppose that 
\begin_inset Formula $s(y_{\kappa,\mathsf{c}}^{j+1})<s_{b}$
\end_inset

 for some 
\begin_inset Formula $x\in\mathcal{D}_{\kappa}$
\end_inset

, such that the limiter is applied and the concentrations at the endpoints
 are reduced.
 The constraint on 
\begin_inset Formula $\beta$
\end_inset

 may no longer be satisfied and we may get 
\begin_inset Formula $\overline{C}_{i}<0$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Multidimensional case
\end_layout

\begin_layout Standard
In this section, the one-dimensional positivity-preserving, entropy-bounded
 DG method presented in the previous subsection is extended to two and three
 dimensions.
 Before doing so, we first review the geometric mapping, as well as volume
 and surface quadrature rules.
 For conciseness, any key ideas already presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:1D-PPDG"
plural "false"
caps "false"
noprefix "false"

\end_inset

 are only briefly mentioned here.
\end_layout

\begin_layout Subsubsection
Preliminaries
\begin_inset CommandInset label
LatexCommand label
name "subsec:preliminaries-EBDG-2D"

\end_inset


\end_layout

\begin_layout Paragraph
Geometric mapping
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
For simplicity, we assume that all elements and interfaces are of the same
 corresponding shape and order, though this assumption is not critical.
\end_layout

\end_inset

Let 
\begin_inset Formula $\xi=\left(\xi_{1},\ldots,\xi_{d}\right)$
\end_inset

 denote the reference coordinates and 
\begin_inset Formula $\widehat{\kappa}$
\end_inset

 denote the reference element.
 The mapping 
\begin_inset Formula $x(\xi):\widehat{\kappa}\rightarrow\kappa$
\end_inset

 is defined as
\begin_inset Formula 
\[
x(\xi)=\sum_{m=1}^{n_{g}}x_{\kappa,m}\Phi_{m}(\xi),
\]

\end_inset

where 
\begin_inset Formula $\left\{ x_{\kappa,1},\ldots,x_{\kappa,n_{g}}\right\} $
\end_inset

 is the set of geometric nodes of 
\begin_inset Formula $\kappa,$
\end_inset

 
\begin_inset Formula $\left\{ \Phi_{1},\ldots,\Phi_{n_{g}}\right\} $
\end_inset

 is the set of geometric basis functions, and 
\begin_inset Formula $n_{g}$
\end_inset

 is the number of basis functions.
 Let 
\begin_inset Formula $J_{\kappa}$
\end_inset

 denote the geometric Jacobian and 
\begin_inset Formula $\left|J_{\kappa}\right|$
\end_inset

 denote its determinant, which is allowed to vary with 
\begin_inset Formula $\xi$
\end_inset

.
 
\begin_inset Formula $y_{\kappa}$
\end_inset

 can be expressed as
\begin_inset Formula 
\[
y_{\kappa}=\sum_{j=1}^{n_{b}}y_{\kappa}(x_{j})\phi(\xi),\quad x=x(\xi)\in\kappa,\;\forall\xi\in\widehat{\kappa}.
\]

\end_inset

Let 
\begin_inset Formula $\kappa^{(f)}$
\end_inset

 be the 
\begin_inset Formula $f$
\end_inset

th neighbor of 
\begin_inset Formula $\kappa$
\end_inset

 and 
\begin_inset Formula $\partial\kappa^{(f)}$
\end_inset

 be the 
\begin_inset Formula $f$
\end_inset

th face of 
\begin_inset Formula $\kappa$
\end_inset

, such that 
\begin_inset Formula $\partial\kappa=\bigcup_{f=1}^{n_{f}}\partial\kappa^{(f)}$
\end_inset

, where 
\begin_inset Formula $n_{f}$
\end_inset

 is the number of faces.
 Note that 
\begin_inset Formula $n_{f}$
\end_inset

 can vary across elements, but we slightly abuse notation for brevity.
 
\begin_inset Formula $\widehat{\epsilon}$
\end_inset

 denotes the reference face.
 We define 
\begin_inset Formula $x\left(\zeta^{(f)}\right):\widehat{\epsilon}\rightarrow\partial\kappa^{(f)}$
\end_inset

, with 
\begin_inset Formula $\zeta^{(f)}=\left(\zeta_{1}^{(f)},\ldots,\zeta_{d-1}^{(f)}\right)$
\end_inset

 denoting the reference coordinates, as
\begin_inset Formula 
\[
x\left(\zeta^{(f)}\right)=\sum_{m=1}^{n_{g,f}^{\partial}}x_{\kappa,m}^{(f)}\Phi_{m}^{(f)}\left(\zeta^{(f)}\right),
\]

\end_inset

where 
\begin_inset Formula $\left\{ x_{\kappa,1}^{(f)},\ldots x_{\kappa,n_{g,f}^{\partial}}^{(f)}\right\} $
\end_inset

 is the set of geometric nodes of 
\begin_inset Formula $\partial\kappa^{(f)}$
\end_inset

, 
\begin_inset Formula $\left\{ \Phi_{1}^{(f)},\ldots,\Phi_{n_{g,f}^{\partial}}^{(f)}\right\} $
\end_inset

 is the set of basis functions, and 
\begin_inset Formula $n_{g,f}^{\partial}$
\end_inset

 is the number of basis functions.
 
\begin_inset Formula $\xi\left(\zeta^{(f)}\right):\widehat{\epsilon}\rightarrow\widehat{\kappa}$
\end_inset

 is the mapping from the reference face to the reference element.
 The surface Jacobian is denoted 
\begin_inset Formula $J_{\partial\kappa}^{(f)}$
\end_inset

, which can vary with 
\begin_inset Formula $\zeta^{(f)}$
\end_inset

.
 
\end_layout

\begin_layout Paragraph
Quadrature rules
\end_layout

\begin_layout Standard
Consider a volume quadrature rule with 
\begin_inset Formula $n_{q}$
\end_inset

 points and positive weights, denoted 
\begin_inset Formula $\xi_{q}$
\end_inset

 and 
\begin_inset Formula $w_{q}$
\end_inset

, 
\begin_inset Formula $q=1,\ldots,n_{q}$
\end_inset

, respectively, with 
\begin_inset Formula $n_{q}\geq n_{b}$
\end_inset

.
 The weights are appropriately scaled such that 
\begin_inset Formula $\sum_{q=1}^{n_{q}}w_{q}=\left|\widehat{\kappa}\right|$
\end_inset

, where 
\begin_inset Formula $\left|\widehat{\kappa}\right|$
\end_inset

 is the volume of 
\begin_inset Formula $\widehat{\kappa}$
\end_inset

.
 The quadrature rule can be used to evaluate the volume integral over 
\begin_inset Formula $\kappa$
\end_inset

 of a generic function, 
\begin_inset Formula $g(x)$
\end_inset

, as
\begin_inset Formula 
\[
\int_{\kappa}g(x)dx=\int_{\widehat{\kappa}}g(x(\xi))\left|J_{\kappa}(\xi)\right|d\xi\approx\sum_{q=1}^{n_{q}}g\left(x(\xi_{q})\right)\left|J_{\kappa}(\xi_{q})\right|w_{q},
\]

\end_inset

If 
\begin_inset Formula $g(x)$
\end_inset

 is a polynomial, then quadrature with sufficiently high 
\begin_inset Formula $n_{q}$
\end_inset

 gives the exact value.
 
\end_layout

\begin_layout Standard
Similarly, consider a surface quadrature rule with 
\begin_inset Formula $n_{q}^{\partial}$
\end_inset

 points and positive weights, denoted 
\begin_inset Formula $\zeta_{l}$
\end_inset

 and 
\begin_inset Formula $w_{l}^{\partial}$
\end_inset

,
\begin_inset Formula $l=1,\ldots,n_{q}^{\partial}$
\end_inset

.
 The weights are scaled such that 
\begin_inset Formula $\sum_{l=1}^{n_{q}^{\partial}}w_{l}^{\partial}=\left|\widehat{\epsilon}\right|$
\end_inset

, where 
\begin_inset Formula $\left|\widehat{\epsilon}\right|$
\end_inset

 is the surface area 
\begin_inset Formula $\widehat{\epsilon}$
\end_inset

.
 The surface quadrature rule can be used to evaluate the surface integral
 over 
\begin_inset Formula $\partial\kappa^{(f)}$
\end_inset

 of a generic function as
\begin_inset Formula 
\[
\int_{\partial\kappa^{(f)}}g(x)ds=\int_{\widehat{\epsilon}}g\left(x\left(\zeta^{(f)}\right)\right)\left|J_{\partial\kappa}^{(k)}\left(\zeta^{(f)}\right)\right|d\zeta\approx\sum_{l=1}^{n_{q}^{\partial}}g\left(x\left(\zeta_{l}^{(f)}\right)\right)\left|J_{\partial\kappa}^{(f)}\left(\zeta_{l}^{(f)}\right)\right|w_{f,l}^{\partial}=\sum_{l=1}^{n_{q}^{\partial}}g\left(x\left(\zeta_{l}^{(f)}\right)\right)\nu_{f,l}^{\partial},
\]

\end_inset

where 
\begin_inset Formula $\nu_{f,l}^{\partial}=\left|J_{\partial\kappa}^{(f)}\left(\zeta_{l}^{(f)}\right)\right|w_{f,l}^{\partial}$
\end_inset

.
 If 
\begin_inset Formula $g(x)$
\end_inset

 is a polynomial, then quadrature with sufficiently high 
\begin_inset Formula $n_{q}^{\partial}$
\end_inset

 yields the exact value.
 The closed surface integral over 
\begin_inset Formula $\partial\kappa$
\end_inset

 can be computed as
\begin_inset Formula 
\[
\int_{\partial\kappa}g(x)ds=\sum_{f=1}^{n_{f}}\int_{\partial\kappa^{(f)}}g(x)ds=\sum_{f=1}^{n_{f}}\int_{\widehat{\epsilon}}g\left(x\left(\zeta^{(f)}\right)\right)\left|J_{\partial\kappa}^{(f)}\left(\zeta^{(f)}\right)\right|d\zeta\approx\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}g\left(x\left(\zeta_{l}^{(f)}\right)\right)\nu_{f,l}^{\partial},
\]

\end_inset

where we allow a different quadrature rule to be used for each face.
\end_layout

\begin_layout Paragraph
Additional considerations
\end_layout

\begin_layout Standard
In the following, assume that the surface integrals in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 are computed using 
\begin_inset Formula $\left\{ \zeta_{1}^{(f)},\ldots,\zeta_{n_{q,f}^{\partial}}^{(f)}\right\} _{f=1}^{n_{f}}$
\end_inset

 as integration points.
 Define 
\begin_inset Formula $\partial\mathcal{D}_{\kappa}$
\end_inset

 and 
\begin_inset Formula $\mathcal{D}_{\kappa}$
\end_inset

 as
\begin_inset Formula 
\[
\partial\mathcal{D}_{\kappa}=\bigcup_{f=1}^{n_{f}}\left\{ x\left(\zeta_{l}^{(f)}\right),l=1,\ldots,n_{q,f}^{\partial}\right\} ,
\]

\end_inset

and
\begin_inset Formula 
\[
\mathcal{D_{\kappa}}=\partial\mathcal{D}_{\kappa}\bigcup\left\{ x(\xi_{q}),q=1,\ldots,n_{q}\right\} =\bigcup_{f=1}^{n_{f}}\left\{ x\left(\zeta_{l}^{(f)}\right),l=1,\ldots,n_{q,f}^{\partial}\right\} \bigcup\left\{ x(\xi_{q}),q=1,\ldots,n_{q}\right\} ,
\]

\end_inset

 respectively.
 The points in 
\begin_inset Formula $\left\{ x(\xi_{q}),q=1,\ldots,n_{q}\right\} $
\end_inset

 need not be used in the evaluation of any volume integrals in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Without loss of generality, we define 
\begin_inset Formula $\nu_{f,l}^{\partial}$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\nu_{f,l}^{\partial}=\begin{cases}
\left|J_{\partial\kappa}^{(f)}(\zeta_{l})\right|w_{f,l}^{\partial}, & l=1,\ldots,n_{q,f}^{\partial}\\
0, & l=n_{q,f}^{\partial}+1,\ldots,N
\end{cases},\label{eq:Jacobian_weights_piecewise}
\end{equation}

\end_inset

where the faces are ordered such that 
\begin_inset Formula $N=\max_{f}\left\{ n_{q,f}^{\partial}\right\} =n_{q,n_{f}}^{\partial}$
\end_inset

.
 As a result, we have
\begin_inset Formula 
\[
\sum_{f=1}^{n_{f}}\sum_{l=1}^{N}\nu_{f,l}^{\partial}=\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\nu_{f,l}^{\partial}=\sum_{f=1}^{n_{f}}\left|\partial\kappa^{(f)}\right|=\left|\partial\kappa\right|,
\]

\end_inset

where 
\begin_inset Formula $|\partial\kappa|$
\end_inset

 is the surface area of 
\begin_inset Formula $\kappa$
\end_inset

 and 
\begin_inset Formula $\left|\partial\kappa^{(f)}\right|$
\end_inset

 is the surface area of the 
\begin_inset Formula $f$
\end_inset

th face.
 
\end_layout

\begin_layout Standard
Note that although a quadrature-free implementation
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Atk96,Atk98"
literal "false"

\end_inset

 is used in this work to compute the integrals in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

, recall from Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:1D-PPDG-high-order"

\end_inset

 that the analysis is performed on the scheme satisfied by the element averages,
 which is identical between quadrature-based and quadrature-free approaches.
 Nevertheless, the scheme satisfied by the element averages is presented
 in terms of a quadrature-based approach for consistency with previous studies.
\end_layout

\begin_layout Subsubsection
First-order DG scheme in multiple dimensions
\begin_inset CommandInset label
LatexCommand label
name "subsec:2D-PPDG-first-order"

\end_inset


\end_layout

\begin_layout Standard
Consider the following 
\begin_inset Formula $p=0$
\end_inset

, element-local DG discretization with forward Euler time stepping:
\begin_inset Formula 
\begin{equation}
\begin{split}y_{\kappa}^{j+1}= & y_{\kappa}^{j+1}-\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t\nu_{f,l}^{\partial}}{|\kappa|}\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j},y_{\kappa^{(f)}}^{j},n\left(\zeta_{l}^{(f)}\right)\right)\\
 & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t\nu_{f,l}^{\partial}}{|\kappa|}\left[\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa}^{j},\nabla y_{\kappa}^{j}\right)\cdot n\left(\zeta_{l}^{(f)}\right)+\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa^{(f)}}^{j},\nabla y_{\kappa^{(f)}}^{j}\right)\cdot n\left(\zeta_{l}^{(f)}\right)\right.\\
 & \left.-\delta^{v}\left(y_{\kappa}^{j},y_{\kappa^{(f)}}^{j},\nabla y_{\kappa}^{j},\nabla y_{\kappa^{(f)}}^{j},n\left(\zeta_{l}^{(f)}\right)\right)\right],
\end{split}
\label{eq:p0-PPDG-2D}
\end{equation}

\end_inset

which can be rearranged to split the convective and diffusive contributions
 as
\begin_inset Formula 
\begin{align}
y_{\kappa}^{j+1}= & \frac{1}{2}\left(y_{\kappa,c}^{j+1}+y_{\kappa,v}^{j+1}\right),\\
y_{\kappa,c}^{j+1}= & y_{\kappa}^{j}-\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\mathcal{F}^{c\dagger}\left(y_{\kappa}^{j},y_{\kappa^{(f)}}^{j},n\left(\zeta_{l}^{(f)}\right)\right),\\
y_{\kappa,v}^{j+1}= & y_{\kappa}^{j}+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\left[\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa}^{j},\nabla y_{\kappa}^{j}\right)\cdot n\left(\zeta_{l}^{(f)}\right)+\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa^{(f)}}^{j},\nabla y_{\kappa^{(f)}}^{j}\right)\cdot n\left(\zeta_{l}^{(f)}\right)\right.\nonumber \\
 & \left.-\delta^{v}\left(y_{\kappa}^{j},y_{\kappa^{(f)}}^{j},\nabla y_{\kappa}^{j},\nabla y_{\kappa^{(f)}}^{j},n\left(\zeta_{l}^{(f)}\right)\right)\right],\label{eq:p0-2D-viscous-contribution}
\end{align}

\end_inset

where 
\begin_inset Formula $\left|\kappa\right|$
\end_inset

 is the volume of the element.
 Since 
\begin_inset Formula $\mathcal{F}^{v}\left(y_{\kappa},\nabla y_{\kappa}\right)=0$
\end_inset

, Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:p0-2D-viscous-contribution"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reduces to
\begin_inset Formula 
\begin{align}
y_{\kappa,v}^{j+1}= & y_{\kappa}^{j}-\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\delta^{v}\left(y_{\kappa}^{j},y_{\kappa^{(f)}}^{j},\nabla y_{\kappa}^{j},\nabla y_{\kappa^{(f)}}^{j},n\left(\zeta_{l}^{(f)}\right)\right)\nonumber \\
 & =y_{\kappa}^{j}-\sum_{f=1}^{n_{f}}\frac{\Delta t^{*}\left|\partial\kappa^{(f)}\right|}{|\kappa|}\frac{\beta_{f}}{2}\left[y_{\kappa}^{j}-y_{\kappa^{(f)}}^{j}\right]\nonumber \\
 & =\left[1-\sum_{f=1}^{n_{f}}\frac{\Delta t^{*}\left|\partial\kappa^{(f)}\right|}{2\left|\kappa\right|}\beta_{f}\right]y_{\kappa}^{j}+\sum_{f=1}^{n_{f}}\frac{\Delta t^{*}\left|\partial\kappa^{(f)}\right|}{2|\kappa|}\beta_{f}y_{\kappa^{(f)}}^{j}\label{eq:p0-2D-viscous-contribution-convex-combination}
\end{align}

\end_inset

Under the time-step-size constraint 
\begin_inset Formula 
\[
\sum_{f=1}^{n_{f}}\frac{\Delta t^{*}\left|\partial\kappa^{(f)}\right|}{2\left|\kappa\right|}\beta_{f}\leq1,
\]

\end_inset

the RHS of Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:p0-2D-viscous-contribution-convex-combination"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is a convex combination of 
\begin_inset Formula $y_{\kappa}^{j}$
\end_inset

 and 
\begin_inset Formula $y_{\kappa^{(f)}}^{j},f=1,\ldots,n_{f}$
\end_inset

.
 As such, 
\begin_inset Formula $y_{\kappa}^{j}\in\mathcal{G}$
\end_inset

 and 
\begin_inset Formula $y_{\kappa^{(f)}}^{j}\in\mathcal{G},f=1,\ldots,n_{f}$
\end_inset

 imply 
\begin_inset Formula $y_{\kappa,v}^{j+1}\in\mathcal{G}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
High-order DG scheme in multiple dimensions
\begin_inset CommandInset label
LatexCommand label
name "subsec:2D-PPDG-high-order"

\end_inset


\end_layout

\begin_layout Standard
As in the one-dimensional case, the element-local solution average can be
 expanded as
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Lv15_2"
literal "false"

\end_inset


\begin_inset Formula 
\begin{align}
\overline{y}_{\kappa} & =\sum_{q=1}^{n_{q}}\frac{\left|J_{\kappa}(\xi_{q})\right|w_{q}}{|\kappa|}y_{\kappa}\left(\xi_{q}\right),\nonumber \\
 & =\sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}\left(\xi_{q}\right)+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\theta_{f,l}y_{\kappa}\left(\xi\left(\zeta_{l}^{(f)}\right)\right).\label{eq:element-average-convex-combination-2D}
\end{align}

\end_inset

where, if 
\begin_inset Formula $\partial\mathcal{D}_{\kappa}\subseteq\left\{ x(\xi_{q}),q=1,\ldots,n_{q}\right\} $
\end_inset

, 
\begin_inset Formula 
\[
\theta_{q}=\begin{cases}
\frac{\left|J_{\kappa}(\xi_{q})\right|w_{q}}{|\kappa|} & x\left(\xi_{q}\right)\notin\partial\mathcal{D}_{\kappa}\\
0 & x\left(\xi_{q}\right)\in\partial\mathcal{D}_{\kappa}
\end{cases}
\]

\end_inset

and
\begin_inset Formula 
\[
\theta_{f,l}=\frac{\left|J_{\kappa}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right|w_{f,l}}{|\kappa|N_{f,l}},
\]

\end_inset

with 
\begin_inset Formula $w_{f,l}$
\end_inset

 denoting the volume quadrature weight corresponding to the quadrature point
 that satisfies 
\begin_inset Formula $\xi_{q}=\xi\left(\zeta_{l}^{(f)}\right)$
\end_inset

 and 
\begin_inset Formula $N_{f,l}$
\end_inset

 denoting the number of faces belonging to 
\begin_inset Formula $\kappa$
\end_inset

 shared by the given point.
 Otherwise, we take
\begin_inset Formula 
\[
\theta_{q}=\frac{\left|J_{\kappa}(\xi_{q})\right|w_{q}}{|\kappa|}-\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\theta_{f,l}\psi_{q}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),
\]

\end_inset

where 
\begin_inset Formula $\psi_{1},\ldots,\psi_{n_{d}}$
\end_inset

 form a set of Lagrange basis functions whose nodes are located at 
\begin_inset Formula $n_{d}$
\end_inset

 points of the set 
\begin_inset Formula $\left\{ x_{q},q=1,\ldots,n_{q}\right\} $
\end_inset

, with 
\begin_inset Formula $n_{b}\leq n_{d}\leq n_{q}$
\end_inset

, and 
\begin_inset Formula $\psi_{n_{d}+1},\ldots,\psi_{n_{q}}$
\end_inset

 are equal to zero.
 As a result, 
\begin_inset Formula $\sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}\left(\xi_{q}\right)$
\end_inset

 can be written as
\begin_inset Formula 
\begin{align*}
\sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}\left(\xi_{q}\right) & =\sum_{q=1}^{n_{q}}\left[\frac{\left|J_{\kappa}(\xi_{q})\right|w_{q}}{|\kappa|}-\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\theta_{f,l}\psi_{q}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right]y_{\kappa}\left(\xi_{q}\right)\\
 & =\sum_{q=1}^{n_{q}}\frac{\left|J_{\kappa}(\xi_{q})\right|w_{q}}{|\kappa|}y_{\kappa}\left(\xi_{q}\right)-\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\theta_{f,l}\sum_{q=1}^{n_{q}}y_{\kappa}\left(\xi_{q}\right)\psi_{q}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\\
 & =\sum_{q=1}^{n_{q}}\frac{\left|J_{\kappa}(\xi_{q})\right|w_{q}}{|\kappa|}y_{\kappa}\left(\xi_{q}\right)-\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\theta_{f,l}y_{\kappa}\left(\xi\left(\zeta_{l}^{(f)}\right)\right).
\end{align*}

\end_inset


\begin_inset Formula $\theta_{f,l}$
\end_inset

 will be related to a constraint on the time step size (see
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Lv15_2"
literal "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22_2"
literal "false"

\end_inset

 for additional details).
 Since 
\begin_inset Formula $w_{q}>0,q=1,\ldots n_{q}$
\end_inset

, there exist positive values of 
\begin_inset Formula $\theta_{f,l}$
\end_inset

 that yield 
\begin_inset Formula $\theta_{q}\geq0$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Lv15_2"
literal "false"

\end_inset

.
 Furthermore, we have 
\begin_inset Formula $\sum_{q=1}^{n_{q}}\theta_{q}+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\theta_{f,l}=1.$
\end_inset


\end_layout

\begin_layout Standard
Employing the forward Euler time-integration scheme and taking 
\begin_inset Formula $\mathfrak{v}\in V_{h}^{0}$
\end_inset

 yields the fully discrete scheme satisfied by the element averages,
\begin_inset Formula 
\[
\overline{y}_{\kappa}^{j+1}=\frac{1}{2}\left(\overline{y}_{\kappa,c}^{j+1}+\overline{y}_{\kappa,v}^{j+1}\right),
\]

\end_inset

where
\begin_inset Formula 
\begin{align}
\overline{y}_{\kappa,c}^{j+1} & =\overline{y}_{\kappa}^{j}-\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\mathcal{F}^{\dagger}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),n\left(\zeta_{l}^{(f)}\right)\right)\nonumber \\
 & =\sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}\left(\xi_{q}\right)+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\left[\theta_{f,l}y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\mathcal{F}^{\dagger}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),n\left(\zeta_{l}^{(f)}\right)\right)\right]\label{eq:fully-discrete-form-average-convective-2d}
\end{align}

\end_inset

and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\overline{y}_{\kappa,v}^{j+1} & = & \overline{y}_{\kappa}^{j}+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\left[\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{(f)}\right)\right.\nonumber \\
 &  & +\frac{1}{2}\mathcal{F}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{(f)}\right)\nonumber \\
 &  & \left.-\delta^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),n\left(\zeta_{l}^{(f)}\right)\right)\right]\nonumber \\
 & = & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}\left(\xi_{q}\right)+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\left[\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right.\nonumber \\
 &  & +\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)+\theta_{f,l}y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\nonumber \\
 &  & \left.-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\right]\nonumber \\
 & = & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}\left(\xi_{q}\right)\nonumber \\
 &  & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\left[y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\beta_{f,l}^{-1}\mathcal{F}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\right]\nonumber \\
 &  & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\Lambda_{f,l}\Biggl[y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1}\mathcal{F}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\Biggr],\label{eq:fully-discrete-form-average-viscous-2d}
\end{eqnarray}

\end_inset

with 
\begin_inset Formula $\Lambda_{f,l}=\theta_{f,l}-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}$
\end_inset

.
 Standard flux interpolation, as in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

, is assumed here; the modified flux interpolation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:modified-flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

 will be accounted for in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:modified-flux-interpolation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Note that Equations
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-convective-2d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-viscous-2d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 still hold for the quadrature-free implementation
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Atk96,Atk98"
literal "false"

\end_inset

 used to evaluate the integrals in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 since the integrals of the basis functions over the reference element (required
 in the quadrature-free implementation) can be considered the weights of
 a generalized Newton-Cotes quadrature rule
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Win08"
literal "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
It can be shown that if 
\begin_inset Formula $y_{\kappa}^{j}(x)\in\mathcal{G}_{s_{b}},\;\forall x\in\mathcal{D}_{\kappa}$
\end_inset

 , and 
\begin_inset Formula $y_{\kappa}^{-,j}\in\mathcal{G}_{s_{b}},\;\forall x\in\partial\mathcal{D}_{\kappa}$
\end_inset

, then 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}$
\end_inset

 is in 
\begin_inset Formula $\mathcal{G}_{s_{b}}$
\end_inset

 under the time-step-size constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22_2"
literal "false"

\end_inset


\begin_inset Formula 
\begin{align}
\frac{\Delta t^{*}\lambda}{|\kappa|} & \leq\frac{1}{2}\min\left\{ L_{A},L_{B},L_{C}\right\} ,\label{eq:CFL-condition-convective-2D}\\
L_{A} & =\min\left\{ \left.\frac{\theta_{f,l}}{\nu_{f,l}^{\partial}}\right|f=1,\ldots,n_{f}-1,\;l=1,\ldots,n_{q,f}^{\partial}\right\} ,\nonumber \\
L_{B} & =\min\left\{ \left.\frac{\theta_{n_{f},l}}{\nu_{f,l}^{\partial}}\frac{\left|\partial\kappa^{(f)}\right|}{|\partial\kappa|}\right|,f=1,\ldots,n_{f},\;l=1,\ldots,\min\left\{ n_{q,f}^{\partial},N-1\right\} \right\} ,\nonumber \\
L_{C} & =\frac{\theta_{n_{f},N}}{|\partial\kappa|},\nonumber 
\end{align}

\end_inset

and the conditions
\begin_inset Formula 
\begin{equation}
\begin{cases}
\theta_{q}\geq0, & q=1,\ldots,n_{q}\\
\theta_{f,l}>0, & f=1,\ldots,n_{f},\;l=1,\ldots,n_{q,f}^{\partial}.
\end{cases}\label{eq:theta-conditions-2D}
\end{equation}

\end_inset

The entropy bound, 
\begin_inset Formula $s_{b}$
\end_inset

, is computed as
\begin_inset Formula 
\begin{equation}
s_{b,\kappa}^{j+1}(y)=\min\left\{ s\left(y^{j}(x)\right)\left|x\in\bigcup_{f=1}^{n_{f}}\mathcal{D}_{\kappa^{(f)}}\bigcup\mathcal{D}_{\kappa}\right.\right\} .\label{eq:local-entropy-bound-2D}
\end{equation}

\end_inset

In the following theorem, we analyze the conditions under which 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}\in\mathcal{G}$
\end_inset

.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:CFL-condition-2D-viscous"

\end_inset

If 
\begin_inset Formula $y_{\kappa}^{j}(x)\in\mathcal{G},\;\forall x\in\mathcal{D_{\kappa}}$
\end_inset

, and 
\begin_inset Formula $y_{\kappa}^{-,j}\in\mathcal{G},\;\forall x\in\partial\mathcal{D}_{\kappa}$
\end_inset

, then 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}$
\end_inset

 is also in 
\begin_inset Formula $\mathcal{G}$
\end_inset

 under the time-step-size constraint
\begin_inset Formula 
\begin{align}
\frac{\Delta t^{*}}{\left|\kappa\right|} & \leq\min\left\{ \left.\frac{\theta_{f,l}}{\beta_{f,l}\nu_{f,l}^{\partial}}\right|f=1,\ldots,n_{f},\;l=1,\ldots,n_{q,f}^{\partial}\right\} ,\label{eq:CFL-condition-viscous-2D}
\end{align}

\end_inset

the constraints on 
\begin_inset Formula $\beta$
\end_inset

,
\begin_inset Formula 
\begin{align}
\beta_{f,l} & >\max\left\{ \beta_{f,l}^{(1)},\beta_{f,l}^{(2)}\right\} ,\label{eq:beta-constraint-2d}\\
\beta_{f,l}^{(1)} & =\beta^{*}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\mathcal{F}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right),n\left(\zeta_{l}^{\left(f\right)}\right)\right),\nonumber \\
\beta_{f,l}^{(2)} & =\beta^{*}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\mathcal{F}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right),n\left(\zeta_{l}^{\left(f\right)}\right)\right),\nonumber 
\end{align}

\end_inset

and the conditions
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:theta-conditions-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Proof
The proof follows similar logic to that for Theorem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:CFL-condition-1D-viscous"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The inequality
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint-2d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 guarantees that 
\begin_inset Formula 
\[
y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\beta_{f,l}^{-1}\mathcal{F}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\in\mathcal{G}.
\]

\end_inset

According to the time-step-size constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CFL-condition-viscous-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we have
\begin_inset Formula 
\[
\frac{\Delta t^{*}}{\left|\kappa\right|}\leq\frac{\theta_{f,l}}{\beta_{f,l}\nu_{f,l}^{\partial}}
\]

\end_inset

such that
\begin_inset Formula 
\[
\theta_{f,l}-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2\left|\kappa\right|}\beta_{f,l}\geq\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2\left|\kappa\right|}\beta_{f,l},
\]

\end_inset

for 
\begin_inset Formula $f=1,\ldots,n_{f},\;l=1,\ldots,n_{q,f}^{\partial}$
\end_inset

.
 It follows that
\begin_inset Formula 
\begin{align*}
\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1} & =\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|\left(\theta_{f,l}-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\right)}\\
 & \leq\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|\left(\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2\left|\kappa\right|}\beta_{f,l}\right)}\\
 & =\beta_{f,l}^{-1},
\end{align*}

\end_inset

which means
\begin_inset Formula 
\[
y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1}\mathcal{F}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\in\mathcal{G}.
\]

\end_inset

Moreover, we have 
\begin_inset Formula $\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\leq\theta_{f,l}\leq1$
\end_inset

.
 Therefore, 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}$
\end_inset

 is a convex combination of states in 
\begin_inset Formula $\mathcal{G}$
\end_inset

, such that 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}\in\mathcal{G}$
\end_inset

.
\begin_inset Note Note
status open

\begin_layout Plain Layout
More detailed proof (NOTE: this time-step-size constraint is out of date):
\begin_inset Formula 
\[
\frac{\Delta t^{*}}{2\left|\kappa\right|}\beta_{\mathrm{max}}-\frac{\theta_{f,l}}{\nu_{f,l}^{\partial}}\leq\frac{1}{2}\min\left\{ \left.\frac{\min\left\{ 1,\theta_{f,l}\right\} }{\nu_{f,l}^{\partial}}\right|f=1,\ldots,n_{f},\;l=1,\ldots,n_{q,f}^{\partial}\right\} -\frac{\theta_{f,l}}{\nu_{f,l}^{\partial}}\leq-\frac{\theta_{f,l}}{2\nu_{f,l}^{\partial}},
\]

\end_inset

such that
\begin_inset Formula 
\[
\frac{\theta_{f,l}}{\nu_{f,l}^{\partial}}-\frac{\Delta t^{*}}{2\left|\kappa\right|}\beta_{\mathrm{max}}\geq\frac{\theta_{f,l}}{2\nu_{f,l}^{\partial}}
\]

\end_inset

and 
\begin_inset Formula 
\[
\theta_{f,l}-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2\left|\kappa\right|}\beta_{f,l}\geq\theta_{f,l}-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2\left|\kappa\right|}\beta_{\mathrm{max}}\geq\frac{\theta_{f,l}}{2}.
\]

\end_inset

It follows that
\begin_inset Formula 
\begin{align*}
\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|\left(\theta_{f,l}-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\right)} & \leq\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|\frac{\theta_{f,l}}{2}}=\frac{\Delta t^{*}}{|\kappa|\frac{\theta_{f,l}}{\nu_{f,l}^{\partial}}}\\
 & \leq\frac{\Delta t^{*}}{|\kappa|\min\left\{ \left.\frac{\min\left\{ 1,\theta_{f,l}\right\} }{\nu_{f,l}^{\partial}}\right|f=1,\ldots,n_{f},\;l=1,\ldots,n_{q,f}^{\partial}\right\} }\\
 & \leq\frac{1}{\beta_{\mathrm{max}}}\\
 & \leq\beta_{f,l}^{-1},
\end{align*}

\end_inset

which means that 
\begin_inset Formula $y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1}\mathcal{F}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\in\mathcal{G}$
\end_inset

.
 Moreover, we have
\begin_inset Formula 
\begin{align*}
\frac{\theta_{f,l}}{\nu_{f,l}^{\partial}} & \geq\min\left\{ \left.\frac{\min\left\{ 1,\theta_{f,l}\right\} }{\nu_{f,l}^{\partial}}\right|f=1,\ldots,n_{f},\;l=1,\ldots,n_{q,f}^{\partial}\right\} \\
 & \geq\frac{\Delta t^{*}}{\left|\kappa\right|}\beta_{\mathrm{max}}\\
 & \geq\frac{\Delta t^{*}}{\left|\kappa\right|}\beta_{f,l}\\
 & \geq\frac{\Delta t^{*}}{2\left|\kappa\right|}\beta_{f,l},
\end{align*}

\end_inset

such that 
\begin_inset Formula $\theta_{f,l}-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\geq0$
\end_inset

.
 Additionally,
\begin_inset Formula 
\[
\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\leq\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\beta_{f,l}\leq\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{\left|\kappa\right|}\beta_{\mathrm{max}}\leq\nu_{f,l}^{\partial}\min\left\{ \left.\frac{\min\left\{ 1,\theta_{f,l}\right\} }{\nu_{f,l}^{\partial}}\right|f=1,\ldots,n_{f},\;l=1,\ldots,n_{q,f}^{\partial}\right\} \leq1,
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Remark
The same limiting strategy as in the one-dimensional case is employed to
 ensure 
\begin_inset Formula $y_{\kappa,c}^{j+1}(x)\in\mathcal{G}_{s_{b}}$
\end_inset

 and 
\begin_inset Formula $y_{\kappa,v}^{j+1}(x)\in\mathcal{G}$
\end_inset

, for all 
\begin_inset Formula $x\in\mathcal{D}_{\kappa}$
\end_inset

, such that 
\begin_inset Formula $y_{\kappa}^{j+1}(x)\in\mathcal{G},\;\forall x\in\mathcal{D_{\kappa}}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
The multidimensional formulation is compatible with curved elements of arbitrary
 shape, provided that appropriate quadrature rules exist.
 Note that the consideration of non-constant geometric Jacobians is significantl
y more straightforward for the Lax-Friedrichs-type viscous flux function
 than for invariant-region-preserving inviscid flux functions since the
 former 
\emph on
algebraically 
\emph default
satisfies the positivity property while the latter relies on the notion
 of a Riemann problem.
 It is worth mentioning, however, that the Lax-Friedrichs inviscid flux
 function also satisfies the positivity property algebraically
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha10,Zha17"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Modified flux interpolation
\begin_inset CommandInset label
LatexCommand label
name "subsec:modified-flux-interpolation"

\end_inset


\end_layout

\begin_layout Standard
With the modified flux interpolation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:modified-flux-projection"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the scheme satisfied by the element averages (for the viscous contribution)
 becomes
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\overline{y}_{\kappa,v}^{j+1} & = & \overline{y}_{\kappa}^{j}+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\left[\frac{1}{2}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{(f)}\right)\right.\nonumber \\
 &  & +\frac{1}{2}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{(f)}\right)\nonumber \\
 &  & \left.-\delta^{v}\left(\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),n\left(\zeta_{l}^{(f)}\right)\right)\right]\nonumber \\
 & = & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}\left(\xi_{q}\right)+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\left[\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right.\nonumber \\
 &  & +\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)+\theta_{f,l}y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\nonumber \\
 &  & \left.-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\right]\nonumber \\
 & = & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}\left(\xi_{q}\right)\nonumber \\
 &  & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\left[\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\beta_{f,l}^{-1}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\right]\nonumber \\
 &  & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\Lambda_{f,l}\Biggl[\acute{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\Lambda_{f,l}^{-1}\Delta\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\Biggr],\label{eq:fully-discrete-form-average-viscous-2d-modified}
\end{eqnarray}

\end_inset

where
\begin_inset Formula 
\[
\acute{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)=y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)
\]

\end_inset

and
\begin_inset Formula 
\[
\Delta\widetilde{y}_{\kappa}^{j}=\widetilde{y}_{\kappa}^{j}-y_{\kappa}^{j}.
\]

\end_inset

Under the time-step-size constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CFL-condition-viscous-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and the conditions
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:theta-conditions-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we have
\begin_inset Formula 
\begin{align*}
\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\beta_{f,l}^{-1}\mathcal{F}\left(\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right) & \in\mathcal{G},\\
\acute{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right) & \in\mathcal{G},
\end{align*}

\end_inset

provided that the constraints on 
\begin_inset Formula $\beta$
\end_inset

 are modified as
\begin_inset Formula 
\begin{align}
\beta_{f,l} & >\max\left\{ \beta_{f,l}^{(1)},\beta_{f,l}^{(2)}\right\} ,\label{eq:beta-constraint-2d-modified}\\
\beta_{f,l}^{(1)} & =\beta^{*}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\mathcal{F}^{v}\left(\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right),n\left(\zeta_{l}^{\left(f\right)}\right)\right),\nonumber \\
\beta_{f,l}^{(2)} & =\beta^{*}\left(\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\mathcal{F}^{v}\left(\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right),n\left(\zeta_{l}^{\left(f\right)}\right)\right).\nonumber 
\end{align}

\end_inset

By Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:alpha-constraints"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:supporting-lemma"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $\acute{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\Lambda_{f,l}^{-1}\Delta\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\in\mathcal{G}$
\end_inset

 if
\begin_inset Formula 
\[
\frac{\Delta t^{*}}{2\left|\kappa\right|}\beta_{f,l}<\frac{\theta_{f,l}}{\nu_{f,l}^{\partial}\left(1+\alpha^{*}\left(\acute{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\Delta\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\right)},
\]

\end_inset

where 
\begin_inset Formula $\alpha^{*}$
\end_inset

 is defined as in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:alpha-constraint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Therefore, 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}$
\end_inset

 remains a convex combination of states in 
\begin_inset Formula $\mathcal{G}$
\end_inset

 if, in addition to the time-step-size constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CFL-condition-viscous-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the following additional condition is satisfied:
\begin_inset Formula 
\[
\frac{\Delta t^{*}}{2\left|\kappa\right|}<\min_{f,l}\left\{ \frac{\theta_{f,l}}{\beta_{f,l}\nu_{f,l}^{\partial}\left(1+\alpha^{*}\left(\acute{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\Delta\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\right)}\right\} 
\]

\end_inset

 We then have 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}\in\mathcal{G}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Modified flux interpolation does not modify the concentrations, so no additional
 considerations for zero species concentrations other than the discussion
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{eqnarray}
\overline{y}_{\kappa,v}^{j+1} & = & \overline{y}_{\kappa}^{j}+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\left[\frac{1}{2}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{(f)}\right)\right.\nonumber \\
 &  & +\frac{1}{2}\mathcal{F}^{v}\left(\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{(f)}\right)\nonumber \\
 &  & \left.-\delta^{v}\left(\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),n\left(\zeta_{l}^{(f)}\right)\right)\right]\nonumber \\
 & = & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}\left(\xi_{q}\right)+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\left[\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right.\nonumber \\
 &  & +\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}\left(\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)+\theta_{f,l}y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\nonumber \\
 &  & \left.-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}\left(\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\right]\nonumber \\
 & = & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}\left(\xi_{q}\right)\nonumber \\
 &  & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\left[\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\beta_{f,l}^{-1}\mathcal{F}\left(\widetilde{y}_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\right]\nonumber \\
 &  & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\Lambda_{f,l}\Biggl[\acute{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)-\theta_{f,l}\Lambda_{f,l}^{-1}\Delta y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\Biggr],\label{eq:fully-discrete-form-average-viscous-2d-modified-1}
\end{eqnarray}

\end_inset

where
\begin_inset Formula 
\[
\acute{y}_{\kappa}^{j}=\widetilde{y}_{\kappa}^{j}+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1}\mathcal{F}\left(\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla\widetilde{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)
\]

\end_inset

and
\begin_inset Formula 
\[
\Delta y_{\kappa}^{j}=\widetilde{y}_{\kappa}^{j}-y_{\kappa}^{j}.
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Boundary conditions
\end_layout

\begin_layout Standard
Thus far, 
\begin_inset Formula $\partial\kappa$
\end_inset

 has been assumed to be in 
\begin_inset Formula $\mathcal{E_{I}}$
\end_inset

, the set of interior interfaces.
 Here, we discuss how to enforce boundary conditions, focusing on the viscous
 contribution in the multidimensional case.
 For simplicity, but without loss of generality, we assume 
\begin_inset Formula $\partial\kappa\in\mathcal{\mathcal{E}}_{\partial}$
\end_inset

 (i.e., all faces of 
\begin_inset Formula $\kappa$
\end_inset

 are boundary faces).
 We also assume 
\begin_inset Formula $y_{\partial}^{j}\in\mathcal{G},\;\forall x\in\partial\mathcal{D}_{\kappa}$
\end_inset

.
 The boundary penalty term takes the form
\begin_inset Formula 
\[
\delta_{\partial}^{v}\left(y^{+},y_{\partial},\nabla y^{+},n^{+}\right)=\frac{\beta}{2}\left(y^{+}-y_{\partial}\right).
\]

\end_inset

 The scheme satisfied by the element averages (for the viscous contribution)
 becomes
\begin_inset Formula 
\begin{eqnarray}
\overline{y}_{\kappa,v}^{j+1} & = & \overline{y}_{\kappa}^{j}+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{|\kappa|}\left[\frac{1}{2}\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{(f)}\right)\right.\nonumber \\
 &  & +\frac{1}{2}\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{(f)}\right)\nonumber \\
 &  & \left.-\delta_{\partial}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),n\left(\zeta_{l}^{(f)}\right)\right)\right]\nonumber \\
 & = & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}\left(\xi_{q}\right)+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\left[\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right.\nonumber \\
 &  & +\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{(f)}\right)+\theta_{f,l}y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\nonumber \\
 &  & \left.-\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\right]\nonumber \\
 & = & \sum_{q=1}^{n_{q}}\theta_{q}y_{\kappa}^{j}\left(\xi_{q}\right)\nonumber \\
 &  & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\left[y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)+\beta_{f,l}^{-1}\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\right]\nonumber \\
 &  & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\Lambda_{f,l}\Biggl[y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1}\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\Biggr].\label{eq:fully-discrete-form-average-viscous-2d-boundary}
\end{eqnarray}

\end_inset

Under the time-step-size constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CFL-condition-viscous-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and the conditions
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:theta-conditions-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we have
\begin_inset Formula 
\begin{align*}
y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)+\beta_{f,l}^{-1}\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right) & \in\mathcal{G},\\
y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1}\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right) & \in\mathcal{G},
\end{align*}

\end_inset

provided that the constraints on 
\begin_inset Formula $\beta$
\end_inset

 are modified as
\begin_inset Formula 
\begin{align}
\beta_{f,l} & >\max\left\{ \beta_{f,l}^{(1)},\beta_{f,l}^{(2)}\right\} ,\label{eq:beta-constraint-2d-modified-1}\\
\beta_{f,l}^{(1)} & =\beta^{*}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right),n\left(\zeta_{l}^{\left(f\right)}\right)\right),\nonumber \\
\beta_{f,l}^{(2)} & =\beta^{*}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\mathcal{F}_{\partial}^{v}\left(y_{\partial}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{(f)}\right)\right)\right),n\left(\zeta_{l}^{\left(f\right)}\right)\right).\nonumber 
\end{align}

\end_inset


\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}$
\end_inset

 is then in 
\begin_inset Formula $\mathcal{G}$
\end_inset

, and the same limiting strategy can be applied to ensure 
\begin_inset Formula $y_{\kappa,v}^{j+1}\in\mathcal{G},\;\forall x\in\mathcal{D_{\kappa}}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
No additional considerations for zero species concentrations other than
 the discussion in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Adaptive time stepping
\begin_inset CommandInset label
LatexCommand label
name "subsec:Adaptive-time-stepping"

\end_inset


\end_layout

\begin_layout Standard
As discussed by Zhang
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

, the time-step-size constraints
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CFL-condition-convective-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CFL-condition-viscous-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

 are sufficient but not necessary for 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}$
\end_inset

 and 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}$
\end_inset

 to be in 
\begin_inset Formula $\mathcal{G}_{s_{b}}$
\end_inset

 and 
\begin_inset Formula $\mathcal{G}$
\end_inset

, respectively.
 Furthermore, the latter constraint can sometimes be very restrictive.
 In addition, as will be demonstrated in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:detonation-results"
plural "false"
caps "false"
noprefix "false"

\end_inset

, provided that the positivity property remains satisfied, the BR2 viscous
 flux function is often preferred to the Lax-Friedrichs-type viscous flux
 function.
 As such, unless otherwise specified, we employ the following adaptive time
 stepping procedure similar to that in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

, except with additional steps to switch between the two viscous flux functions:
\end_layout

\begin_layout Enumerate
Select 
\begin_inset Formula $\Delta t$
\end_inset

 according to a user-prescribed CFL based on the acoustic time scale.
 
\end_layout

\begin_layout Enumerate
Compute 
\begin_inset Formula $y_{c}^{j+1}$
\end_inset

 and 
\begin_inset Formula $y_{v}^{j+1}$
\end_inset

 with the BR2 scheme.
 
\end_layout

\begin_layout Enumerate
If 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}\in\mathcal{G}_{s_{b}}$
\end_inset

 and 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}\in\mathcal{G},\:\forall\kappa$
\end_inset

, then employ the limiting procedure, proceed to the next time step, and
 go back to Step 1.
 If, for some 
\begin_inset Formula $\kappa$
\end_inset

, 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}\notin\mathcal{G}_{s_{b}}$
\end_inset

 or 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}\notin\mathcal{G}$
\end_inset

, then proceed to Step 4.
\end_layout

\begin_layout Enumerate
Halve the time step, and recompute 
\begin_inset Formula $y_{c}^{j+1}$
\end_inset

 and 
\begin_inset Formula $y_{v}^{j+1}$
\end_inset

 with the BR2 scheme.
 
\end_layout

\begin_layout Enumerate
If 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}\in\mathcal{G}_{s_{b}}$
\end_inset

 and 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}\in\mathcal{G},\:\forall\kappa$
\end_inset

, then employ the limiting procedure, proceed to the next time step, and
 go back to Step 1.
 If, for some 
\begin_inset Formula $\kappa$
\end_inset

, 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}\notin\mathcal{G}_{s_{b}}$
\end_inset

 or 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}\notin\mathcal{G}$
\end_inset

, then proceed to Step 6.
\end_layout

\begin_layout Enumerate
Recompute 
\begin_inset Formula $y_{c}^{j+1}$
\end_inset

 and 
\begin_inset Formula $y_{v}^{j+1}$
\end_inset

 with the Lax-Friedrichs-type viscous flux function.
 Go back to Step 3.
\end_layout

\begin_layout Standard
The above assumes forward Euler time integration.
 With SSPRK time integration, the solution is restarted from time step 
\begin_inset Formula $j$
\end_inset

 (with the time step halved or the viscous flux function switched) if an
 inadmissible state is encountered at any stage.
 In our experience, the initial time step size is generally sufficiently
 small for 
\begin_inset Formula $\overline{y}_{\kappa,c}^{j+1}$
\end_inset

 and 
\begin_inset Formula $\overline{y}_{\kappa,v}^{j+1}$
\end_inset

 to be in 
\begin_inset Formula $\mathcal{G}_{s_{b}}$
\end_inset

 and 
\begin_inset Formula $\mathcal{G}$
\end_inset

, respectively.
 Here, when the viscous flux function is switched to the Lax-Friedrichs-type
 function, it is employed at all interfaces.
 An alternative approach is to instead use it only at the interfaces belonging
 to cells with inadmissible states.
 
\end_layout

\begin_layout Standard
In the present study, in typically no more than ten percent of time steps
 is it necessary to decrease 
\begin_inset Formula $\Delta t$
\end_inset

 and/or switch the viscous flux function.
 Note that the BR2 scheme can sometimes result in satisfaction of the positivity
 property with a larger time step size than the Lax-Friedrichs-type viscous
 flux function.
 However, the advantage of the latter is that Theorem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:CFL-condition-2D-viscous"
plural "false"
caps "false"
noprefix "false"

\end_inset

 guarantees a finite time step size.
 In Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:shock-tube"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:detonation-results"
plural "false"
caps "false"
noprefix "false"

\end_inset

, in order to compare the BR2 and Lax-Friedrichs-type viscous flux functions,
 we employ the adaptive time stepping procedure but fix the viscous flux
 function to be the latter in certain simulations.
\end_layout

\begin_layout Subsection
Zero species concentrations
\begin_inset space ~
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:zero-species-concentrations"

\end_inset


\end_layout

\begin_layout Standard
All species concentrations have hitherto been assumed to be strictly positive.
 Following Remark
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we relax this assumption and discuss issues that may occur in the case
 of zero species concentrations.
 Note that the presence of zero or near-zero species concentrations is very
 common (and expected) in simulations of chemically reacting flows.
 We then propose a strategy to address such issues.
 To this end, we first rewrite Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-viscous-2d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in terms of the 
\begin_inset Formula $i$
\end_inset

th species-concentration component as
\begin_inset Formula 
\begin{equation}
\begin{aligned}\overline{C}_{i,\kappa,v}^{j+1}= & \sum_{q=1}^{n_{q}}\theta_{q}C_{i,\kappa}^{j}\left(\xi_{q}\right)\\
 & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\grave{C}_{i,\kappa^{\left(f\right)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\\
 & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\Lambda_{f,l}\grave{C}_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),
\end{aligned}
\label{eq:fully-discrete-form-average-viscous-2d-species}
\end{equation}

\end_inset

where
\begin_inset Formula 
\[
\grave{C}_{i,\kappa^{\left(f\right)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)=C_{i,\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\beta_{f,l}^{-1}\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)
\]

\end_inset

and
\begin_inset Formula 
\[
\grave{C}_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)=C_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1}\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right),
\]

\end_inset

with 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}$
\end_inset

, the molar flux of the 
\begin_inset Formula $i$
\end_inset

th species, given by Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:molar_flux_definition"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Note that 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}$
\end_inset

 depends on the concentration gradients, but not on the momentum gradient
 or the total-energy gradient.
 As before, 
\begin_inset Formula $y_{\kappa}^{j}$
\end_inset

 is assumed to be in 
\begin_inset Formula $\mathcal{G},\;\forall x\in\mathcal{D_{\kappa}},$
\end_inset

 for all 
\begin_inset Formula $\kappa$
\end_inset

.
 We make the following observations.
\begin_inset Note Note
status open

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:Cbar-is-zero-then-gradient"

\end_inset

If 
\begin_inset Formula $\overline{C}_{i,\kappa}^{j}=0$
\end_inset

, then 
\begin_inset Formula $C_{i,\kappa}^{j}=0,\forall x\in\mathcal{D}_{\kappa}$
\end_inset

, due to the positivity of the quadrature weights.
 Furthermore, 
\begin_inset Formula $\nabla C_{i,\kappa}^{j}=0,\forall x\in\kappa$
\end_inset

.
 One way to show this is to take 
\begin_inset Formula $C_{i,\kappa}^{j}=\sum_{j=1}^{n_{b}}C_{i,\kappa}^{j}(x_{j})\phi_{j}=\sum_{q=1}^{n_{b}}C_{i,\kappa}^{j}(x_{q})\psi_{q}$
\end_inset

.
 Since 
\begin_inset Formula $C_{i,\kappa}^{j}(x_{q})=0,q=1,\ldots,n_{b}$
\end_inset

, we have 
\begin_inset Formula $\nabla C_{i,\kappa}^{j}=0$
\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:Cbar-is-zero-then-flux"

\end_inset

By Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:molar_flux_definition"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and Remark
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Cbar-is-zero-then-gradient"
plural "false"
caps "false"
noprefix "false"

\end_inset

, if 
\begin_inset Formula $\overline{C}_{i,\kappa}^{j}=0$
\end_inset

, then 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)=0$
\end_inset

 and 
\begin_inset Formula $\grave{C}_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)=0$
\end_inset

, for all 
\begin_inset Formula $l,f$
\end_inset

.
 Furthermore, if 
\begin_inset Formula $\nabla C_{i,\kappa}^{j}=0,\;\forall x\in\partial\mathcal{D}_{\kappa}$
\end_inset

, for all 
\begin_inset Formula $i$
\end_inset

, then 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)=0$
\end_inset

.
 Similar statements can be made for 
\begin_inset Formula $C_{i,\kappa^{(f)}}^{j}$
\end_inset

.
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
Conversely, if 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\neq0$
\end_inset

, for any 
\begin_inset Formula $l,f$
\end_inset

, then either 
\begin_inset Formula $\nabla C_{i,\kappa}^{j}=0,\;\forall i$
\end_inset

 or 
\begin_inset Formula $\overline{C}_{i,\kappa}^{j}=0$
\end_inset

 .
 NOT TRUE
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
, and if 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)<0$
\end_inset

, then 
\begin_inset Formula $\overline{C}_{i,\kappa}^{j}>0$
\end_inset

, for some 
\begin_inset Formula $i$
\end_inset

.
 Similar statements can be made for 
\begin_inset Formula $C_{i,\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)$
\end_inset

 and 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
By Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-viscous-2d-species"
plural "false"
caps "false"
noprefix "false"

\end_inset

, if 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}<0$
\end_inset

, at least one of 
\begin_inset Formula $\grave{C}_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)$
\end_inset

 or 
\begin_inset Formula $\grave{C}_{i,\kappa^{\left(f\right)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)$
\end_inset

, for some 
\begin_inset Formula $l,f$
\end_inset

, is negative.
 Furthermore, if 
\begin_inset Formula $\grave{C}_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)<0$
\end_inset

, then 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)<0$
\end_inset

.
 Similarly, if 
\begin_inset Formula $\grave{C}_{i,\kappa^{\left(f\right)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)<0$
\end_inset

, then 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)<0$
\end_inset

.
\end_layout

\end_inset


\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:zero-concentration-issues"

\end_inset

Following Remarks
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:beta-not-abstract-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the concentration-based constraint on 
\begin_inset Formula $\beta$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint-concentration"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be undefined for 
\begin_inset Formula $C_{i}=0$
\end_inset

.
 Even if a small positive number is added to the denominator of the term
 on the RHS, 
\begin_inset Formula $\beta$
\end_inset

 can still be exceedingly large, which may then necessitate extremely small
 
\begin_inset Formula $\Delta t^{*}$
\end_inset

 and/or introduce noticeable error in the solution.
 Furthermore, as an example scenario in which 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}<0$
\end_inset

 regardless of 
\begin_inset Formula $\beta$
\end_inset

, take 
\begin_inset Formula $\overline{C}_{i,\kappa}^{j}=0$
\end_inset

, 
\begin_inset Formula $C_{i,\kappa^{(f)}}^{j}=0,\:\forall x\in\partial\mathcal{D}_{\kappa}$
\end_inset

, and 
\begin_inset Formula $\mathfrak{F}<0$
\end_inset

, where
\begin_inset Formula 
\[
\mathfrak{F}=\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\left[\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)+\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\right]\cdot n\left(\zeta_{l}^{\left(f\right)}\right).
\]

\end_inset

A representative schematic is given in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:zero-species-concentration-issue"

\end_inset

.
 In this figure, defining 
\begin_inset Formula $\kappa=\left[x_{L},x_{R}\right]$
\end_inset

, we have 
\begin_inset Formula 
\[
\mathfrak{F}=\left.\bar{D}_{i}\frac{\partial C_{i,\kappa^{(2)}}}{\partial x_{k}}\right|_{y_{\kappa^{(2)}}\left(x_{R}\right)},
\]

\end_inset

which is negative.
 Note that there exists a small region in 
\begin_inset Formula $\kappa^{(2)}$
\end_inset

 with negative species concentration, which is possible since the positivity-pre
serving limiter only guarantees 
\begin_inset Formula $C_{i}\geq0$
\end_inset

 at a finite set of points.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Other situations (that do not occur in the monocomponent case) may also
 arise in which 
\begin_inset Formula $C_{i}$
\end_inset

 and 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}$
\end_inset

 result in an exceedingly large value of 
\begin_inset Formula $\beta$
\end_inset

, which may then necessitate extremely small 
\begin_inset Formula $\Delta t^{*}$
\end_inset

 and/or introduce noticeable error in the solution.
\end_layout

\end_inset


\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/viscous/zero_species_concentrations_issue.pdf
	lyxscale 40
	width 60col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:zero-species-concentration-issue"

\end_inset

Schematic of an example scenario in which 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}<0$
\end_inset

 regardless of 
\begin_inset Formula $\beta$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:Cgrave-p0"

\end_inset

In the density limiter (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:limiting-procedure"
plural "false"
caps "false"
noprefix "false"

\end_inset

), if 
\begin_inset Formula $\omega^{(1)}=1$
\end_inset

, the limiter has no effect.
 If 
\begin_inset Formula $\omega^{(1)}=0$
\end_inset

, which corresponds to maximum limiter strength, then 
\begin_inset Formula $C_{i}\leftarrow C_{i}^{(1)}=\overline{C}_{i},\;\forall i$
\end_inset

, i.e., the species concentrations are projected to a 
\begin_inset Formula $p=0$
\end_inset

 representation.
 Suppose that 
\begin_inset Formula $\grave{C}_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)<0$
\end_inset

, in which case 
\begin_inset Formula $\overline{C}_{i,\kappa}^{j}>0$
\end_inset

 by Remark
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Cbar-is-zero-then-flux"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Applying the density limiter with 
\begin_inset Formula $\omega^{(1)}=0$
\end_inset

 then yields 
\begin_inset Formula $\grave{C}_{i,\kappa}^{j,(1)}\left(x\right)=\overline{C}_{i,\kappa}^{j}>0,\:\forall x\in\partial\mathcal{D}_{\kappa}$
\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Therefore, there exists 
\begin_inset Formula $\omega^{(1)}\in(0,1)$
\end_inset

 such that 
\begin_inset Formula $\grave{C}_{i,\kappa}^{j,(1)}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)=0$
\end_inset

, which is less intrusive than a 
\begin_inset Formula $p=0$
\end_inset

 projection.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:Cbar-p0"

\end_inset

Suppose that 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}<0$
\end_inset

.
 Applying the density limiter to 
\begin_inset Formula $y_{\kappa}^{j}$
\end_inset

 with 
\begin_inset Formula $\omega_{\kappa}^{(1)}=0$
\end_inset

 (which corresponds to a 
\begin_inset Formula $p=0$
\end_inset

 projection) and 
\begin_inset Formula $y_{\kappa^{(f)}}^{j}$
\end_inset

 with 
\begin_inset Formula $\omega_{\kappa^{(f)}}^{(1)}=0,f=1,\ldots,n_{f}$
\end_inset

 yields
\begin_inset Formula 
\[
\begin{aligned}\overline{C}_{i,\kappa,v}^{j+1,(1)}= & \sum_{q=1}^{n_{q}}\theta_{q}\overline{C}_{i,\kappa}^{j}\left(\xi_{q}\right)\\
 & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}\overline{C}_{i,\kappa^{\left(f\right)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\\
 & +\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}\Lambda_{f,l}\overline{C}_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),
\end{aligned}
\]

\end_inset

which is positive.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Therefore, there exists 
\begin_inset Formula $\omega_{\kappa}^{(1)},\omega_{\kappa^{(f)}}^{(1)}\in(0,1]$
\end_inset

 such that 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1,(1)}=0$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:omega-g"

\end_inset


\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}$
\end_inset

 is directly proportional to 
\begin_inset Formula $\nabla C$
\end_inset

, i.e.,
\begin_inset Formula 
\begin{align*}
\mathcal{F}_{C_{i},k}^{v}\left(y,\omega\nabla C\right) & =\bar{D}_{i}\omega\frac{\partial C_{i}}{\partial x_{k}}-\frac{C_{i}\bar{D}_{i}}{\rho}\omega\frac{\partial\rho}{\partial x_{k}}-\frac{C_{i}}{\rho}\sum_{l=1}^{n_{s}}W_{l}\left(\bar{D}_{l}\omega\frac{\partial C_{l}}{\partial x_{k}}-\frac{C_{l}\bar{D}_{l}}{\rho}\omega\frac{\partial\rho}{\partial x_{k}}\right)\\
 & =\omega\left[\bar{D}_{i}\frac{\partial C_{i}}{\partial x_{k}}-\frac{C_{i}\bar{D}_{i}}{\rho}\frac{\partial\rho}{\partial x_{k}}-\frac{C_{i}}{\rho}\sum_{l=1}^{n_{s}}W_{l}\left(\bar{D}_{l}\frac{\partial C_{l}}{\partial x_{k}}-\frac{C_{l}\bar{D}_{l}}{\rho}\frac{\partial\rho}{\partial x_{k}}\right)\right]\\
 & =\omega\mathcal{F}_{C_{i},k}^{v}\left(y,\nabla C\right),
\end{align*}

\end_inset

where 
\begin_inset Formula $\omega$
\end_inset

 is a scaling factor for 
\begin_inset Formula $\nabla C$
\end_inset

.
\end_layout

\begin_layout Standard
By Remark
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Cbar-p0"
plural "false"
caps "false"
noprefix "false"

\end_inset

, a foolproof but low-fidelity approach to address the issues described
 in Remark
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:zero-concentration-issues"

\end_inset

 is as follows: if 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}<0$
\end_inset

, then apply the density limiter with 
\begin_inset Formula $\omega^{(1)}=0$
\end_inset

 and recalculate 
\begin_inset Formula $y_{\kappa,v}^{j+1}$
\end_inset

, as well as the neighboring states.
 However, a higher-fidelity approach is desired.
 Following Remark
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:omega-g"
plural "false"
caps "false"
noprefix "false"

\end_inset

, one such approach is to modify the gradient in the fourth term in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\left(\average{\mathcal{F}^{v}\left(y,\nabla y\right)}\cdot n-\delta^{v}\left(y,\nabla y,n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon}\leftarrow\left(\average{\mathcal{F}^{v}\left(y,\omega\nabla y\right)}\cdot n-\delta^{v}\left(y,\nabla y,n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon},\label{eq:flux-limit-gradient}
\end{equation}

\end_inset

where 
\begin_inset Formula $\omega\in\left[0,1\right]$
\end_inset

 is a pointwise parameter that scales the gradient.
 Specifically, for a given 
\begin_inset Formula $\xi\left(\zeta_{l}^{\left(f\right)}\right)$
\end_inset

, we have 
\begin_inset Formula $\omega_{\kappa,l}^{(f)}$
\end_inset

 and 
\begin_inset Formula $\omega_{\kappa^{(f)},l}^{(f)}$
\end_inset

 for the interior and exterior gradients, respectively, which yields
\begin_inset Formula 
\begin{equation}
\grave{C}_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)=C_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\Lambda_{f,l}^{-1}\omega_{\kappa,l}^{(f)}\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)\label{eq:Cgrave-limited-gradient-kappa}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\grave{C}_{i,\kappa^{\left(f\right)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)=C_{i,\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)+\beta_{f,l}^{-1}\omega_{\kappa^{(f)},l}^{(f)}\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right).\label{eq:Cgrave-limited-gradient-kappa-f}
\end{equation}

\end_inset

This is akin to applying the linear-scaling limiter in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:limiting-procedure"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to only the gradient.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
We propose limiting the gradient only when 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}<0$
\end_inset

 and excessive loops are taken in the adaptive time stepping procedure described
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Adaptive-time-stepping"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset

 In order to guarantee 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}\geq0$
\end_inset

, 
\begin_inset Formula $\omega_{\kappa,l}^{(f)}$
\end_inset

 and 
\begin_inset Formula $\omega_{\kappa^{(f)},l}^{(f)}$
\end_inset

 in Equations
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Cgrave-limited-gradient-kappa"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Cgrave-limited-gradient-kappa-f"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be prescribed as
\begin_inset Formula 
\begin{equation}
\omega_{\kappa,l}^{(f)}=\min_{i}\omega_{i,\kappa,l}^{(f)},\quad\omega_{i,\kappa,l}^{(f)}=\begin{cases}
1, & Q_{i,\kappa,l}^{(f)}\geq0,\\
-\frac{\frac{1}{2\sum_{f}n_{q,f}^{\partial}}\sum_{q=1}^{n_{q}}\theta_{q}C_{i,\kappa}^{j}\left(\xi_{q}\right)+\Lambda_{f,l}C_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)}{\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)}, & \mathrm{otherwise},
\end{cases}\label{eq:omega-f-kappa}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\omega_{\kappa^{(f)},l}^{(f)}=\min_{i}\omega_{i,\kappa^{(f)},l}^{(f)},\quad\omega_{i,\kappa^{(f)},l}^{(f)}=\begin{cases}
1, & Q_{i,\kappa^{(f)},l}^{(f)}\geq0,\\
-\frac{\frac{1}{2\sum_{f}n_{q,f}^{\partial}}\sum_{q=1}^{n_{q}}\theta_{q}C_{i,\kappa}^{j}\left(\xi_{q}\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}C_{i,\kappa^{\left(f\right)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)}{\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)}, & \mathrm{otherwise},
\end{cases}\label{eq:omega-f-kappa-f}
\end{equation}

\end_inset

respectively, where 
\begin_inset Formula $Q_{i,\kappa,l}^{(f)}$
\end_inset

 and 
\begin_inset Formula $Q_{i,\kappa^{(f)},l}^{(f)}$
\end_inset

 are defined as
\begin_inset Formula 
\begin{align*}
Q_{i,\kappa,l}^{(f)}= & \frac{1}{2\sum_{f}n_{q,f}^{\partial}}\sum_{q=1}^{n_{q}}\theta_{q}C_{i,\kappa}^{j}\left(\xi_{q}\right)+\Lambda_{f,l}C_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\\
 & +\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right),\\
Q_{i,\kappa^{(f)},l}^{(f)}= & \frac{1}{2\sum_{f}n_{q,f}^{\partial}}\sum_{q=1}^{n_{q}}\theta_{q}C_{i,\kappa}^{j}\left(\xi_{q}\right)+\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\beta_{f,l}C_{i,\kappa^{\left(f\right)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\\
 & +\frac{\Delta t^{*}\nu_{f,l}^{\partial}}{2|\kappa|}\mathcal{F}_{C_{i}}^{v}\left(y_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla C_{\kappa^{(f)}}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right),
\end{align*}

\end_inset

such that 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}$
\end_inset

 in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-viscous-2d-species"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be rewritten as
\begin_inset Formula 
\[
\overline{C}_{i,\kappa,v}^{j+1}=\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}Q_{i,\kappa,l}^{(f)}+\sum_{f=1}^{n_{f}}\sum_{l=1}^{n_{q,f}^{\partial}}Q_{i,\kappa^{(f)},l}^{(f)}.
\]

\end_inset


\begin_inset Formula $\beta_{f,l}$
\end_inset

 can then be prescribed using only the 
\begin_inset Formula $\beta_{T}$
\end_inset

 constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta_T"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (i.e., the constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint-concentration"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be ignored); furthermore, 
\begin_inset Formula $\beta_{f,l}$
\end_inset

 does not need to be recomputed since 
\begin_inset Formula $\mathcal{F}^{v}\left(y,\omega\nabla y\right)=G\left(y\right):\omega\nabla y=\omega\mathcal{F}^{v}\left(y,\nabla y\right)$
\end_inset

 and 
\begin_inset Formula $\beta^{*}\left(y,\mathcal{F}^{v}\left(y,\nabla y\right),n\right)\geq\beta^{*}\left(y,\omega\mathcal{F}^{v}\left(y,\nabla y\right),n\right)=\omega\beta^{*}\left(y,\mathcal{F}^{v}\left(y,\nabla y\right),n\right)$
\end_inset

, for 
\begin_inset Formula $\omega\in\left[0,1\right]$
\end_inset

.
 It should also be noted that the constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint-concentration"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be overly restrictive, such that nonnegativity of species concentrations
 can often be maintained even if the constraint
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:beta-constraint-concentration"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is neglected and 
\begin_inset Formula $\omega_{\kappa,l}^{(f)}=\omega_{\kappa^{(f)},l}^{(f)}=1$
\end_inset

 for all 
\begin_inset Formula $l,f$
\end_inset

.
 I
\end_layout

\begin_layout Standard
In this study, we limit the gradient at interfaces belonging to cells for
 which 
\begin_inset Formula $\Delta t$
\end_inset

 needs to be halved three or more times for 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}\geq0$
\end_inset

.
 The time-step size required to ensure nonnegative species concentrations
 can be computed algebraically by rewriting Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-viscous-2d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in terms of species concentrations and setting the LHS to zero.
 Note that the need to limit the gradient is extremely rare.
 In this work, gradient limiting is applied only in early time steps in
 certain two-dimensional detonation simulations, which will be further discussed
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:detonation-results"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 An alternative to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:flux-limit-gradient"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is to instead apply the density limiter in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:limiting-procedure"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to the state and modify the fourth term in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:semi-discrete-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\left(\average{\mathcal{F}^{v}\left(y,\nabla y\right)}\cdot n-\delta^{v}\left(y,\nabla y,n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon}\leftarrow\left(\average{\mathcal{F}^{v}\left(\ddot{y},\nabla\ddot{y}\right)}\cdot n-\delta^{v}\left(\ddot{y},\nabla\ddot{y},n\right),\left\llbracket \mathfrak{v}\right\rrbracket \right)_{\epsilon},\label{eq:flux-limit-state}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\[
\ddot{y}=\left(\rho v_{1},\ldots,\rho v_{d},\rho e_{t},\ddot{C_{1}},\ldots,\ddot{C}_{n_{s}}\right),\quad\ddot{C_{i}}=\overline{C}_{i}+\omega\left(C_{i}-\overline{C}_{i}\right).
\]

\end_inset

However, iteration would then be required to determine 
\begin_inset Formula $\omega_{\kappa,l}^{(f)}$
\end_inset

 and 
\begin_inset Formula $\omega_{\kappa^{(f)},l}^{(f)}$
\end_inset

 such that 
\begin_inset Formula $\overline{C}_{i,\kappa,v}^{j+1}\geq0$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
NOTE: this note is slightly out-of-date - previously, proposed limiting
 the entire state in the element with uniform 
\begin_inset Formula $\omega$
\end_inset

 (which is what this note is referring to), as opposed to have a pointwise
 
\begin_inset Formula $\omega$
\end_inset

 parameter for limiting the state.
 
\end_layout

\begin_layout Plain Layout
The reason why just doing normal limiting won't work as well (as opposed
 to gradient limiting as proposed): 
\begin_inset Formula $\grave{C}_{i}$
\end_inset

 is not guaranteed to monotonically increase with decreasing 
\begin_inset Formula $\omega^{(g)}$
\end_inset

.
 Therefore, if 
\begin_inset Formula $\omega_{\kappa}^{(g)}$
\end_inset

 and 
\begin_inset Formula $\omega_{\kappa^{(f)}}^{(g)}$
\end_inset

 are iteratively varied using a naive approach (e.g., decrease in increments
 of 0.1 starting from 1), won't necessarily get to appropriate values of
 
\begin_inset Formula $\omega_{\kappa}^{(g)}$
\end_inset

 and 
\begin_inset Formula $\omega_{\kappa^{(f)}}^{(g)}$
\end_inset

 that give small enough 
\begin_inset Formula $\grave{C}_{i}$
\end_inset

 (until you get to zero).
 Note that it is possible to use bisection or another method to find 
\begin_inset Formula $\omega_{\kappa}^{(g)}$
\end_inset

 such that 
\begin_inset Formula $\grave{C}_{i,\kappa}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)=0$
\end_inset

 and similarly for 
\begin_inset Formula $\omega_{\kappa^{(f)}}^{(g)}$
\end_inset

.
 However, the bigger issue is as follows: even if 
\begin_inset Formula $\omega_{\kappa}^{(g)}$
\end_inset

 is chosen such that 
\begin_inset Formula $\grave{C}_{i,\kappa}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)=0$
\end_inset

 for some 
\begin_inset Formula $l,f$
\end_inset

, 
\begin_inset Formula $\grave{C}_{i,\kappa}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)$
\end_inset

 may actually decrease for a different 
\begin_inset Formula $l,f$
\end_inset

, such that you may still get negative 
\begin_inset Formula $\overline{C}_{i,\kappa}^{j}$
\end_inset

 (or 
\begin_inset Formula $\overline{C}_{i,\kappa^{(f)}}^{j}$
\end_inset

).
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Worst case, consider 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\left(\overleftrightarrow{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)=0$
\end_inset

 , where 
\begin_inset Formula $\overleftrightarrow{C}_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\neq C_{i,\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)$
\end_inset

.
 The above strategy does not necessarily work since do 
\begin_inset Formula $p=0$
\end_inset

 projection on species; then 
\begin_inset Formula $\mathcal{F}_{C_{i}}^{v}\left(\overleftrightarrow{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right),\nabla y_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)\right)\cdot n\left(\zeta_{l}^{\left(f\right)}\right)=0$
\end_inset

 for general 
\begin_inset Formula $\overleftrightarrow{y}_{\kappa}^{j}\left(\xi\left(\zeta_{l}^{\left(f\right)}\right)\right)$
\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Suppose one cell has negative average concentration.
 If species gradient limiting is then only activated for that one cell,
 will modify the average species concentration in neighboring cells, which
 can cause negative average concentration in those cells.
 To be truly robust, would need to activate species gradient limiting for
 all cells (though obviously this is more restrictive).
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Can easily determine 
\begin_inset Formula $\Delta t^{*}$
\end_inset

 needed to maintain nonnegative species concentration by just solving for
 
\begin_inset Formula $\Delta t^{*}$
\end_inset

 in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fully-discrete-form-average-viscous-2d"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Section
Results
\begin_inset CommandInset label
LatexCommand label
name "sec:results"

\end_inset


\end_layout

\begin_layout Standard
We consider three one-dimensional test cases: advection-diffusion of a thermal
 bubble, a premixed flame, and viscous shock-tube flow.
 Next, we compute two multidimensional reacting flows: a moving detonation
 wave enclosed by adiabatic walls and shock/mixing-layer interaction.
 Unless otherwise specified, the adaptive time stepping strategy described
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Adaptive-time-stepping"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with second-order strong-stability-preserving Runge-Kutta method (SSPRK2)
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Got01,Spi02"
literal "false"

\end_inset

 is employed.
 All simulations are performed using a modified version of the JENRE
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textregistered
\end_layout

\end_inset


\begin_inset space ~
\end_inset

Multiphysics Framework
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Cor18_SCITECH,Joh20_2"
literal "false"

\end_inset

 that incorporates the developments and extensions described in this work.
 
\end_layout

\begin_layout Subsection
One-dimensional thermal bubble advection-diffusion
\begin_inset CommandInset label
LatexCommand label
name "subsec:thermal-bubble"

\end_inset


\end_layout

\begin_layout Standard
In this problem, we assess the order of accuracy of the positivity-preserving
 and entropy-bounded DG formulation (without artificial viscosity).
 The computational domain is 
\begin_inset Formula $\Omega=[-25,25]\:\mathrm{m}$
\end_inset

.
 Periodicity is imposed at the left and right boundaries.
 The initial conditions are given by 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
v_{1} & = & 1\textrm{ m/s},\nonumber \\
Y_{H_{2}} & = & \frac{1}{2}\left[1-\tanh\left(|x|-10\right)\right],\nonumber \\
Y_{O_{2}} & = & 1-Y_{H_{2}},\label{eq:thermal-bubble}\\
T & = & 1200-900\tanh\left(|x|-10\right)\textrm{ K},\nonumber \\
P & = & 1\textrm{ bar}.\nonumber 
\end{eqnarray}

\end_inset

In
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

, optimal convergence without any additional stabilization, including limiting,
 was demonstrated.
 In
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

, we showed optimal convergence from 
\begin_inset Formula $p=1$
\end_inset

 to 
\begin_inset Formula $p=3$
\end_inset

 using the positivity-preserving, entropy-bounded DG method for 
\emph on
inviscid
\emph default
, reacting flows.
 Four element sizes were considered: 
\begin_inset Formula $h$
\end_inset

, 
\begin_inset Formula $h/2$
\end_inset

, 
\begin_inset Formula $h/4$
\end_inset

, and 
\begin_inset Formula $h/8$
\end_inset

, where 
\begin_inset Formula $h=2\:\mathrm{m}$
\end_inset

.
 The limiters were not activated when finer meshes were employed.
 Here, we repeat this investigation in the viscous setting.
 The thermodynamic relations can be found in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
after "Section 8.1"
key "Chi22"
literal "false"

\end_inset

.
 Instead of the adaptive time stepping strategy described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Adaptive-time-stepping"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we separately consider both viscous flux functions with fixed 
\begin_inset Formula $\mathrm{CFL}=0.1$
\end_inset

 to minimize temporal errors.
 The 
\begin_inset Quotes eld
\end_inset

exact
\begin_inset Quotes erd
\end_inset

 solution is obtained with 
\begin_inset Formula $p=3$
\end_inset

 and 
\begin_inset Formula $h/256$
\end_inset

.
 The 
\begin_inset Formula $L^{2}$
\end_inset

 error at 
\begin_inset Formula $t=5\:\mathrm{s}$
\end_inset

 is computed in terms of the normalized state variables,
\begin_inset Formula 
\[
\widehat{\rho v}_{k}=\frac{1}{\sqrt{\rho_{r}P_{r}}}\rho v_{k},\quad\widehat{\rho e}_{t}=\frac{1}{P_{r}}\rho e_{t},\quad\widehat{C}_{i}=\frac{R^{0}T_{r}}{P_{r}}C_{i},
\]

\end_inset

where 
\begin_inset Formula $\rho_{r}=1\,\mathrm{kg\cdot}\mathrm{m}^{-3}$
\end_inset

, 
\begin_inset Formula $T_{r}=1000\,\mathrm{K}$
\end_inset

, and 
\begin_inset Formula $P_{r}=101325\,\mathrm{Pa}$
\end_inset

.
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:thermal-bubble-convergence"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the convergence results for both viscous flux functions.
 The theoretical convergence rates are denoted with dashed lines.
 The 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\times$
\end_inset


\begin_inset Quotes erd
\end_inset

 symbol indicates that the positivity-preserving limiter is activated, the
 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\Circle$
\end_inset


\begin_inset Quotes erd
\end_inset

 symbol indicates that the entropy limiter is activated, and the 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\triangle$
\end_inset


\begin_inset Quotes erd
\end_inset

 symbol indicates that neither limiter is activated.
 If both limiters are activated, then the corresponding symbols are superimposed
 as 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\otimes$
\end_inset


\begin_inset Quotes erd
\end_inset

.
 The results are extremely similar between the two viscous flux functions.
 Apart from the coarser grids with 
\begin_inset Formula $p=1$
\end_inset

, which are likely outside the asymptotic regime, optimal convergence is
 demonstrated.
 For 
\begin_inset Formula $h$
\end_inset

 and 
\begin_inset Formula $h/2$
\end_inset

, both limiters are activated across all 
\begin_inset Formula $p$
\end_inset

; for 
\begin_inset Formula $h/4$
\end_inset

 and 
\begin_inset Formula $p=1$
\end_inset

, only the positivity-preserving limiter is activated.
 At higher resolutions, the limiters are not engaged since the solutions
 are fairly well-resolved.
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/thermal_bubble_convergence_diffusion_BR2.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:thermal_bubble_convergence_diffusion_BR2"

\end_inset

BR2 viscous flux function.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/thermal_bubble_convergence_diffusion_LLF.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:thermal_bubble_convergence_diffusion_LLF"

\end_inset

Lax-Friedrichs-type viscous flux function.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:thermal-bubble-convergence"

\end_inset

 Convergence under grid refinement, with 
\begin_inset Formula $h=2\:\mathrm{m}$
\end_inset

, for the one-dimensional thermal bubble test case.
 The 
\begin_inset Formula $L^{2}$
\end_inset

 error of the normalized state with respect to the exact solution at 
\begin_inset Formula $t=5\:\mathrm{s}$
\end_inset

 is computed.
 The dashed lines represent the theroretical convergence rates.
 The 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\times$
\end_inset


\begin_inset Quotes erd
\end_inset

 symbol indicates that the positivity-preserving limiter is activated, the
 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\Circle$
\end_inset


\begin_inset Quotes erd
\end_inset

 symbol indicates that the entropy limiter is activated, and the 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\triangle$
\end_inset


\begin_inset Quotes erd
\end_inset

 symbol indicates that neither limiter is activated.
 If both limiters are activated, then the corresponding symbols are superimposed
 as 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\otimes$
\end_inset


\begin_inset Quotes erd
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
One-dimensional premixed flame
\begin_inset space ~
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:1d-flame"

\end_inset


\end_layout

\begin_layout Standard
In this problem, we consider a smooth, viscous flow with chemical reactions.
 A freely propagating flame is calculated in Cantera
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "cantera"
literal "false"

\end_inset

 on a 1 cm long grid using the left state in Equations
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:freely_propagating_flame_1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:freely_propagating_flame_2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 below.
 The computational domain is 
\begin_inset Formula $\Omega=[0,0.01]\text{ m}$
\end_inset

.
 For the DG calculations, we generate a mesh that contains a refinement
 zone between 1.8 mm and 2.5 mm with grid spacing 
\begin_inset Formula $h=150$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $\mu$
\end_inset

m, a target size that is 150 times larger than the smallest grid spacing
 from the resulting refinement procedure in Cantera.
 The mesh transitions to a spacing of 
\begin_inset Formula $500$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $\mu$
\end_inset

m at the boundaries.
 Note that the Cantera solution, unlike the DG solution, assumes constant
 pressure.
 The objective here is to ignite the flame and establish a solution in which
 the flame anchors itself in the fine region of the one-dimensional mesh.
 The initial conditions are given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\left(v_{1},T,P\right) & = & \begin{cases}
\left(9.53\text{ m/s},2122\text{ K},1\text{ atm}\right), & x\geq2.5\text{ mm}\\
\left(1.53\text{ m/s},300\text{ K},1\text{ atm}\right), & x<2.5\text{ mm}
\end{cases},\label{eq:freely_propagating_flame_1}
\end{eqnarray}

\end_inset

with mass fractions
\begin_inset Formula 
\begin{equation}
\begin{split}\left(Y_{H_{2}},Y_{O_{2}},Y_{N_{2}},Y_{H},Y_{O}\right)= & \begin{cases}
\left(7\times10^{-5},0.0572,0.745,4.2\times10^{-6},2.2\times10^{-4}\right), & x\geq2.5\text{ mm}\\
\left(0.023,0.24,0.737,0,0\right), & x<2.5\text{ mm}
\end{cases}\\
\left(Y_{OH},Y_{H_{2}O},Y_{HO_{2}},Y_{H_{2}O_{2}}\right)= & \begin{cases}
\left(2.7\times10^{-4},0.194,3\times10^{-6},2.1\times10^{-7}\right), & x\geq2.5\text{ mm}\\
\left(0,0,0,0\right), & x<2.5\text{ mm}
\end{cases}
\end{split}
.\label{eq:freely_propagating_flame_2}
\end{equation}

\end_inset

The right state corresponding to 
\begin_inset Formula $x\geq2.5\text{ mm}$
\end_inset

 is the final fully reacted state from the Cantera solution.
 The left boundary condition is a characteristic inflow condition that allows
 pressure waves to leave the domain.
 The right boundary is a reflective outflow condition with the pressure
 set to 1 atm.
 The chemical mechanism used here is based on the Westbrook mechanism and
 can be found in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
after "Appendix D"
key "Chi22_2"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
We perform 
\begin_inset Formula $p=1$
\end_inset

 and 
\begin_inset Formula $p=3$
\end_inset

 calculations without artificial viscosity.
 A 
\begin_inset Formula $p=1$
\end_inset

 solution with conventional species clipping (instead of the positivity-preservi
ng and entropy limiters), in which negative species concentrations are simply
 set to zero, is also computed.
 The default CFL is set to 0.4.
 In the beginning of the simulation, the states on both sides of the discontinui
ty immediately diffuse to form a smooth profile.
 As the reactions progress, the flame accelerates against the right-moving
 reactants and then slows down to the flame speed.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
With sufficient accuracy, the flame should remain stationary inside the
 refined region.
\end_layout

\end_inset

 These initial transient processes can cause slight movement of the flame
 at early times, especially in coarser solutions, and are not directly accounted
 for in the Cantera simulation; therefore, in the comparisons below, the
 Cantera solution is shifted such that temperature is equal to 1000 K at
 the same point as the corresponding DG solution.
 
\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:diffusion_flame_clipping"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows instantaneous solutions at 
\begin_inset Formula $t=0.005$
\end_inset


\begin_inset space ~
\end_inset

s for 
\begin_inset Formula $p=1$
\end_inset

 with species clipping.
 Clear discrepancies between the solution and the Cantera solution are observed.
 The velocity and the mass fractions of 
\begin_inset Formula $\mathrm{OH}$
\end_inset

 and 
\begin_inset Formula $\mathrm{H_{2}O_{2}}$
\end_inset

 are overpredicted.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Additionally, the solution fails to maintain a stable profile; by 
\begin_inset Formula $t=0.002$
\end_inset


\begin_inset space ~
\end_inset

s, the flame drifts out of the refinement zone and the solution diverges.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset Formula $p=1$
\end_inset

 and 
\begin_inset Formula $p=3$
\end_inset

 results obtained with the proposed positivity-preserving, entropy-bounded
 methodology are given in Figures
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:diffusion_limited_p1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:diffusion_limited_p3"
plural "false"
caps "false"
noprefix "false"

\end_inset

, respectively.
 Although the 
\begin_inset Formula $p=1$
\end_inset

 solution does not fully capture the species profiles and overpredicts the
 velocity, it agrees much more closely with the Cantera solution than the
 
\begin_inset Formula $p=1$
\end_inset

 solution obtained with species clipping.
 The velocity and mass-fraction profiles of the 
\begin_inset Formula $p=3$
\end_inset

 solution are in noticeably better agreement with those of the Cantera solution
 than the 
\begin_inset Formula $p=1$
\end_inset

 solution.
\begin_inset Note Note
status open

\begin_layout Plain Layout
The 
\begin_inset Formula $p=3$
\end_inset

 pressure field smoothly transitions through the flame without the spikes
 found in the 
\begin_inset Formula $p=1$
\end_inset

 solution.
 A major improvement over the clipping solution is that in both the 
\begin_inset Formula $p=1$
\end_inset

 and 
\begin_inset Formula $p=3$
\end_inset

 simulations, the flame is held in the refinement zone with the expected
 flame speed.
\end_layout

\end_inset

 These results illustrate the benefits of employing the proposed positivity-pres
erving, entropy-bounded DG formulation.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/flame/p1_clipping_T.pdf
	lyxscale 40
	width 31col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Temperature.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/flame/p1_clipping_v.pdf
	lyxscale 40
	width 29col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Velocity.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/flame/p1_clipping_OH_H2O2.pdf
	lyxscale 40
	width 36col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Mass fractions.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:diffusion_flame_clipping"

\end_inset


\begin_inset Formula $p=1$
\end_inset

 solution to a one-dimensional premixed flame at 
\begin_inset Formula $t=0.005$
\end_inset


\begin_inset space ~
\end_inset

s obtained with species clipping.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/flame/p1_T.pdf
	lyxscale 40
	width 31col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Temperature.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/flame/p1_v.pdf
	lyxscale 40
	width 29col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Velocity.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/flame/p1_OH_H2O2.pdf
	lyxscale 40
	width 36col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Mass fractions.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:diffusion_limited_p1"

\end_inset


\begin_inset Formula $p=1$
\end_inset

 solution to a one-dimensional premixed flame at 
\begin_inset Formula $t=0.005$
\end_inset


\begin_inset space ~
\end_inset

s obtained with the proposed positivity-preserving and entropy-bounded formulati
on.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/flame/p3_T.pdf
	lyxscale 40
	width 31col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Temperature.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/flame/p3_v.pdf
	lyxscale 40
	width 29col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Velocity.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/flame/p3_OH_H2O2.pdf
	lyxscale 40
	width 36col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Mass fractions.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:diffusion_limited_p3"

\end_inset


\begin_inset Formula $p=3$
\end_inset

 solution to a one-dimensional premixed flame at 
\begin_inset Formula $t=0.005$
\end_inset


\begin_inset space ~
\end_inset

s obtained with the proposed positivity-preserving and entropy-bounded formulati
on.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
One-dimensional shock tube
\begin_inset CommandInset label
LatexCommand label
name "subsec:shock-tube"

\end_inset


\end_layout

\begin_layout Standard
This test case was computed without viscous effects by Houim and Kuo
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Hou11"
literal "false"

\end_inset

, by Johnson and Kercher
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

, and in our previous work
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

, where we showed that (a) instabilities in the multicomponent, thermally
 perfect case are much greater than in the monocomponent, calorically perfect
 case and (b) enforcement of an entropy bound suppresses large-scale nonphysical
 oscillations much more effectively than enforcement of the positivity property.
 Our goals here are to investigate whether these observations hold in the
 viscous setting and to further compare the BR2 and Lax-Friedrichs-type
 viscous flux functions.
 The computational domain is 
\begin_inset Formula $\Omega=[0,1]\text{ m}$
\end_inset

, and the final time is 
\begin_inset Formula $t=300\;\mu\mathrm{s}$
\end_inset

.
 Walls are imposed at the left and right boundaries.
 The initial conditions are written as
\begin_inset Formula 
\begin{equation}
\left(v_{1},T,P,Y_{N_{2}},Y_{He}\right)=\begin{cases}
\left(0\text{ m/s},300\text{ K},1\text{ atm},1,0\right), & x\geq0.4\\
\left(0\text{ m/s},300\text{ K},10\text{ atm},0,1\right), & x<0.4
\end{cases}.\label{eq:shock-tube-IC-Houim}
\end{equation}

\end_inset

For consistency with
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

, the default CFL is set to 0.1.
 For the remainder of this subsection, 
\begin_inset Quotes eld
\end_inset

BR2
\begin_inset Quotes erd
\end_inset

 refers to the adaptive time stepping strategy exactly as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Adaptive-time-stepping"
plural "false"
caps "false"
noprefix "false"

\end_inset

, whereas 
\begin_inset Quotes eld
\end_inset

LLF
\begin_inset Quotes erd
\end_inset

 refers to a similar time stepping strategy, but with the viscous flux function
 fixed to be the local Lax-Friedrichs-type flux function.
 In addition, 
\begin_inset Quotes eld
\end_inset

PPL
\begin_inset Quotes erd
\end_inset

 corresponds to only the positivity-preserving limiter, while 
\begin_inset Quotes eld
\end_inset

EL
\begin_inset Quotes erd
\end_inset

 corresponds to both the positivity-preserving and entropy limiters.
 Based on
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

, a reference solution is computed using 
\begin_inset Formula $p=2$
\end_inset

, 2000 elements, artificial viscosity, BR2, and EL.
 All other solutions are computed using 
\begin_inset Formula $p=3$
\end_inset

 and 200 elements.
 The thermodyamic relations can be found in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
after "Section 8.3"
key "Chi22"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shock_tube_BR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the mass fraction, pressure, temperature, and entropy profiles obtained
 with BR2.
 Except for the reference solution, artificial viscosity is not employed
 in order to isolate the effects of the limiters.
 Note that the linear-scaling limiters alone are not expected to eliminate
 small-scale spurious oscillations
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha10,Jia18,Lv15_2,Wu21_2"
literal "false"

\end_inset

.
 The results are very similar to those in the inviscid case
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

.
 The species profiles are well-captured using both types of limiting.
 The entropy limiter dampens large-scale instabilities in the pressure,
 temperature, and entropy distributions significantly better than the positivity
-preserving limiter.
 Furthermore, just as observed in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

, the instabilities still present with the positivity-preserving limiter
 are substantially larger than those usually present in monocomponent, calorical
ly perfect shock-tube solutions computed with the positivity-preserving
 limiter
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha10,Zha12_2,Zha17"
literal "false"

\end_inset

, and the relative advantage of applying the entropy limiter is much greater.
 The addition of artificial viscosity would greatly suppress the small-scale
 instabilities; for brevity, such results are not included here, but they
 are very similar to those in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22"
literal "false"

\end_inset

.
 At the same time, artificial viscosity alone (without the limiters) results
 in negative concentrations and other instabilities, thus motivating a combinati
on of the two stabilization mechanisms.
 The corresponding LLF results are given in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shock_tube_LLF"
plural "false"
caps "false"
noprefix "false"

\end_inset

, which are very similar to the BR2 results.
 However, the temperature overshoot at the shock is noticeably smaller in
 the LLF case, indicating that the Lax-Friedrichs-type viscous flux function
 can sometimes have better stabilization properties than the BR2 scheme.
 Regardless, the results in the following subsection suggest that the latter
 is still the preferred viscous flux function, provided that the positivity
 property is satisfied.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_Y_BR2.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_Y_BR2"

\end_inset

Mass fractions.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_P_BR2.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_P_BR2"

\end_inset

Pressure.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_T_BR2.pdf
	lyxscale 40
	width 48col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_T_BR2"

\end_inset

Temperature.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_s_BR2.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_s_BR2"

\end_inset

Specific thermodynamic entropy.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_BR2"

\end_inset

Results for 
\begin_inset Formula $p=3$
\end_inset

 solutions computed using BR2 on 200 elements without artificial viscosity
 for the one-dimensional, multicomponent shock-tube problem with initialization
 in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:shock-tube-IC-Houim"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\begin_inset Quotes eld
\end_inset

PPL
\begin_inset Quotes erd
\end_inset

 corresponds to the positivity-preserving limiter by itself, and 
\begin_inset Quotes eld
\end_inset

EL
\begin_inset Quotes erd
\end_inset

 refers to both the positivity-preserving and entropy limiters with the
 local entropy bound in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:local-entropy-bound"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_Y_LLF.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_Y_LLF"

\end_inset

Mass fractions.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_P_LLF.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_P_LLF"

\end_inset

Pressure.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_T_LLF.pdf
	lyxscale 40
	width 48col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_T_LLF"

\end_inset

Temperature.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_s_LLF.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_s_LLF"

\end_inset

Specific thermodynamic entropy.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_LLF"

\end_inset

Results for 
\begin_inset Formula $p=3$
\end_inset

 solutions computed using LLF on 200 elements without artificial viscosity
 for the one-dimensional, multicomponent shock-tube problem with initialization
 in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:shock-tube-IC-Houim"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\begin_inset Quotes eld
\end_inset

PPL
\begin_inset Quotes erd
\end_inset

 corresponds to the positivity-preserving limiter by itself, and 
\begin_inset Quotes eld
\end_inset

EL
\begin_inset Quotes erd
\end_inset

 refers to both the positivity-preserving and entropy limiters with the
 local entropy bound in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:local-entropy-bound"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shock_tube_conservation_error_BR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 presents the percent error in mass, energy, and atom conservation for the
 BR2, EL solution as a representative example, calculated every 
\begin_inset Formula $0.3\;\mu\mathrm{s}$
\end_inset

 (for a total of 1000 samples).
 
\begin_inset Formula $\mathsf{N}_{N}$
\end_inset

 and 
\begin_inset Formula $\mathsf{N}_{He}$
\end_inset

 denote the total numbers of nitrogen and helium atoms in the mixture.
 The error remains close to machine precision, verifying that the developed
 DG framework is conservative.
 Also shown is the error in mass conservation (calculated every time step)
 for a solution computed with conventional species clipping.
 The error rises considerably before the solver diverges.
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/viscous/shock_tube_conservation_error_BR2.pdf
	lyxscale 40
	width 60col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_conservation_error_BR2"

\end_inset

Percent error in mass, energy, and atom conservation for the 
\begin_inset Quotes eld
\end_inset

EL
\begin_inset Quotes erd
\end_inset

 case in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shock_tube_BR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

, computed with 
\begin_inset Formula $p=3$
\end_inset

 on 200 elements.
 The initial conditions for this one-dimensional, multicomponent shock-tube
 problem are given in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:shock-tube-IC-Houim"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Also shown is the error in mass conservation for a solution computed with
 conventional species clipping.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shock_tube_BR2_AV"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the mass fraction, pressure, temperature, and entropy profiles obtained
 with BR2 and artificial viscosity.
 The Lax-Friedrichs-type viscous flux function gives very similar results,
 which are not shown here for brevity.
 As previously mentioned, the linear-scaling limiter is not expected to
 suppress all nonlinear instabilities, especially small-scale oscillations.
 The addition of artificial viscosity causes slight smearing of the solution,
 but largely eliminates the instabilities observed in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shock_tube_BR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 A temperature undershoot present at the shock when only the positivity-preservi
ng limiter is employed is suppressed by the entropy limiter.
 This set of results confirms adequate suppression of instabilities when
 both artificial viscosity and the entropy limiter are used.
\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_Y_BR2_AV.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_Y_BR2_AV"

\end_inset

Mass fractions.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_P_BR2_AV.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_P_BR2_AV"

\end_inset

Pressure.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_T_BR2_AV.pdf
	lyxscale 40
	width 46col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_T_BR2_AV"

\end_inset

Temperature.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/shock_tube_s_BR2_AV.pdf
	lyxscale 40
	width 45col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_s_BR2_AV"

\end_inset

Specfic thermodynamic entropy.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shock_tube_BR2_AV"

\end_inset

 Results for 
\begin_inset Formula $p=3$
\end_inset

 solutions computed using BR2 on 200 elements with artificial viscosity
 for the one-dimensional, multicomponent shock-tube problem with initialization
 in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:shock-tube-IC-Houim"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\begin_inset Quotes eld
\end_inset

PPL
\begin_inset Quotes erd
\end_inset

 corresponds to the positivity-preserving limiter by itself, and 
\begin_inset Quotes eld
\end_inset

EL
\begin_inset Quotes erd
\end_inset

 refers to both the positivity-preserving and entropy limiters with the
 local entropy bound in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:local-entropy-bound"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The difference between these results and those in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shock_tube_BR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is the use of artificial viscosity in the PPL and EL solutions here.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Two-dimensional detonation wave
\begin_inset space ~
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:detonation-results"

\end_inset


\end_layout

\begin_layout Standard
This test case involves a moving hydrogen-oxygen detonation wave diluted
 in Argon with initial conditions
\begin_inset Formula 
\begin{equation}
\begin{array}{cccc}
\qquad\qquad\qquad\left(v_{1},v_{2}\right) & = & \left(0,0\right)\text{ m/s},\\
X_{Ar}:X_{H_{2}O}:X_{OH}:X_{O_{2}}:X_{H_{2}} & = & \begin{cases}
8:2:0.1:0:0\\
7:0:0:1:2
\end{cases} & \begin{array}{c}
x_{1}<0.012\text{ m},x\in\mathcal{C}_{1},x\in\mathcal{C}_{2}\\
\mathrm{otherwise}
\end{array},\\
\qquad\qquad\qquad\qquad P & = & \begin{cases}
\expnumber{5.50}5 & \text{ Pa}\\
\expnumber{6.67}3 & \text{ Pa}
\end{cases} & \begin{array}{c}
x_{1}<0.012\text{ m},x\in\mathcal{C}_{1},x\in\mathcal{C}_{2}\\
\mathrm{otherwise}
\end{array},\\
\qquad\qquad\qquad\qquad T & = & \begin{cases}
3500 & \text{ K}\\
300\text{\hspace{1em}\hspace{1em}} & \text{ K}
\end{cases} & \begin{array}{c}
x_{1}<0.012\text{ m},x\in\mathcal{C}_{1},x\in\mathcal{C}_{2}\\
\mathrm{otherwise}
\end{array},
\end{array}\label{eq:2D-detonation-initialization}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{align*}
\mathcal{C}_{1} & =\left\{ x\left|\sqrt{\left(x_{1}-0.019\right)^{2}+\left(x_{2}-0.015\right)^{2}}<0.0035\text{ m}\right.\right\} ,\\
\mathcal{C}_{2} & =\left\{ x\left|\sqrt{\left(x_{1}-0.020\right)^{2}+\left(x_{2}-0.044\right)^{2}}<0.0035\text{ m}\right.\right\} ,
\end{align*}

\end_inset

which represent two high-pressure/high-temperature regions to perturb the
 flow.
 The computational domain is 
\begin_inset Formula $\text{\ensuremath{\Omega}}=\left(0,0.45\right)\mathrm{m}\times\left(0,0.06\right)\mathrm{m}$
\end_inset

, with adiabatic, no-slip walls at the left, right, bottom, and top boundaries.
 The chemical mechanism is based on the Westbrook mechanism and can be found
 in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
after "Appendix D"
key "Chi22_2"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Johnson and Kercher computed this flow without viscous effects with 
\begin_inset Formula $p=1$
\end_inset

 and a very fine mesh with spacing 
\begin_inset Formula $h=9\times10^{-5}$
\end_inset

 m
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

.
 In
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22_2"
literal "false"

\end_inset

, we simulated this flow (also without viscous effects) using a series of
 triangular grids ranging from very coarse to fine.
 Stability was maintained across all resolutions.
 The finer cases predicted the correct diamond-like cellular structure,
 with a cell length of 
\begin_inset Formula $0.055\text{ m}$
\end_inset

 and a cell height of 
\begin_inset Formula $0.03\text{ m}$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Ora98,Lef98"
literal "false"

\end_inset

.
 In particular, there were two cells in the vertical direction.
 Here, we recompute this flow with viscous effects and quadrilateral elements.
 Specifically, we use Gmsh
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Geu09"
literal "false"

\end_inset

 to first generate structured-type, uniform grids with element sizes of
 
\begin_inset Formula $2h$
\end_inset

, 
\begin_inset Formula $8h$
\end_inset

, and 
\begin_inset Formula $64h$
\end_inset

; the cells are then clustered near the top and bottom walls, resulting
 in smaller mesh spacing in the vertical direction at said walls.
 Since the grids do not directly account for the circular perturbations
 in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2D-detonation-initialization"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the discontinuities in the initial conditions are slightly smoothed using
 hyperbolic tangent functions.
 For the remainder of this subsection, 
\begin_inset Quotes eld
\end_inset

BR2
\begin_inset Quotes erd
\end_inset

 refers to the adaptive time stepping strategy exactly as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Adaptive-time-stepping"
plural "false"
caps "false"
noprefix "false"

\end_inset

, whereas 
\begin_inset Quotes eld
\end_inset

LLF
\begin_inset Quotes erd
\end_inset

 refers to a similar time stepping strategy, but with the viscous flux function
 fixed to be the local Lax-Friedrichs-type flux function.
 SSPRK3 time integration is employed with a default CFL of 0.4.
\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2D-detonation-LLF"
plural "false"
caps "false"
noprefix "false"

\end_inset

 presents the distributions of OH mole fraction and temperature obtained
 from 
\begin_inset Formula $p=2$
\end_inset

 solutions at 
\begin_inset Formula $t=200$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $\mu\mathrm{s}$
\end_inset

 computed with LLF.
 Unsurprisingly, the 
\begin_inset Formula $64h$
\end_inset

 solution is extremely smeared behind the shock.
 A large, nonphysical temperature undershoot is observed near the top and
 bottom walls.
 To more clearly illustrate this undershoot, Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2D-detonation-T-zoom"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (top) zooms in on the temperature field at the bottom wall.
 The flow is much better resolved in the 
\begin_inset Formula $8h$
\end_inset

 case according to Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2D-detonation-LLF"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The near-wall instabilities largely disappear, but spurious oscillations
 can be observed in the mole-fraction field.
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2D-detonation-BR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 displays the corresponding distributions of OH mole fraction and temperature
 obtained with BR2, along with a 
\begin_inset Formula $2h$
\end_inset

 solution.
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2D-detonation-T-zoom"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (bottom) gives the near-wall temperature distribution for 
\begin_inset Formula $64h$
\end_inset

.
 These 
\begin_inset Formula $64h$
\end_inset

 and 
\begin_inset Formula $8h$
\end_inset

 solutions are similar to the LLF solutions, but with much smaller nonphysical
 instabilities.
 The detonation-front locations are fairly close across all cases.
 In the 
\begin_inset Formula $2h$
\end_inset

 solution, the flow topology, including transverse waves, vortices, and
 triple points, is well-captured.
 
\end_layout

\begin_layout Standard
The gradient limiting procedure described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:zero-species-concentrations"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is applied at the first time step of both LLF simulations
\begin_inset Note Note
status open

\begin_layout Plain Layout
, as well as the second time step of only the 
\begin_inset Formula $8h$
\end_inset

 LLF simulation
\end_layout

\end_inset

.
 Without it, at the first step of both simulations, 
\begin_inset Formula $\Delta t$
\end_inset

 would need to be halved approximately thirty times, resulting in a time-step
 size close to machine precision, for the solver to proceed.
 In contrast, gradient limiting is not applied in the BR2 simulations.
 This observation, combined with the smaller oscillations in the BR2 solutions,
 is the reason why the BR2 flux function is chosen to be the 
\begin_inset Quotes eld
\end_inset

default
\begin_inset Quotes erd
\end_inset

 flux function in the adaptive time stepping strategy proposed in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Adaptive-time-stepping"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/2D_detonation/p2_LLF.pdf
	lyxscale 40
	width 96col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D-detonation-X-OH-LLF"

\end_inset

OH mole fraction
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/2D_detonation/temperature_p2_LLF.pdf
	lyxscale 40
	width 96col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D-detonation-T-LLF"

\end_inset

Temperature
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D-detonation-LLF"

\end_inset


\begin_inset Formula $p=2$
\end_inset

 solution to a two-dimensional moving detonation wave at 
\begin_inset Formula $t=200$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $\mu\mathrm{s}$
\end_inset

 computed with LLF.
 The initial conditions are given in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2D-detonation-initialization"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/viscous/2D_detonation/64h_temperature_zoom.pdf
	lyxscale 70
	width 96col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D-detonation-T-zoom"

\end_inset

Temperature distributions obtained with the 
\begin_inset Formula $64h$
\end_inset

 mesh zoomed in on the bottom wall.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/2D_detonation/p2_BR2.pdf
	lyxscale 40
	width 96col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D-detonation-X-OH-BR2"

\end_inset

OH mole fraction
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/viscous/2D_detonation/temperature_p2_BR2.pdf
	lyxscale 40
	width 96col%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D-detonation-T-BR2"

\end_inset

Temperature
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D-detonation-BR2"

\end_inset


\begin_inset Formula $p=2$
\end_inset

 solution to a two-dimensional moving detonation wave at 
\begin_inset Formula $t=200$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $\mu\mathrm{s}$
\end_inset

 computed with BR2.
 The initial conditions are given in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2D-detonation-initialization"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2D-detonation-pmax"
plural "false"
caps "false"
noprefix "false"

\end_inset

 presents the maximum-pressure history, 
\begin_inset Formula $P^{*}$
\end_inset

, where 
\begin_inset Formula $P^{*,j+1}(x)=\max\left\{ P^{j+1}(x),P^{*,j}(x)\right\} $
\end_inset

, for the 
\begin_inset Formula $p=2$
\end_inset

, BR2 solutions.
 No cellular structure can be discerned in the 
\begin_inset Formula $64h$
\end_inset

 case due to the extremely coarse mesh.
 The cells in the 
\begin_inset Formula $8h$
\end_inset

 solution can be clearly identified, but begin to slightly dissipate towards
 the right of the domain.
 Finally, those in the 
\begin_inset Formula $2h$
\end_inset

 solution remain sharp throughout.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/viscous/2D_detonation/pressure_max_p2.pdf
	lyxscale 40
	width 96col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D-detonation-pmax"

\end_inset

Maximum-pressure history,  
\begin_inset Formula $P^{*}$
\end_inset

, where 
\begin_inset Formula $P^{*,j+1}(x)=\max\left\{ P^{j+1}(x),P^{*,j}(x)\right\} $
\end_inset

, for a two-dimensional moving detonation wave at 
\begin_inset Formula $t=200$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $\mu\mathrm{s}$
\end_inset

 computed with 
\begin_inset Formula $p=2$
\end_inset

, BR2, and a sequence of meshes, where 
\begin_inset Formula $h=9\times10^{-5}$
\end_inset

 m.
 The initial conditions are given in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2D-detonation-initialization"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
It is worth noting that just as in the inviscid setting
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22_2"
literal "false"

\end_inset

, the entropy limiter, as opposed to solely the positivity-preserving limiter,
 signifcantly improves robustness.
 In particular, without the entropy limiter, temperature undershoots can
 reach below 100 K, where the curve fits for thermodynamic properties are
 invalid, causing the nonlinear solver in the reaction step to slow down
 considerably.
 For instance, with BR2 and 
\begin_inset Formula $64h$
\end_inset

, applying only the positivity-preserving limiter (as opposed to both the
 positivity-preserving and entropy limiters) increases the total simulation
 cost by a factor of approximately.
\end_layout

\end_inset

 
\begin_inset Note Note
status open

\begin_layout Plain Layout
It is worth noting that the entropy limiter, as opposed to solely the positivity
-preserving limiter, is necessary to compute many of the above solutions.
 Specifically, throughout each simulation, the entropy limiter maintains
 a minimum temperature of around 300 K.
 Without it, however, the temperature can dip significantly below 300 K,
 where the curve fits for thermodynamic properties are no longer valid.
 Consequently, the nonlinear solver in the reaction step can slow down significa
ntly and even stall.
 In other types of flows, these errors in temperature may pollute the solution
 in different ways as well.
 This further highlights not only the numerical difficulties of calculating
 multicomponent, reacting flows with realistic thermodynamics, but also
 the advantages of using the entropy limiter in simulations of such flows.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2D_detonation_conservation_error"
plural "false"
caps "false"
noprefix "false"

\end_inset

 presents the percent error in discrete conservation of mass, energy, and
 atomic elements for BR2, 
\begin_inset Formula $32h$
\end_inset

 as a representative example, calculated every 
\begin_inset Formula $0.200\;\mu\mathrm{s}$
\end_inset

 (for a total of 1000 samples).
 
\begin_inset Formula $\mathsf{N}_{O}$
\end_inset

, 
\begin_inset Formula $\mathsf{N}_{H}$
\end_inset

, and 
\begin_inset Formula $\mathsf{N}_{Ar}$
\end_inset

 denote the total numbers of oxygen, hydrogen, and argon atoms in the mixture.
 The errors remain close to machine precision throughout the simulation.
 The fluctuations and slight increases in the error profiles are largely
 a result of minor numerical-precision issues due to the different orders
 of magnitude among the state variables.
 These results confirm that the proposed DG formulation is fully conservative.
 Also given in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2D_detonation_conservation_error"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is the error in mass conservation (calculated every time step) for a solution
 obtained with conventional species clipping.
 Artificial viscosity is still employed.
 The error increases rapidly until the solver diverges.
 We further note that if only the positivity-preserving limiter is employed
 (without the entropy limiter), then large-scale temperature undershoots
 may appear that can hinder convergence of the nonlinear solver in the reaction
 step.
 For example, the 
\begin_inset Formula $32h$
\end_inset

 calculation with the entropy limiter is nearly three times less expensive
 than a corresponding 
\begin_inset Formula $32h$
\end_inset

 calculation with solely the positivity-preserving limiter.
\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/viscous/2D_detonation/detonation_conservation_error.pdf
	lyxscale 40
	width 60col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D_detonation_conservation_error"

\end_inset

Percent error in mass, energy, and atom conservation for the 
\begin_inset Formula $p=2$
\end_inset

, BR2, 
\begin_inset Formula $32h$
\end_inset

 solution.
 The initial conditions for this two-dimensional hydrogen detonation problem
 are given in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2D-detonation-initialization"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Also given is the error in mass conservation for a solution obtained with
 conventional species clipping.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Finally, we recompute the BR2, 
\begin_inset Formula $64h$
\end_inset

 case with curved elements of quadratic geometric order.
 Specifically, high-order geometric nodes are first inserted into the straight-s
ided mesh, after which the midpoint nodes at interior interfaces are perturbed.
 These perturbations are performed only for 
\begin_inset Formula $x>0.05\text{ m}$
\end_inset

 to ensure the initial conditions are the same.
 This low-resolution case is computed in order to guarantee that the limiter
 is frequently activated.
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2D-detonation-X-OH-32h-linear-curved"
plural "false"
caps "false"
noprefix "false"

\end_inset

 displays the distributions of OH mole fraction for the linear and curved
 meshes, which are superimposed.
 The solution obtained with curved mesh is stable and extremely similar
 to that computed with the linear mesh, demonstrating that the proposed
 formulation is indeed compatible with curved elements.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/viscous/2D_detonation/64h_q1_q2.pdf
	lyxscale 40
	width 96col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2D-detonation-X-OH-32h-linear-curved"

\end_inset

OH mole-fraction field for a two-dimensional moving detonation wave at 
\begin_inset Formula $t=200$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $\mu\mathrm{s}$
\end_inset

 computed with 
\begin_inset Formula $p=2$
\end_inset

, BR2, and 
\begin_inset Formula $64h$
\end_inset

, where 
\begin_inset Formula $h=9\times10^{-5}$
\end_inset

 m, on linear and curved meshes.
 The curved mesh, which is of quadratic order, is obtained by inserting
 high-order geometric nodes into the linear mesh and perturbing said nodes.
 The initial conditions are given in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2D-detonation-initialization"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Three-dimensional shock/mixing-layer interaction
\end_layout

\begin_layout Standard
In this section, we compute a three-dimensional chemically reacting mixing
 layer that intersects with an oblique shock.
 This test case was first presented in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Bur22"
literal "false"

\end_inset

, which built on the configuration introduced in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Fer14"
literal "false"

\end_inset

.
 The mesh and flow parameters are slightly different from those in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Bur22"
literal "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shear_layer_diagram"
plural "false"
caps "false"
noprefix "false"

\end_inset

 displays a two-dimensional schematic of the flow configuration.
 Supersonic inflow is applied at the left boundary, and extrapolation is
 applied at the right boundary.
 Flow parameters for the incoming air and fuel are listed in Table
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Air_and_Fuel"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Slip-wall conditions are applied the top and bottom walls since it is not
 necessary to capture the boundary layers.
 We use the detailed reaction mechanism described in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
after "Appendix D"
key "Chi22_2"
literal "false"

\end_inset

.
 A default CFL of 0.5 with SSPRK3 time integration is employed.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/viscous/domain/domain.pdf
	lyxscale 60
	width 80col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:shear_layer_diagram"

\end_inset

Schematic of the three-dimensional shock/mixing-layer interaction test case.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Prescribed Quantity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Air Boundary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Fuel Boundary
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Velocity, 
\begin_inset Formula $v_{1}$
\end_inset

 (m/s)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1634 m/s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
973 m/s
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Temperature, 
\begin_inset Formula $T$
\end_inset

 (K)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1475
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
545
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{O_{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.278
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{N_{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.552
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.95
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{H_{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.05
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{H_{2}O}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.17
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{H}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5.6\times10^{-7}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{O}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.55\times10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{OH}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.83\times10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{HO_{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5.1\times10^{-6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{H_{2}O_{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.5\times10^{-7}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Air_and_Fuel"

\end_inset

Inflow parameters for three-dimensional shock/mixing-layer interaction.
 These values are taken from
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Fer14"
literal "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
To connect the fuel and air streams, we utilize a hyperbolic tangent function
 for prescribing the species, temperature, and velocity with a constant
 pressure specification,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
Y_{i}(x_{2},x_{3},t) & = & \frac{1}{2}\left(\left(_{i,}+_{i,}\right)+\left(_{i,}_{i,}\right)\tanh\left(\frac{\left(2\left(_{2}-h\left(x_{3},t\right)\right)\right)}{L\left(x_{3},t\right)}\right)\right)\nonumber \\
T(x_{2},x_{3},t) & = & \frac{1}{2}\left(\left(T_{}+_{}\right)+\left(T_{}T_{}\right)\tanh\left(\frac{\left(2\left(_{2}-h\left(x_{3},t\right)\right)\right)}{L\left(x_{3},t\right)}\right)\right)\nonumber \\
v_{1}(x_{2},x_{3},t) & = & \frac{1}{2}\left(\left(v_{1,}+v_{1,}\right)+\left(v_{1,}v_{1,}\right)\tanh\left(\frac{\left(2\left(_{2}-h\left(x_{3},t\right)\right)\right)}{L\left(x_{3},t\right)}\right)\right)\label{eq:shear_layer_boundary_condition}\\
P & = & 94232.25\text{ Pa},\nonumber 
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $(\cdot)_{O}$
\end_inset

 denotes air, 
\begin_inset Formula $(\cdot)_{F}$
\end_inset

 denotes fuel, 
\begin_inset Formula $L$
\end_inset

 is a length scale, and 
\begin_inset Formula $h$
\end_inset

 is the center of the hyperbolic tangent.
 Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:shear_layer_boundary_condition"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is also used to initialize the solution.
 
\begin_inset Formula $L$
\end_inset

 is given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
L(x_{3},t) & = & L_{s}+\sum_{i=1}^{n_{t}}A_{i}\sin\left(\frac{m_{i}2\pi t}{t_{r}}\right)+l(x_{3},t)\nonumber \\
l\left(x_{3},t\right) & = & B\sin\left(\frac{24\pi t}{t_{r}}\right)\left[\sin\left(\frac{8\pi x_{3}}{z_{h}}\right)+\sin\left(\frac{32\pi x_{3}}{z_{h}}\right)\right]\text{,}\label{eq:length_scale}
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $L_{s}=0.05$
\end_inset

 mm is a reference length scale, 
\begin_inset Formula $z_{h}=1.44$
\end_inset

 mm is the domain thickness in the 
\begin_inset Formula $x_{3}$
\end_inset

-direction, and 
\begin_inset Formula $t_{r}=3.635\times10^{-5}$
\end_inset

 s is a reference time scale.
 Furthermore, 
\begin_inset Formula $n_{t}=4$
\end_inset

, 
\begin_inset Formula $\left(A_{1},A_{2},A_{3},A_{4}\right)=\left(0.0025,0.0125,0.00125,0.00625\right)$
\end_inset

 mm, 
\begin_inset Formula $\left(m_{1},m_{2},m_{3},m_{4}\right)=\left(1,3,11,13\right)$
\end_inset

, and 
\begin_inset Formula $B=0.0125$
\end_inset

 mm.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
This prescription of 
\begin_inset Formula $L$
\end_inset

 introduces unsteadiness while maintaining reproducibility.
\end_layout

\end_inset

 To induce additional variation in this three-dimensional case, we prescribe
 
\begin_inset Formula $h$
\end_inset

 as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
h(x_{3},t) & = & h_{s}+10B\sin\left(\frac{16\pi x_{3}}{z_{h}}\right),\label{eq:third_dimension_perturbation}
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $h_{s}=8.64$
\end_inset

 mm is the ambient center of the hyperbolic tangent.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/viscous/splitter/meshdiagram_v3.pdf
	width 96col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:mesh_specs"

\end_inset

Diagram of geometry with 
\begin_inset Formula $x_{1}x_{2}$
\end_inset

-point locations (in mm) for mesh generation in Gmsh
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Geu09"
literal "false"

\end_inset

.
 The third value in each tuple (
\begin_inset Formula $a$
\end_inset

 through 
\begin_inset Formula $d$
\end_inset

) is the target mesh size at the respective location.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:mesh_specs"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the specifications in Gmsh
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Geu09"
literal "false"

\end_inset

 used to create an unstructured tetrahedral mesh.
 For each tuple, the first two values are the 
\begin_inset Formula $x_{1}$
\end_inset

 and 
\begin_inset Formula $x_{2}$
\end_inset

 locations of the given point.
 The third value represents the target mesh size.
 We select 
\begin_inset Formula $a=0.5$
\end_inset

 mm, 
\begin_inset Formula $b=0.2$
\end_inset

 mm , 
\begin_inset Formula $c=0.06$
\end_inset

 mm, and 
\begin_inset Formula $d=0.12$
\end_inset

 mm.
 The mesh is extruded in the 
\begin_inset Formula $x_{3}$
\end_inset

-direction from 
\begin_inset Formula $x_{3}=0$
\end_inset

 to 
\begin_inset Formula $x_{3}=z_{h}$
\end_inset

, with periodicity applied at the resulting 
\begin_inset Formula $x_{1}x_{2}$
\end_inset

-planes.
 
\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3D-splitter-plate"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows instantaneous isosurfaces corresponding to 
\begin_inset Formula $Y_{OH}=0.00017$
\end_inset

, superimposed on a numerical Schlieren result sampled along an 
\begin_inset Formula $x_{1}x_{2}$
\end_inset

-plane.
 The 
\begin_inset Formula $Y_{OH}$
\end_inset

 isosurfaces ares colored by pressure to highlight the abrupt compression
 experienced through the oblique shock.
 The right image provides a zoomed-in perspective to emphasize the three
 dimensional flow features.
 Roll-up is observed upstream of the oblique shock.
 The interaction between the shock and the mixing layer causes the generation
 of smaller-scale compression waves.
 These results demonstrate that the proposed formulation can capture complex
 flow features in three dimensions.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/viscous/splitter/splitter_flow_field.pdf
	lyxscale 80
	width 96col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3D-splitter-plate"

\end_inset


\begin_inset Formula $Y_{OH}$
\end_inset

 and numerical Schlieren results for three-dimensional shock/mixing-layer
 interaction.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Concluding remarks
\end_layout

\begin_layout Standard
In this paper, we developed a fully conservative, positivity-preserving,
 and entropy-bounded DG formulation for the chemically reacting, compressible
 Navier-Stokes equations.
 The formulation builds on the fully conservative, positivity-preserving,
 and entropy-bounded DG formulation for the chemically reacting, compressible
 Euler equations that we previously introduced
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Chi22,Chi22_2"
literal "false"

\end_inset

.
 A key ingredient is the positivity-preserving Lax-Friedrichs-type viscous
 flux function devised by Zhang
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

 for the monocomponent case, which we extended to multicomponent flows with
 species diffusion in a manner that separates the inviscid and viscous fluxes.
 This is in contrast with the work by Du and Yang
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Du22"
literal "false"

\end_inset

, who similarly extended the Lax-Friedrichs-type viscous flux function,
 but treated the inviscid and viscous fluxes together.
 We discussed in detail the consideration of boundary conditions and the
 techniques by Johnson and Kercher
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

 to reduce spurious pressure oscillations, introducing additional constraints
 on the time step size.
 Entropy boundedness is enforced on only the convective contribution since
 the minimum entropy principle only applies to the Euler equations
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Tad86,Gue14"
literal "false"

\end_inset

 and the viscous flux function is not fully compatible with the entropy
 bound.
 Drawing from
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Zha17"
literal "false"

\end_inset

, we proposed an adaptive solution procedure that favors large time step
 sizes and the BR2 viscous flux function since the Lax-Friedrichs-type viscous
 flux function was found to more likely lead to spurious oscillations.
 Small time-step sizes and/or the Lax-Friedrichs-type viscous flux function
 are employed only when necessary.
 However, it should be noted that the Lax-Friedrichs-type viscous flux function
 guarantees a finite time-step size such that the positivity property is
 maintained.
 Furthermore, we discussed potential issues with the Lax-Friedrichs-type
 viscous flux function in the case of zero (or near-zero) species concentrations
 and introduced a gradient-limiting procedure as a remedy.
 The proposed methodology is compatible with high-order polynomials and
 curved elements of arbitrary shape.
\end_layout

\begin_layout Standard
The DG methodology was applied to a series of test cases.
 The first two comprised smooth, one-dimensional flows: advection-diffusion
 of a thermal bubble and a premixed flame.
 In the former, optimal convergence was demonstrated for both viscous flux
 functions.
 In the latter, we obtained a much more accurate solution on a relatively
 coarse mesh with the proposed methodology than with conventional species
 clipping.
 Next, we computed viscous shock-tube flow and found that just as in the
 inviscid setting, enforcement of entropy boundedness considerably reduces
 the magnitude of large-scale instabilities that otherwise appear if only
 the positivity property is enforced.
 Finally, we computed two-dimensional, moving, viscous detonation waves
 and three-dimensional shock/mixing-layer interaction, demonstrating that
 the proposed formulation can accurately and robustly compute complex reacting
 flows with detailed chemistry using high-order polynomial approximations.
 Future work will entail the simulation of larger-scale viscous, chemically
 reacting flows involving more complex geometries.
\end_layout

\begin_layout Section*
Acknowledgments
\end_layout

\begin_layout Standard
This work is sponsored by the Office of Naval Research through the Naval
 Research Laboratory 6.1 Computational Physics Task Area.
 
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "citations"
options "elsarticle-num"

\end_inset


\end_layout

\begin_layout Section
\start_of_appendix
Boundary conditions
\begin_inset CommandInset label
LatexCommand label
name "sec:boundary-conditions"

\end_inset


\end_layout

\begin_layout Standard
The boundary conditions here were originally described by Johnson and Kercher
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

, building on the discussion in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Har13"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Supersonic inflow
\end_layout

\begin_layout Standard
Letting 
\begin_inset Formula $y_{\infty}$
\end_inset

 denote the fully prescribed state, we specify
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
y_{\partial}\left(y^{+},n^{+}\right)=y_{\infty} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{in}},\\
\mathcal{F}_{\partial,k}^{\nu}\left(y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+}\right)=\mathcal{F}_{k}^{\nu}\left(y_{\infty},\nabla y^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{in}},\\
\mathcal{F}_{\partial}^{c\dagger}\left(y^{+},n^{+}\right)=\mathcal{F}^{c}\left(y_{\infty}\right)\cdot n^{+} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{in}}.
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
Supersonic outflow
\end_layout

\begin_layout Standard
This boundary condition is given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
y_{\partial}\left(y^{+},n^{+}\right)=y^{+} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{out}},\\
\mathcal{F}_{\partial,k}^{\nu}\left(y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+}\right)=\mathcal{F}_{k}^{\nu}\left(y^{+},\nabla y^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{out}},\\
\mathcal{F}_{\partial}^{c\dagger}\left(y^{+},n^{+}\right)=\mathcal{F}^{c}\left(y^{+}\right)\cdot n^{+} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{out}},
\end{align*}

\end_inset

where the boundary state is simply extrapolated from the interior.
\end_layout

\begin_layout Subsection
Slip wall
\end_layout

\begin_layout Standard
We define the boundary velocity, 
\begin_inset Formula $v_{\partial}=\left(v_{\partial,1},\ldots,v_{\partial,d}\right)$
\end_inset

, as
\begin_inset Formula 
\[
v_{\partial}\left(y^{+},n^{+}\right)=\left(v_{1}^{+}-\left(\sum_{k=1}^{d}v_{k}^{+}n_{k}^{+}\right)n_{1}^{+},\cdots,v_{d}^{+}-\left(\sum_{k=1}^{d}v_{k}^{+}n_{k}^{+}\right)n_{d}^{+}\right).
\]

\end_inset

We then have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
y_{\partial}\left(y^{+},n^{+}\right)=\left(\rho^{+}v_{\partial,1},\ldots,\rho^{+}v_{\partial,d},\left(\rho e_{t}\right)^{+},C_{i}^{+},\ldots,C_{n_{s}}^{+}\right)^{T} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{slip}},\\
\mathcal{F}_{\partial,k}^{\nu}\left(y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+}\right)=\mathcal{F}_{k}^{\nu}\left(y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{slip}},\\
\mathcal{F}_{\partial}^{c\dagger}\left(y^{+},n^{+}\right)=\mathcal{F}^{c\dagger}\left(y^{+},2y_{\partial}\left(y^{+},n^{+}\right)-y^{+},n^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{slip}}.
\end{align*}

\end_inset

The viscous boundary flux is obtained from the boundary state and the interior
 gradient.
 
\end_layout

\begin_layout Subsection
Adiabatic wall
\end_layout

\begin_layout Standard
Here, let 
\begin_inset Formula $v_{\partial}$
\end_inset

 be a prescribed boundary velocity.
 This boundary condition is then given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
y_{\partial}\left(y^{+},n^{+}\right)=\left(\rho^{+}v_{\partial,1},\ldots,\rho^{+}v_{\partial,d},\left(\rho e_{t}\right)^{+},C_{i}^{+},\ldots,C_{n_{s}}^{+}\right)^{T} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{adi}},\\
\mathcal{F}_{\partial,k}^{\nu}\left(y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+}\right)=\begin{pmatrix}\frac{\partial\tau_{1k}}{\partial\left(\nabla y\right)}\left(y_{\partial}\right):\nabla y^{+}\\
\vdots\\
\frac{\partial\tau_{dk}}{\partial\left(\nabla y\right)}\left(y_{\partial}\right):\nabla y^{+}\\
{\textstyle \sum_{j=1}^{d}}v_{\partial,j}\frac{\partial\tau_{kj}}{\partial\left(\nabla y\right)}\left(y_{\partial}\right):\nabla y^{+}\\
0\\
\vdots\\
0
\end{pmatrix} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{adi}},\\
\mathcal{F}_{\partial}^{c\dagger}\left(y^{+},n^{+}\right)=\mathcal{F}^{c}\left(y_{\partial}\left(y^{+},n^{+}\right)\right)\cdot n^{+} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{adi}},
\end{align*}

\end_inset

where the species diffusion velocities and heat flux have been set to zero.
 The two boundary conditions below are not directly used in this study,
 but we include them for completeness.
\end_layout

\begin_layout Subsection
Isothermal wall
\end_layout

\begin_layout Standard
Again, let 
\begin_inset Formula $v_{\partial}$
\end_inset

 be a prescribed boundary velocity.
 We specify
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
y_{\partial}\left(y^{+},n^{+}\right)=\left(\rho_{\partial}v_{\partial,1},\ldots,\rho_{\partial}v_{\partial,d},\rho_{\partial}u_{\partial}+0.5\cdot{\textstyle \sum_{j=1}^{d}}\rho_{\partial}v_{\partial,k}v_{\partial,k},C_{\partial,i},\ldots,C_{\partial,n_{s}}\right)^{T} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{iso}},\\
\mathcal{F}_{\partial,k}^{\nu}\left(y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+}\right)=\begin{pmatrix}\frac{\partial\tau_{1k}}{\partial\left(\nabla y\right)}\left(y_{\partial}\right):\nabla y^{+}\\
\vdots\\
\frac{\partial\tau_{dk}}{\partial\left(\nabla y\right)}\left(y_{\partial}\right):\nabla y^{+}\\
\left[{\textstyle \sum_{j=1}^{d}}v_{\partial,j}\frac{\partial\tau_{kj}}{\partial\left(\nabla y\right)}\left(y_{\partial}\right)-\frac{\partial q_{k}}{\partial\left(\nabla y\right)}\left(y_{\partial}\right)\right]:\nabla y^{+}\\
0\\
\vdots\\
0
\end{pmatrix} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{iso}},\\
\mathcal{F}_{\partial}^{c\dagger}\left(y^{+},n^{+}\right)=\mathcal{F}^{c}\left(y_{\partial}\left(y^{+},n^{+}\right)\right)\cdot n^{+} & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{iso}},
\end{align*}

\end_inset

where 
\begin_inset Formula $T_{\partial}$
\end_inset

 is the prescribed boundary temperature, 
\begin_inset Formula $C_{\partial,i}$
\end_inset

 is the boundary concentration of the 
\begin_inset Formula $i$
\end_inset

th species,
\begin_inset Formula 
\[
C_{\partial,i}\left(y^{+}\right)=\frac{T^{+}}{T_{\partial}}C_{i}^{+}.
\]

\end_inset


\begin_inset Formula $\rho_{\partial}$
\end_inset

 is the boundary density, 
\begin_inset Formula 
\[
\rho_{\partial}=\sum_{i=1}^{n_{s}}W_{i}C_{\partial,i},
\]

\end_inset

and 
\begin_inset Formula $u_{\partial}$
\end_inset

 is the boundary internal energy, which is evaluated at 
\begin_inset Formula $T_{\partial}$
\end_inset

.
\end_layout

\begin_layout Subsection
Characteristic
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $y^{*}\left(y^{+},y_{\infty},n^{+}\right)$
\end_inset

 be the characteristic boundary value.
 Its derivation for non-reflecting inflow and outflow boundary conditions
 can be found in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "Joh20_2"
literal "false"

\end_inset

.
 This boundary condition is then given as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
y_{\partial}\left(y^{+},n^{+}\right)=y^{*}\left(y^{+},y_{\infty},n^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{cha}},\\
\mathcal{F}_{\partial,k}^{\nu}\left(y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+}\right)=\mathcal{F}_{k}^{\nu}\left(y_{\partial}\left(y^{+},n^{+}\right),\nabla y^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{cha}},\\
\mathcal{F}_{\partial}^{c\dagger}\left(y^{+},n^{+}\right)=\mathcal{F}^{c\dagger}\left(y^{+},y_{\partial}\left(y^{+},n^{+}\right),n^{+}\right) & \textup{ on }\epsilon\qquad\forall\epsilon\in\mathcal{E}_{\mathrm{cha}}.
\end{align*}

\end_inset


\end_layout

\begin_layout Section
Supporting lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:supporting-lemma"

\end_inset


\end_layout

\begin_layout Standard
In the following, let 
\begin_inset Formula $\Delta y$
\end_inset

 denote the quantity
\begin_inset Formula 
\[
\Delta y=\left(\Delta(\rho v),\Delta(\rho e_{t}),\Delta C_{1},\ldots,\Delta C_{n_{s}}\right)^{T}.
\]

\end_inset

The lemma below is related to that in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
after "Appendix B"
key "Chi22_2"
literal "false"

\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:alpha-constraints"

\end_inset

Assume that 
\begin_inset Formula $y=\left(\rho v,\rho e_{t},C\right)^{T}$
\end_inset

 is in 
\begin_inset Formula $\mathcal{G}$
\end_inset

 and that 
\begin_inset Formula $C_{i}>0,\:\forall i$
\end_inset

.
 Then 
\begin_inset Formula $\check{y}=y-\alpha^{-1}\Delta y$
\end_inset

, where 
\begin_inset Formula $\alpha>0$
\end_inset

, is also in 
\begin_inset Formula $\mathcal{G}$
\end_inset

 under the following conditions:
\end_layout

\begin_layout Lemma
\begin_inset Formula 
\begin{equation}
\alpha>\alpha^{*}\left(y,\Delta y\right)=\left.\max\left\{ \max_{i=1,\ldots,n_{s}}\frac{\Delta C_{i}}{C_{i}},\alpha_{T},0\right\} \right|_{\left(y,\Delta y\right)},\label{eq:alpha-constraint}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\alpha_{T}=\begin{cases}
\frac{-\mathsf{b}+\sqrt{\mathsf{b}^{2}-4\rho^{2}u\mathsf{g}}}{2\rho^{2}u}, & \mathsf{b}^{2}-4\rho^{2}u\mathsf{g}\geq0\\
0, & \mathrm{otherwise}
\end{cases},\label{eq:alpha_T}
\end{equation}

\end_inset


\begin_inset Formula $\mathsf{b}=-\rho e_{t}\mathsf{M}-\rho\Delta(\rho e_{t})+\rho v\cdot\Delta(\rho v)+2\rho u_{0}\mathsf{M}$
\end_inset

, 
\begin_inset Formula $\mathsf{g}=\mathsf{M}\Delta(\rho e_{t})-\frac{1}{2}\left|\Delta(\rho v)\right|^{2}-u_{0}\mathsf{M}^{2}$
\end_inset

, and 
\begin_inset Formula $\mathsf{M}=\sum_{i=1}^{n_{s}}W_{i}\Delta C_{i}$
\end_inset

.
\end_layout

\begin_layout Proof
The proof is similar to that for Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:beta-constraints"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\begin_inset Formula $\check{y}=y-\alpha^{-1}\Delta y$
\end_inset

 can be expanded as
\begin_inset Formula 
\[
\begin{split}\check{y}= & \left(\check{\rho v},\check{\rho e_{t}},\check{C_{1}},\ldots,\check{C}_{n_{s}}\right)^{T}\\
= & \left(\rho v-\alpha\Delta(\rho v),\rho e_{t}-\alpha\Delta(\rho e_{t}),C_{1}-\alpha\Delta C_{1},\ldots,C_{n_{s}}-\alpha\Delta C_{n_{s}}\right)^{T}.
\end{split}
\]

\end_inset


\begin_inset Formula $\check{C_{i}}=C_{i}-\alpha^{-1}\Delta C_{i}>0,\;\forall i$
\end_inset

 under the condition 
\begin_inset Formula 
\[
\alpha>\max\left\{ \max_{i=1,\ldots,n_{s}}\frac{\Delta C_{i}}{C_{i}},0\right\} .
\]

\end_inset


\begin_inset Formula $Z\left(\check{y}\right)$
\end_inset

, where 
\begin_inset Formula $Z$
\end_inset

 is defined as in Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Z-definition"
plural "false"
caps "false"
noprefix "false"

\end_inset

, can be expressed as
\begin_inset Formula 
\begin{align*}
Z\left(y-\alpha^{-1}\Delta y\right)= & \sum_{i=1}^{n_{s}}W_{i}\left(C_{i}-\alpha^{-1}\Delta C_{i}\right)\left(\rho e_{t}-\alpha^{-1}\Delta(\rho e_{t})\right)\\
 & -\frac{1}{2}\left|\rho v-\alpha^{-1}\Delta(\rho v)\right|^{2}-\left[\sum_{i=1}^{n_{s}}W_{i}\left(C_{i}-\alpha^{-1}\Delta C_{i}\right)\right]^{2}u_{0},
\end{align*}

\end_inset

which, after multiplying both sides by 
\begin_inset Formula $\alpha^{2}$
\end_inset

, can be rewritten as 
\begin_inset Formula 
\begin{align}
\alpha^{2}Z\left(y-\alpha^{-1}\Delta y\right)= & \rho^{2}u\alpha^{2}-\mathsf{b}\alpha+\mathsf{g}.\label{eq:alpha-quadratic-form}
\end{align}

\end_inset

Setting the RHS of Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:alpha-quadratic-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

 equal to zero yields a quadratic equation with 
\begin_inset Formula $\alpha$
\end_inset

 as the unknown.
 Since 
\begin_inset Formula $\rho^{2}u$
\end_inset

 is positive, the quadratic equation is convex.
 As such, if 
\begin_inset Formula $\mathsf{b}^{2}-4\rho^{2}u\mathsf{g}<0$
\end_inset

, then no real roots exist, and 
\begin_inset Formula $Z\left(y-\alpha^{-1}\Delta y\right)>0$
\end_inset

 for all 
\begin_inset Formula $\alpha\neq0$
\end_inset

; otherwise, at least one real root exists, in which case a sufficient condition
 to ensure 
\begin_inset Formula $Z\left(y-\alpha^{-1}\Delta y\right)>0$
\end_inset

 is 
\begin_inset Formula $\alpha>\alpha_{0}$
\end_inset

, where 
\begin_inset Formula $\alpha_{0}$
\end_inset

 is given by
\begin_inset Formula 
\[
\alpha_{0}=\max\left\{ \frac{-\mathsf{b}+\sqrt{\mathsf{b}^{2}-4\rho^{2}u\mathsf{g}}}{2\rho^{2}u},0\right\} .
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Note that in principle, if 
\begin_inset Formula $\mathsf{b}^{2}-4\rho^{2}u\mathsf{g}=0$
\end_inset

, then 
\begin_inset Formula $Z\left(y-\alpha^{-1}\Delta y\right)>0$
\end_inset

 provided that 
\begin_inset Formula $\alpha\neq-\mathsf{b}/\left(2\rho^{2}u\right)$
\end_inset

 and 
\begin_inset Formula $\alpha\neq0$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_body
\end_document
